<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>LTerm_history</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">LTerm_history</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>History management</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/type:t">
  <a href="index.html#/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t
    
      <div class="doc">
        
      <p>Type of a history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:create">
  <a href="index.html#/val:create" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> create : ?max_size:int <span class="rarr"><span>-&gt;</span></span> ?max_entries:int <span class="rarr"><span>-&gt;</span></span> <a href="../../../../zed.1.4/_build/src/zed_utf8/">Zed_utf8</a>.<a href="../../../../zed.1.4/_build/src/zed_utf8/#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>create ?max_size ?max_lines init</code> creates a new history.</p>
      
      <p><code>max_size</code> is the maximum size in bytes of the history. Oldest
entries are dropped if this limit is reached. The default is
<code>max_int</code>.</p>
      
      <p><code>max_entries</code> is the maximum number of entries of the
history. Oldest entries are dropped if this limit is
reached. The default is no <code>max_int</code>.</p>
      
      <p><code>init</code> is the initial contents of the history. All entries of
<code>init</code> are considered &quot;old&quot;. Old entries are not saved by
<a href="index.html#/val:save">save</a> when <code>append</code> is set to <code>true</code>.</p>
      
      <p>Note: the first element of <code>init</code> must be the most recent
entry.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add">
  <a href="index.html#/val:add" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?skip_empty:bool <span class="rarr"><span>-&gt;</span></span> ?skip_dup:bool <span class="rarr"><span>-&gt;</span></span> <a href="../../../../zed.1.4/_build/src/zed_utf8/">Zed_utf8</a>.<a href="../../../../zed.1.4/_build/src/zed_utf8/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add history ?skip_empty ?skip_dup entry</code> adds <code>entry</code> to the
top of the history. If <code>skip_empty</code> is <code>true</code> (the default) and
<code>entry</code> contains only spaces, it is not added. If <code>skip_dup</code> is
<code>true</code> (the default) and <code>entry</code> is equal to the top of the
history, it is not added.</p>
      
      <p>If <code>entry</code> is bigger than the maximum size of the history, the
history is not modified.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:contents">
  <a href="index.html#/val:contents" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> contents : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../zed.1.4/_build/src/zed_utf8/">Zed_utf8</a>.<a href="../../../../zed.1.4/_build/src/zed_utf8/#/type:t">t</a> list
    
      <div class="doc">
        
      <p>Returns all the entries of the history. The first element of the
list is the most recent entry.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:size">
  <a href="index.html#/val:size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> size : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the size (in bytes) of the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:length">
  <a href="index.html#/val:length" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> length : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the number of entries in the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:old_count">
  <a href="index.html#/val:old_count" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> old_count : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the number of old entries in the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:set_old_count">
  <a href="index.html#/val:set_old_count" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_old_count : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>set_old_count history count</code> sets the number of old entries in
the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:max_size">
  <a href="index.html#/val:max_size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> max_size : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the maximum size of the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:set_max_size">
  <a href="index.html#/val:set_max_size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_max_size : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Sets the maximum size of the history. It may drop oldest entries
to honor the new limit.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:max_entries">
  <a href="index.html#/val:max_entries" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> max_entries : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the maximum number of entries of the history.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:set_max_entries">
  <a href="index.html#/val:set_max_entries" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_max_entries : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Sets the maximum number of entries of the history. It may drop
oldest entries to honor the new limit.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:load">
  <a href="index.html#/val:load" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> load : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?log:(int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> ?skip_empty:bool <span class="rarr"><span>-&gt;</span></span> ?skip_dup:bool <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit <a href="../../../../lwt.2.4.6/_build/src/core/lwt/">Lwt</a>.<a href="../../../../lwt.2.4.6/_build/src/core/lwt/#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>load history ?log ?skip_empty ?skip_dup filename</code> loads entries
from <code>filename</code> to <code>history</code>. If <code>filename</code> does not exists
<code>history</code> is not modified.</p>
      
      <p><code>log</code> is the function used to log errors contained in the
history file (errors are because of non-UTF8 data). Arguments
are a line number and an error message. The default is to use
the default logger (of <code>Lwt_log</code>). Entries containing errors are
skipped.</p>
      
      <p>Note: all entries are marked as old, i.e. <code>old_count history =
      length history</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:save">
  <a href="index.html#/val:save" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> save : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?max_size:int <span class="rarr"><span>-&gt;</span></span> ?max_entries:int <span class="rarr"><span>-&gt;</span></span> ?skip_empty:bool <span class="rarr"><span>-&gt;</span></span> ?skip_dup:bool <span class="rarr"><span>-&gt;</span></span> ?append:bool <span class="rarr"><span>-&gt;</span></span> ?perm:int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit <a href="../../../../lwt.2.4.6/_build/src/core/lwt/">Lwt</a>.<a href="../../../../lwt.2.4.6/_build/src/core/lwt/#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>save history ?max_size ?max_entries ?skip_empty ?sjip_dup ?perm
      filename</code> saves <code>history</code> to <code>filename</code>.</p>
      
      <p>If <code>append</code> is <code>false</code> then the file is truncated and new
entries are saved. If it is <code>true</code> (the default) then new
entries are added at the end. <code>perm</code> are the file permissions in
case it is created.</p>
      
      <p>If <code>append</code> is <code>true</code> and there is no new entries, the file is
not touched. In any other case, limits are honored and the
resulting file will never contains more bytes than <code>max_size</code> or
more entries than <code>max_entries</code>. If <code>max_size</code> and/or
<code>max_entries</code> are not specified, the ones of <code>history</code> are used.</p>
      
      <p>After the history is successfully saved, all entries of
<code>history</code> are marked as old, i.e. <code>old_count history = length
      history</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:entry_size">
  <a href="index.html#/val:entry_size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> entry_size : <a href="../../../../zed.1.4/_build/src/zed_utf8/">Zed_utf8</a>.<a href="../../../../zed.1.4/_build/src/zed_utf8/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>entry_size entry</code> returns the size taken by an entry in the
history file in bytes. This is not exactly <code>String.length entry</code>
since some characters are escaped and the entry is terminated by
a newline character.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>