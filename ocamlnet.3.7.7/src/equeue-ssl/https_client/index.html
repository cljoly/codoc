<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Https_client</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Https_client</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>HTTPS extension to [root:Http_client]</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/type:channel_binding_id">
  <a href="index.html#/type:channel_binding_id" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> channel_binding_id = int
    
      <div class="doc">
        
      <p>Same as <a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/">Http_client</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/#/type:channel_binding_id">channel_binding_id</a></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:transport_channel_type">
  <a href="index.html#/classtype:transport_channel_type" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> transport_channel_type = 
  <div class="region" id="/classtype:transport_channel_type/method:setup_e">
  <a href="index.html#/classtype:transport_channel_type/method:setup_e" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> setup_e : <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:channel_binding_id">channel_binding_id</a> <span class="rarr"><span>-&gt;</span></span> float <span class="rarr"><span>-&gt;</span></span> exn <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a> <span class="rarr"><span>-&gt;</span></span> (<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:multiplex_controller">multiplex_controller</a> * exn option) <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:engine">engine</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:transport_channel_type/method:continue">
  <a href="index.html#/classtype:transport_channel_type/method:continue" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> continue : <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:channel_binding_id">channel_binding_id</a> <span class="rarr"><span>-&gt;</span></span> float <span class="rarr"><span>-&gt;</span></span> exn <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a> <span class="rarr"><span>-&gt;</span></span> exn option <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:multiplex_controller">multiplex_controller</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:transport_channel_type/method:default_port">
  <a href="index.html#/classtype:transport_channel_type/method:default_port" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> default_port : int option
  
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>Same as <a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/">Http_client</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/#/classtype:transport_channel_type">transport_channel_type</a></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:https_transport_channel_type">
  <a href="index.html#/val:https_transport_channel_type" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> https_transport_channel_type : ?verify:(<a href="../../../../ssl.0.4.7/src/ssl/">Ssl</a>.<a href="../../../../ssl.0.4.7/src/ssl/#/type:context">context</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ssl.0.4.7/src/ssl/">Ssl</a>.<a href="../../../../ssl.0.4.7/src/ssl/#/type:socket">socket</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ssl.0.4.7/src/ssl/">Ssl</a>.<a href="../../../../ssl.0.4.7/src/ssl/#/type:context">context</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:transport_channel_type">transport_channel_type</a>
    
      <div class="doc">
        
      <p>Configures a TLS tunnel for this context.</p>
      
      <p>The <code>verify</code> callback is invoked right after connecting to the
remote socket and finishing the SSL handshake. The user can do here
additional checks whether the peer is acceptable. If not acceptable,
raise an exception.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">How to configure a pipeline for TLS</h2>
    </div>
      <p>Just follow this recipe:</p>
      
      <p>1. Create the <code>Ssl</code> context:</p>
      <pre><code>Ssl.init()</code></pre><pre><code>let ctx = Ssl.create_context Ssl.TLSv1 Ssl.Client_context</code></pre>
      <p>2. Create the transport channel type:</p>
      <pre><code>let tct = Https_client.https_transport_channel_type ctx</code></pre>
      <p>3. Configure the transport:</p>
      <pre><code>pipeline # configure_transport Http_client.https_cb_id tct</code></pre>
      <p>Now all URLs starting with &quot;https://&quot; will use this transport.
If you need more control about the type of SSL/TLS channel, you
can create new channel binding IDs, and configure these in addition.
For each message needing a specific context, just set the
channel binding ID (method <code>set_channel_binding</code> of the message).</p>
      
        
      </div>
    
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">How to configure the Convenience module</h2>
    </div>
      <p>Just do once:</p>
      <pre><code>    Ssl.init();
    Http_client.Convenience.configure_pipeline
      (fun p -&gt;
         let ctx = Ssl.create_context Ssl.TLSv1 Ssl.Client_context in
         let tct = Https_client.https_transport_channel_type ctx in
         p # configure_transport Http_client.https_cb_id tct
      )</code></pre>
      <p>This will enable &quot;https&quot; for the functions in <a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/">Http_client</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/http_client/#/module:Convenience">Convenience</a>,
e.g. </p>
      <pre><code>let data = Http_client.Convenience.http_get &quot;https://url&quot;</code></pre>
        
      </div>
    
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">How to configure [root:Http_fs]</h2>
    </div>
      <p>Just do once:</p>
      <pre><code>    Ssl.init()</code></pre>
      <p>and create the <code>http_fs</code> object with</p>
      <pre><code>    Http_fs.http_fs 
      ~config_pipeline:(
        fun p -&gt;
	  let ctx = Ssl.create_context Ssl.TLSv1 Ssl.Client_context in
	  let tct = Https_client.https_transport_channel_type ctx in
	  p # configure_transport Http_client.https_cb_id tct
      )
      &quot;https://root-url&quot;</code></pre>
        
      </div>
    
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Features and limitations</h2>
    </div>
      <p>We only implement RFC 2618, i.e. secure connections on a separate
port (443 instead of 80). There is no support (yet) for RFC 2617,
i.e. upgrading an existing insecure connection to a secure one.</p>
      
      <p>If an HTTP proxy server is configured, the TLS connection is established
via the CONNECT method (documented in RFC 2617).</p>
      
      <p>Alternatively, it is also possible to connect via SOCKS version 5
proxies.</p>
      
      <p>There is, so far, no support for reusing TLS sessions across connections.
For every connection a new TLS session is created.</p>
      
        
      </div>
    </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>