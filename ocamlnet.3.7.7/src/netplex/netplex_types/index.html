<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Netplex_types</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Netplex_types</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>Types for <code>Netplex</code></p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/type:encap">
  <a href="index.html#/type:encap" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> encap = <a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_encap/">Netplex_encap</a>.<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_encap/#/type:encap">encap</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:param_value">
  <a href="index.html#/type:param_value" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> param_value = [ <div class="cons">| `String <span class="keyword">of</span> string</div><div class="cons">| `Int <span class="keyword">of</span> int</div><div class="cons">| `Float <span class="keyword">of</span> float</div><div class="cons">| `Bool <span class="keyword">of</span> bool</div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/type:param_value_or_any">
  <a href="index.html#/type:param_value_or_any" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> param_value_or_any = [ <div class="cons">| <a href="index.html#/type:param_value">param_value</a></div><div class="cons">| `Any <span class="keyword">of</span> exn</div><div class="cons">| `Encap <span class="keyword">of</span> <a href="index.html#/type:encap">encap</a></div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/type:level">
  <a href="index.html#/type:level" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> level = [ <div class="cons">| `Emerg</div><div class="cons">| `Alert</div><div class="cons">| `Crit</div><div class="cons">| `Err</div><div class="cons">| `Warning</div><div class="cons">| `Notice</div><div class="cons">| `Info</div><div class="cons">| `Debug</div> ]
    
      <div class="doc">
        
      <p>Log levels, modeled after syslog</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:logger">
  <a href="index.html#/classtype:logger" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> logger = 
      <div class="doc">
        
      <p>A logger receives log messages</p>
      
        
      </div>
    
  <div class="region" id="/classtype:logger/method:log_subch">
  <a href="index.html#/classtype:logger/method:log_subch" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> log_subch : component:string <span class="rarr"><span>-&gt;</span></span> subchannel:string <span class="rarr"><span>-&gt;</span></span> level:<a href="index.html#/type:level">level</a> <span class="rarr"><span>-&gt;</span></span> message:string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Receive a log <code>message</code> of <code>level</code> from <code>component</code>. The component
string is the name of the socket service emitting the message.
Optionally, one can specify a <code>subchannel</code> when a single component
needs to write to several log files. For example, a <code>subchannel</code>
of <code>&quot;access&quot;</code> could select the access log of a webserver.
The main log file is selected by passing the empty string as
<code>subchannel</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:logger/method:log">
  <a href="index.html#/classtype:logger/method:log" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> log : component:string <span class="rarr"><span>-&gt;</span></span> level:<a href="index.html#/type:level">level</a> <span class="rarr"><span>-&gt;</span></span> message:string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Same as <code>log_subch</code> when <code>subchannel</code> is set to the empty string.
This means that the message is sent to the main log file of the
component.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:logger/method:reopen">
  <a href="index.html#/classtype:logger/method:reopen" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> reopen : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Reopen the log files</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>A logger receives log messages</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:parallelization_type">
  <a href="index.html#/type:parallelization_type" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> parallelization_type = [ <div class="cons">| `Multi_processing</div><div class="cons">| `Multi_threading</div><div class="cons">| `Controller_attached</div> ]
    
      <div class="doc">
        
      <p>Type of parallelization:</p>
      <ul><li><code>`Multi_processing</code> on a single host</li><li><code>`Multi_threading</code> on a single host</li><li><code>`Controller_attached</code> means that the service runs within the
controller. This is (for now) only allowed for controller-internal
services.</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:thread_sys_id">
  <a href="index.html#/type:thread_sys_id" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> thread_sys_id = [ <div class="cons">| `Thread <span class="keyword">of</span> int</div><div class="cons">| `Process <span class="keyword">of</span> int</div> ]
    
      <div class="doc">
        
      <p>A system-specific identifier of the thread/process</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:socket_state">
  <a href="index.html#/type:socket_state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> socket_state = [ <div class="cons">| `Enabled</div><div class="cons">| `Disabled</div><div class="cons">| `Restarting <span class="keyword">of</span> bool</div><div class="cons">| `Down</div> ]
    
      <div class="doc">
        
      <p>The state of a socket:</p>
      <ul><li><code>`Enabled</code>: The controller allows containers to accept connections.
Note that this does not necessarily means that there such containers.</li><li><code>`Disabled</code>: It is not allowed to accept new connections. The
socket is kept open, however.</li><li><code>`Restarting b</code>: The containers are being restarted. The boolean
argument says whether the socket will be enabled after that.</li><li><code>`Down</code>: The socket is down/closed</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:container_id">
  <a href="index.html#/type:container_id" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> container_id = &lt; socket_service_name : string &gt;
    
      <div class="doc">
        
      <p>Such objects identify containers. As additional info, the method
<code>socket_service_name</code> returns the name of the socket service the
container implements</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:container_state">
  <a href="index.html#/type:container_state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> container_state = [ <div class="cons">| `Accepting <span class="keyword">of</span> int * float</div><div class="cons">| `Busy</div><div class="cons">| `Starting <span class="keyword">of</span> float</div><div class="cons">| `Shutting_down</div> ]
    
      <div class="doc">
        
      <p>The container state for workload management:</p>
      <ul><li><code>`Accepting(n,t)</code>: The container is accepting further connections.
It currently processes <code>n</code> connections. The last connection was
accepted at time <code>t</code> (seconds since the epoch).</li><li><code>`Busy</code>: The container does not accept connections</li><li><code>`Starting t</code>: The container was started at time <code>t</code> and is not
yet ready.</li><li><code>`Shutting_down</code>: The container is being shutted down.</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:capacity">
  <a href="index.html#/type:capacity" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> capacity = [ <div class="cons">| `Normal_quality <span class="keyword">of</span> int * bool</div><div class="cons">| `Low_quality <span class="keyword">of</span> int * bool</div><div class="cons">| `Unavailable</div> ]
    
      <div class="doc">
        
      <p>How many connections a container can accept in addition to the
existing connections:</p>
      <ul><li><code>`Normal_quality(n,greedy)</code>: It can accept n connections with normal
service quality, <code>n &gt; 0</code></li><li><code>`Low_quality(n,greedy)</code>: It can accept n connections with low
service quality (e.g. because it is already quite loaded), <code>n &gt; 0</code></li><li><code>`Unavailable</code>: No capacity free</li></ul>
      <p>The <code>greedy</code> flag sets whether greedy accepts are allowed.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:extended_address">
  <a href="index.html#/type:extended_address" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> extended_address = [ <div class="cons">| `Socket <span class="keyword">of</span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:sockaddr">sockaddr</a></div><div class="cons">| `Socket_file <span class="keyword">of</span> string</div><div class="cons">| `W32_pipe <span class="keyword">of</span> string</div><div class="cons">| `W32_pipe_file <span class="keyword">of</span> string</div><div class="cons">| `Container <span class="keyword">of</span> string * string * string * [ <div class="cons">| <a href="index.html#/type:thread_sys_id">thread_sys_id</a></div><div class="cons">| `Any</div> ]</div> ]
    
      <div class="doc">
        
      <p>Possible addresses:</p>
      <ul><li><code>`Socket s</code>: The socket at this socket address</li><li><code>`Socket_file f</code>: The file <code>f</code> contains the (anonymous) port number
of a socket bound to <code>127.0.0.1</code> (This is meant as substitute for
Unix Domain sockets on Win32.)</li><li><code>`W32_pipe name</code>: The Win32 pipe with this <code>name</code> which must
be of the form &quot;\\.\pipe\&lt;pname&gt;&quot;</li><li><code>`W32_pipe_file f</code>: The file <code>f</code> contains the (random) name of a
Win32 pipe</li><li><code>`Container(socket_dir,service_name,proto_name,thread_id)</code>:
The special endpoint
of the container for <code>service_name</code> that is running as <code>thread_id</code>.
It is system-dependent what this endpoint &quot;is&quot; in reality, usually
a socket or named pipe. If any container of a service is meant,
the value <code>`Any</code> is substituted as a placeholder for a not yet
known <code>thread_id</code>.</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller">
  <a href="index.html#/classtype:controller" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> controller = 
  <div class="region" id="/classtype:controller/method:ptype">
  <a href="index.html#/classtype:controller/method:ptype" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ptype : <a href="index.html#/type:parallelization_type">parallelization_type</a>
  
      <div class="doc">
        
      <p>The actually effective parallelization type</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:sys_id">
  <a href="index.html#/classtype:controller/method:sys_id" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> sys_id : <a href="index.html#/type:thread_sys_id">thread_sys_id</a>
  
      <div class="doc">
        
      <p>The thread running the controller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:controller_config">
  <a href="index.html#/classtype:controller/method:controller_config" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> controller_config : <a href="index.html#/classtype:controller_config">controller_config</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:services">
  <a href="index.html#/classtype:controller/method:services" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> services : (<a href="index.html#/classtype:socket_service">socket_service</a> * <a href="index.html#/classtype:socket_controller">socket_controller</a> * <a href="index.html#/classtype:workload_manager">workload_manager</a>) list
  
      <div class="doc">
        
      <p>The list of controlled services</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:add_service">
  <a href="index.html#/classtype:controller/method:add_service" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> add_service : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:workload_manager">workload_manager</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Adds a new service. Containers for these services will be started
soon. It is allowed to add several services with the same name
(but it will be hard to distinguish them later).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:add_message_receiver">
  <a href="index.html#/classtype:controller/method:add_message_receiver" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> add_message_receiver : <a href="index.html#/classtype:ctrl_message_receiver">ctrl_message_receiver</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Adds a message receiver. This receiver runs in the context of the
controller and receives all messages sent to it. The <code>name</code> method
must return the name.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:add_plugin">
  <a href="index.html#/classtype:controller/method:add_plugin" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> add_plugin : <a href="index.html#/classtype:plugin">plugin</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Adds a plugin. If the plugin object has already been added, this
is a no-op.</p>
      
      <p>Plugins must have been added before the first container is started.
This is not checked, however. You are on the safe side when the
plugin is added in the <code>create_processor</code> factory method, or in
the <code>post_add_hook</code> of the processor.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:add_admin">
  <a href="index.html#/classtype:controller/method:add_admin" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> add_admin : (<a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_server/">Rpc_server</a>.<a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_server/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>add_admin setup</code>: Allows to bind another RPC program to the admin
socket. The function <code>setup</code> will be called whenever a connection
to the admin socket is established, and this function can call
<code>Rpc_server.bind</code> to bind another RPC program. By default, only
the <code>Admin</code> interface is available as described in <code>netplex_ctrl.x</code>.</p>
      
      <p>Note that this RPC server runs in the scope of the controller! No
additional process or thread is created.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:logger">
  <a href="index.html#/classtype:controller/method:logger" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> logger : <a href="index.html#/classtype:logger">logger</a>
  
      <div class="doc">
        
      <p>The logger</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:event_system">
  <a href="index.html#/classtype:controller/method:event_system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> event_system : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/class:unix_event_system">unix_event_system</a>
  
      <div class="doc">
        
      <p>The event system used by the controller. It <b>must not</b> be used
from a container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:restart">
  <a href="index.html#/classtype:controller/method:restart" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> restart : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Initiates a restart of all containers: All threads/processes are
terminated and replaced by newly initialized ones.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:shutdown">
  <a href="index.html#/classtype:controller/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Initiates a shutdown of all containers. It is no longer possible
to add new services. When the shutdown has been completed,
the controller will terminate itself. Note that the shutdown is
performed asynchronously, i.e. this method returns immediately,
and the messaging required to do the shutdown is done in the
background.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:send_message">
  <a href="index.html#/classtype:controller/method:send_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> send_message : string <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>send_message destination msgname msgargs</code>: Sends a message to
<code>destination</code>. When this method returns, it is only ensured that
the receivers registered in the controller have been notified about
the message (so it can be made sure that any newly forked containers
know about the message). It is not guaranteed that the existing
containers are notified when this method returns. This can (and
usually will) happen at any time in the future.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:send_admin_message">
  <a href="index.html#/classtype:controller/method:send_admin_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> send_admin_message : string <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>send_message destination msgname msgargs</code>: Sends an admin message to
<code>destination</code>.</p>
      
      <p>See <code>send_message</code> for the notification guarantees.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:register_lever">
  <a href="index.html#/classtype:controller/method:register_lever" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> register_lever : (<a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a>) <span class="rarr"><span>-&gt;</span></span> int
  
      <div class="doc">
        
      <p><code>let id = register_lever f</code>: It is possible to register a function <code>f</code>
in the controller, and run it over the internal RPC interface from
any container. These functions are called levers. See
<code>activate_lever</code> below. See also
<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_cenv/">Netplex_cenv</a>.<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_cenv/#/module:Make_lever">Make_lever</a> for a convenient way to create
and use levers.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:activate_lever">
  <a href="index.html#/classtype:controller/method:activate_lever" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> activate_lever : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a>
  
      <div class="doc">
        
      <p>Runs the registered lever directly</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:containers">
  <a href="index.html#/classtype:controller/method:containers" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> containers : <a href="index.html#/type:container_id">container_id</a> list
  
      <div class="doc">
        
      <p>Lists the containers</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:containers_for">
  <a href="index.html#/classtype:controller/method:containers_for" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> containers_for : string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_id">container_id</a> list
  
      <div class="doc">
        
      <p>Lists the containers for a certain socket service name</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:container_count">
  <a href="index.html#/classtype:controller/method:container_count" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> container_count : string <span class="rarr"><span>-&gt;</span></span> int
  
      <div class="doc">
        
      <p>The number of containers for a certain socket service name</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:free_resources">
  <a href="index.html#/classtype:controller/method:free_resources" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> free_resources : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Should be called when the controller is finished, in order to
free resources again. E.g. plugins are unplugged, and the master
sockets are closed.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller/method:startup_directory">
  <a href="index.html#/classtype:controller/method:startup_directory" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> startup_directory : string
  
      <div class="doc">
        
      <p>The current directory at startup time</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>The controller is the object in the Netplex master process/thread
that manages the containers, logging, and service definitions</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller_config">
  <a href="index.html#/classtype:controller_config" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> controller_config = 
  <div class="region" id="/classtype:controller_config/method:socket_directory">
  <a href="index.html#/classtype:controller_config/method:socket_directory" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> socket_directory : string
  
      <div class="doc">
        
      <p>The directory where Unix domain sockets are created. For every
service a subdirectory is created, and the socket has the name
of the protocol.</p>
      
      <p>This is always an absolute path, even if it is only given as
relative path in the config file.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller_config/method:create_logger">
  <a href="index.html#/classtype:controller_config/method:create_logger" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_logger : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:logger">logger</a>
  
      <div class="doc">
        
      <p>Create a logger to be used for the whole Netplex system. The
controller is already initialized which makes it possible to
write the logger as Netplex service. Messages arriving during the
creation are queued up and sent afterwards to the new logger.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller_config/method:max_level">
  <a href="index.html#/classtype:controller_config/method:max_level" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> max_level : <a href="index.html#/type:level">level</a>
  
      <div class="doc">
        
      <p>Return the maximum global log level</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:controller_config/method:set_max_level">
  <a href="index.html#/classtype:controller_config/method:set_max_level" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> set_max_level : <a href="index.html#/type:level">level</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Set the maximum global log level</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service">
  <a href="index.html#/classtype:socket_service" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> socket_service = 
  <div class="region" id="/classtype:socket_service/method:name">
  <a href="index.html#/classtype:socket_service/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
      <div class="doc">
        
      <p>The name of the <code>socket_service</code> is used to identify the service
in the whole netplex process cluster. Names are hierarchical;
name components are separated by dots (e.g. &quot;company.product.service&quot;).
The prefix &quot;netplex.&quot; is reserved for use by Netplex. The name
&quot;netplex.controller&quot; refers to the service provided by the
controller.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:sockets">
  <a href="index.html#/classtype:socket_service/method:sockets" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> sockets : (string * <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> array) list
  
      <div class="doc">
        
      <p>A <code>socket_service</code> consists of a list of supported protocols
which are identified by a name. Every protocol is available
on a list of sockets (which may be bound to different addresses).
The sockets corresponding to <code>`Container</code> addresses are missing
here.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:socket_service_config">
  <a href="index.html#/classtype:socket_service/method:socket_service_config" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> socket_service_config : <a href="index.html#/classtype:socket_service_config">socket_service_config</a>
  
      <div class="doc">
        
      <p>The configuration</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:processor">
  <a href="index.html#/classtype:socket_service/method:processor" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> processor : <a href="index.html#/classtype:processor">processor</a>
  
      <div class="doc">
        
      <p>A user-supplied object to process incoming connections</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:shutdown">
  <a href="index.html#/classtype:socket_service/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Shuts down the master sockets</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:create_container">
  <a href="index.html#/classtype:socket_service/method:create_container" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_container : <a href="index.html#/type:parallelization_type">parallelization_type</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:container">container</a>
  
      <div class="doc">
        
      <p><b>Internal method.</b> Called by the controller to create a new
container. The container must match the parallelization type of
the controller. This call is already done in the process/thread
provided for the container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:on_add">
  <a href="index.html#/classtype:socket_service/method:on_add" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> on_add : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Get some runtime configuration aspects from this controller. This
is called when the socket service is added to the controller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service/method:startup_directory">
  <a href="index.html#/classtype:socket_service/method:startup_directory" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> startup_directory : string
  
      <div class="doc">
        
      <p>The current directory at Netplex startup time (same view as controller)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config">
  <a href="index.html#/classtype:socket_service_config" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> socket_service_config = 
  <div class="region" id="/classtype:socket_service_config/method:name">
  <a href="index.html#/classtype:socket_service_config/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
      <div class="doc">
        
      <p>The proposed name for the <code>socket_service</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:protocols">
  <a href="index.html#/classtype:socket_service_config/method:protocols" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> protocols : <a href="index.html#/classtype:protocol">protocol</a> list
  
      <div class="doc">
        
      <p>This list describes the sockets to create in detail</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:change_user_to">
  <a href="index.html#/classtype:socket_service_config/method:change_user_to" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> change_user_to : (int * int) option
  
      <div class="doc">
        
      <p>Instructs the container to change the user of the process after
starting the service. This is only possible in multi-processing mode.
In multi-threading mode, this parameter is ignored.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:startup_timeout">
  <a href="index.html#/classtype:socket_service_config/method:startup_timeout" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> startup_timeout : float
  
      <div class="doc">
        
      <p>After this many seconds the container must have finished the
<code>post_start_hook</code>. It is usually 60 seconds.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:conn_limit">
  <a href="index.html#/classtype:socket_service_config/method:conn_limit" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> conn_limit : int option
  
      <div class="doc">
        
      <p>An optional limit of the number of connections this container
can accept. If the limit is reached, the container will not
accept any further connections, and shut down when all connections
are processed.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:gc_when_idle">
  <a href="index.html#/classtype:socket_service_config/method:gc_when_idle" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> gc_when_idle : bool
  
      <div class="doc">
        
      <p>If set, idle containers run a <code>Gc.full_major</code> cycle.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_service_config/method:controller_config">
  <a href="index.html#/classtype:socket_service_config/method:controller_config" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> controller_config : <a href="index.html#/classtype:controller_config">controller_config</a>
  
      <div class="doc">
        
      <p>Make this config accessible here too, for convenience</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol">
  <a href="index.html#/classtype:protocol" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> protocol = 
  <div class="region" id="/classtype:protocol/method:name">
  <a href="index.html#/classtype:protocol/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
      <div class="doc">
        
      <p>The protocol name is an arbitrary string identifying groups of
sockets serving the same protocol for a <code>socket_service</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:addresses">
  <a href="index.html#/classtype:protocol/method:addresses" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> addresses : <a href="index.html#/type:extended_address">extended_address</a> array
  
      <div class="doc">
        
      <p>The addresses of the master sockets. (The socket type is always
SOCK_STREAM.) The list must be non-empty.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:lstn_backlog">
  <a href="index.html#/classtype:protocol/method:lstn_backlog" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> lstn_backlog : int
  
      <div class="doc">
        
      <p>The backlog (argument of Unix.listen)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:lstn_reuseaddr">
  <a href="index.html#/classtype:protocol/method:lstn_reuseaddr" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> lstn_reuseaddr : bool
  
      <div class="doc">
        
      <p>Whether to reuse ports immediately</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:so_keepalive">
  <a href="index.html#/classtype:protocol/method:so_keepalive" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> so_keepalive : bool
  
      <div class="doc">
        
      <p>Whether to set the keep-alive socket option</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:tcp_nodelay">
  <a href="index.html#/classtype:protocol/method:tcp_nodelay" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> tcp_nodelay : bool
  
      <div class="doc">
        
      <p>Whether to set the TCP_NODELAY option</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:protocol/method:configure_slave_socket">
  <a href="index.html#/classtype:protocol/method:configure_slave_socket" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> configure_slave_socket : <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function to configure slave sockets (after <code>accept</code>).
The function is called from the process/thread of the container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller">
  <a href="index.html#/classtype:socket_controller" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> socket_controller = 
  <div class="region" id="/classtype:socket_controller/method:state">
  <a href="index.html#/classtype:socket_controller/method:state" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> state : <a href="index.html#/type:socket_state">socket_state</a>
  
      <div class="doc">
        
      <p>The current state</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:enable">
  <a href="index.html#/classtype:socket_controller/method:enable" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> enable : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Enables a disabled socket service again</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:disable">
  <a href="index.html#/classtype:socket_controller/method:disable" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> disable : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Disable a socket service temporarily</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:restart">
  <a href="index.html#/classtype:socket_controller/method:restart" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> restart : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Restarts the containers for this socket service only</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:shutdown">
  <a href="index.html#/classtype:socket_controller/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Closes the socket service forever, and initiates a shutdown of all
containers serving this type of service.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:container_state">
  <a href="index.html#/classtype:socket_controller/method:container_state" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> container_state : (<a href="index.html#/type:container_id">container_id</a> * string * <a href="index.html#/type:container_state">container_state</a> * bool) list
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:start_containers">
  <a href="index.html#/classtype:socket_controller/method:start_containers" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> start_containers : int <span class="rarr"><span>-&gt;</span></span> int
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:socket_controller/method:stop_containers">
  <a href="index.html#/classtype:socket_controller/method:stop_containers" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> stop_containers : <a href="index.html#/type:container_id">container_id</a> list <span class="rarr"><span>-&gt;</span></span> unit
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ctrl_message_receiver">
  <a href="index.html#/classtype:ctrl_message_receiver" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> ctrl_message_receiver = 
  <div class="region" id="/classtype:ctrl_message_receiver/method:name">
  <a href="index.html#/classtype:ctrl_message_receiver/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
      <div class="doc">
        
      <p>The name of this receiver</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ctrl_message_receiver/method:receive_message">
  <a href="index.html#/classtype:ctrl_message_receiver/method:receive_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> receive_message : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This function is called when a broadcast message is received.
The first string is the name of the message, and the array are
the arguments.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ctrl_message_receiver/method:receive_admin_message">
  <a href="index.html#/classtype:ctrl_message_receiver/method:receive_admin_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> receive_admin_message : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This function is called when a broadcast admin message is received.
The first string is the name of the message, and the array are
the arguments.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks">
  <a href="index.html#/classtype:processor_hooks" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> processor_hooks = 
  <div class="region" id="/classtype:processor_hooks/method:post_add_hook">
  <a href="index.html#/classtype:processor_hooks/method:post_add_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> post_add_hook : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called after the service has been
added to the controller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:post_rm_hook">
  <a href="index.html#/classtype:processor_hooks/method:post_rm_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> post_rm_hook : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called after the service has been
removed from the controller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:pre_start_hook">
  <a href="index.html#/classtype:processor_hooks/method:pre_start_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> pre_start_hook : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_id">container_id</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called before the container is
created and started. It is called from the process/thread of the
controller.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:post_start_hook">
  <a href="index.html#/classtype:processor_hooks/method:post_start_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> post_start_hook : <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called after the container is
created and started, but before the first service request arrives.
It is called from the process/thread of the
container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:pre_finish_hook">
  <a href="index.html#/classtype:processor_hooks/method:pre_finish_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> pre_finish_hook : <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called just before the container is
terminated. It is called from the process/thread of the
container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:post_finish_hook">
  <a href="index.html#/classtype:processor_hooks/method:post_finish_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> post_finish_hook : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_id">container_id</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called after the container is
terminated. It is called from the process/thread of the
controller.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:workload_hook">
  <a href="index.html#/classtype:processor_hooks/method:workload_hook" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> workload_hook : <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> bool <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called when the workload
changes, i.e. a new connection has been accepted, or an
existing connection could be completely processed.
The <code>bool</code> argument is <code>true</code> if the reason is a new
connection. The <code>int</code> argument is the number of connections.
This function is called from the process/thread of the container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:receive_message">
  <a href="index.html#/classtype:processor_hooks/method:receive_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> receive_message : <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This function is called when a broadcast message is received.
The first string is the name of the message, and the array are
the arguments.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:receive_admin_message">
  <a href="index.html#/classtype:processor_hooks/method:receive_admin_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> receive_admin_message : <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This function is called when a broadcast admin message is received.
The first string is the name of the message, and the array are
the arguments.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:system_shutdown">
  <a href="index.html#/classtype:processor_hooks/method:system_shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> system_shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called when a system shutdown
notification arrives. This notification is just for information
that every container of the system will soon be shut down. The
system is still completely up at the time this notification
arrives, so if the services of other components are required to
go down this is the right point in time to do that (e.g. send
important data to a storage component).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:shutdown">
  <a href="index.html#/classtype:processor_hooks/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called when a shutdown notification
arrives. That means that the container should terminate ASAP.
There is, however, no time limitation. The termination is started
by calling the <code>when_done</code> function passed to the <code>process</code> method.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:global_exception_handler">
  <a href="index.html#/classtype:processor_hooks/method:global_exception_handler" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> global_exception_handler : exn <span class="rarr"><span>-&gt;</span></span> bool
  
      <div class="doc">
        
      <p>This method is called when an uncaught exception would otherwise
terminate the container. It can return <code>true</code> to indicate that
the container continues running.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:container_event_system">
  <a href="index.html#/classtype:processor_hooks/method:container_event_system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> container_event_system : unit <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a>
  
      <div class="doc">
        
      <p>This method is called to get the event systems for containers.
This is normally a <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/class:standard_event_system">standard_event_system</a>, but
users can override it.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_hooks/method:container_run">
  <a href="index.html#/classtype:processor_hooks/method:container_run" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> container_run : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>container_run esys</code>: By default, it just runs <code>esys#run()</code>.
This method is called to run the event system of the containers.
Users can override it.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>Processor hooks can be used to modify the behavior of a processor.
See [root:Netplex_intro].servproc for some documentation about the hooks.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor">
  <a href="index.html#/classtype:processor" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> processor = 
    <div class="inherit">
    <span class="keyword">inherit</span> <a href="index.html#/classtype:processor_hooks">processor_hooks</a>
    </div>
    
  <div class="region" id="/classtype:processor/method:process">
  <a href="index.html#/classtype:processor/method:process" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> process : when_done:(unit <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:container">container</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>A user-supplied function that is called when a new socket connection
is established. The function can now process the requests arriving
over the connection. It is allowed to use the event system of the
container, and to return immediately (multiplexing processor). It is
also allowed to process the requests synchronously and to first return
to the caller when the connection is terminated.</p>
      
      <p>The function <b>must</b> call <code>when_done</code> to indicate that it processed
this connection completely.</p>
      
      <p>The string argument is the protocol name.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor/method:supported_ptypes">
  <a href="index.html#/classtype:processor/method:supported_ptypes" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supported_ptypes : <a href="index.html#/type:parallelization_type">parallelization_type</a> list
  
      <div class="doc">
        
      <p>The supported parallelization types</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>The processor is the object that is notified when a new TCP connection
is accepted. The processor has to include the protocol interpreter that
reads and write data on this connection. See [root:Netplex_intro].defproc
for an example how to define a processor.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container">
  <a href="index.html#/classtype:container" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> container = 
  <div class="region" id="/classtype:container/method:socket_service_name">
  <a href="index.html#/classtype:container/method:socket_service_name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> socket_service_name : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:socket_service">
  <a href="index.html#/classtype:container/method:socket_service" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> socket_service : <a href="index.html#/classtype:socket_service">socket_service</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:container_id">
  <a href="index.html#/classtype:container/method:container_id" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> container_id : <a href="index.html#/type:container_id">container_id</a>
  
      <div class="doc">
        
      <p>Return the container ID</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:ptype">
  <a href="index.html#/classtype:container/method:ptype" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ptype : <a href="index.html#/type:parallelization_type">parallelization_type</a>
  
      <div class="doc">
        
      <p>The parallelization type actually used for this container</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:event_system">
  <a href="index.html#/classtype:container/method:event_system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> event_system : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/class:unix_event_system">unix_event_system</a>
  
      <div class="doc">
        
      <p>The event system the container uses</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:start">
  <a href="index.html#/classtype:container/method:start" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> start : <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><b>Internal Method.</b> Called by the controller to start the container.
It is the responsibility of the container to call the
<code>post_start_hook</code> and the <code>pre_finish_hook</code>.</p>
      
      <p>The file descriptors are endpoints of RPC connections to the
controller. The first serves calls of the <code>Control</code> program,
and the second serves calls of the <code>System</code> program.</p>
      
      <p>When <code>start</code> returns the container will be terminated.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:shutdown">
  <a href="index.html#/classtype:container/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Initiates a shutdown of the container.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:n_connections">
  <a href="index.html#/classtype:container/method:n_connections" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> n_connections : int
  
      <div class="doc">
        
      <p>The current number of connections</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:n_total">
  <a href="index.html#/classtype:container/method:n_total" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> n_total : int
  
      <div class="doc">
        
      <p>The sum of all connections so far</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:system">
  <a href="index.html#/classtype:container/method:system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> system : <a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_client/">Rpc_client</a>.<a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_client/#/type:t">t</a>
  
      <div class="doc">
        
      <p>An RPC client that can be used to send messages to the controller.
Only available while <code>start</code> is running. It is bound to
<code>System.V1</code>.</p>
      
      <p>In multi-threaded programs access to <code>system</code> must be governed
by <code>system_monitor</code>. See [root:Uq_mt] for details what this means.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:system_monitor">
  <a href="index.html#/classtype:container/method:system_monitor" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> system_monitor : <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_mt/">Uq_mt</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_mt/#/type:monitor">monitor</a>
  
      <div class="doc">
        
      <p>The thread monitor protecting the <code>system</code> RPC client</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:lookup">
  <a href="index.html#/classtype:container/method:lookup" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> lookup : string <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string option
  
      <div class="doc">
        
      <p><code>lookup service_name protocol_name</code> tries to find a Unix domain
socket for the service and returns it.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:lookup_container_sockets">
  <a href="index.html#/classtype:container/method:lookup_container_sockets" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> lookup_container_sockets : string <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array
  
      <div class="doc">
        
      <p><code>lookup_container_sockets service_name protocol_name</code>: returns
the Unix Domain paths of all container sockets for this service and
protocol. These are the sockets declared with address type
&quot;container&quot; in the config file.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:owned_container_sockets">
  <a href="index.html#/classtype:container/method:owned_container_sockets" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> owned_container_sockets : (string * string) list
  
      <div class="doc">
        
      <p>List of pairs <code>(protocol_name, path)</code> of all container sockets
of this container</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:send_message">
  <a href="index.html#/classtype:container/method:send_message" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> send_message : string <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> string array <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>send_message service_pattern msg_name msg_arguments</code>: Sends
a message to all services and message receivers matching
<code>service_pattern</code>. The pattern may include the wildcard <code>*</code>.</p>
      
      <p>See the <a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_types/">Netplex_types</a>.<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_types/#/classtype:controller">controller</a>.<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_types/#/classtype:controller/method:send_message">send_message</a> method for
the notification guarantees.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:log">
  <a href="index.html#/classtype:container/method:log" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> log : <a href="index.html#/type:level">level</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Sends a log message to the controller.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:log_subch">
  <a href="index.html#/classtype:container/method:log_subch" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> log_subch : string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:level">level</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Sends a log message to the controller. The first string is the
subchannel</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:update_detail">
  <a href="index.html#/classtype:container/method:update_detail" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> update_detail : <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Update the detail string output for the <code>netplex.connections</code>
admin message</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:var">
  <a href="index.html#/classtype:container/method:var" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> var : string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:param_value_or_any">param_value_or_any</a>
  
      <div class="doc">
        
      <p>Returns the value of a container variable or <code>Not_found</code>. Container
variables can be used by the user of a container to store additional
values in the container. These values exist once per thread/process.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:set_var">
  <a href="index.html#/classtype:container/method:set_var" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> set_var : string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:param_value_or_any">param_value_or_any</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Sets the value of a container variable</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:call_plugin">
  <a href="index.html#/classtype:container/method:call_plugin" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> call_plugin : <a href="index.html#/classtype:plugin">plugin</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/">Xdr</a>.<a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/#/type:xdr_value">xdr_value</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/">Xdr</a>.<a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/#/type:xdr_value">xdr_value</a>
  
      <div class="doc">
        
      <p><code>call_plugin p procname procarg</code>: This method can be called
from the container context to invoke the plugin <code>p</code> procedure
<code>procname</code>. This means that the <code>ctrl_receive_call</code> of the
same plugin is invoked in the controller context.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:activate_lever">
  <a href="index.html#/classtype:container/method:activate_lever" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> activate_lever : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:encap">encap</a>
  
      <div class="doc">
        
      <p>Runs a lever function registered in the controller. The <code>int</code>
argument identifies the lever. The <code>encap</code> argument is the parameter,
and the returned exception is the result. See also
<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_cenv/">Netplex_cenv</a>.<a href="../../../../ocamlnet.3.7.7/src/netplex/netplex_cenv/#/module:Make_lever">Make_lever</a> for a convenient way to create
and use levers.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:container/method:startup_directory">
  <a href="index.html#/classtype:container/method:startup_directory" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> startup_directory : string
  
      <div class="doc">
        
      <p>The current directory at Netplex startup time (same view as controller)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>Containers encapsulate the control flow of the service components.
A container is run in a separate thread or process.</p>
      
      <p><b>Thread safety:</b> All methods except <code>start</code> can be called from
any thread, and provide full thread safety.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager">
  <a href="index.html#/classtype:workload_manager" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> workload_manager = 
  <div class="region" id="/classtype:workload_manager/method:hello">
  <a href="index.html#/classtype:workload_manager/method:hello" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> hello : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Called by the controller when the service is added</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager/method:shutdown">
  <a href="index.html#/classtype:workload_manager/method:shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> shutdown : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Called by the controller to notify the manager about a shutdown</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager/method:adjust">
  <a href="index.html#/classtype:workload_manager/method:adjust" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> adjust : <a href="index.html#/classtype:socket_service">socket_service</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:socket_controller">socket_controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This function is called by the controller at certain events to
adjust the number of available containers. The manager can
call <code>start_containers</code> and <code>stop_containers</code> to change the
system.</p>
      
      <p>The function is called right after the startup to ensure
that there are containers to serve requests. It is also called:</p>
      <ul><li>just after a connection has been accepted and before it is
decided which container will have the chance to accept in the
round</li><li>after the shutdown of a container</li></ul>
      <p>Of course, the workload manager is free to adjust the load
at any other time, too, not only when <code>adjust</code> is called.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager/method:capacity">
  <a href="index.html#/classtype:workload_manager/method:capacity" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> capacity : <a href="index.html#/type:container_id">container_id</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_state">container_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:capacity">capacity</a>
  
      <div class="doc">
        
      <p>Computes the capacity, i.e. the number of jobs a certain container
can accept in addition to the existing load.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>See [root:Netplex_workload] for definitions of workload managers</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin">
  <a href="index.html#/classtype:plugin" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> plugin = 
  <div class="region" id="/classtype:plugin/method:required">
  <a href="index.html#/classtype:plugin/method:required" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> required : <a href="index.html#/classtype:plugin">plugin</a> list
  
      <div class="doc">
        
      <p>Required plugins</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin/method:program">
  <a href="index.html#/classtype:plugin/method:program" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> program : <a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_program/">Rpc_program</a>.<a href="../../../../ocamlnet.3.7.7/src/rpc/rpc_program/#/type:t">t</a>
  
      <div class="doc">
        
      <p>The RPC program structure on which the messaging bases. The program,
version and procedure numbers are ignored</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin/method:ctrl_added">
  <a href="index.html#/classtype:plugin/method:ctrl_added" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ctrl_added : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This method is invoked when the plugin has been added to this
controller. Note that plugins can be added to several controllers.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin/method:ctrl_unplugged">
  <a href="index.html#/classtype:plugin/method:ctrl_unplugged" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ctrl_unplugged : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>The plugin has been unplugged from this controller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin/method:ctrl_receive_call">
  <a href="index.html#/classtype:plugin/method:ctrl_receive_call" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ctrl_receive_call : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_id">container_id</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/">Xdr</a>.<a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/#/type:xdr_value">xdr_value</a> <span class="rarr"><span>-&gt;</span></span> (<a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/">Xdr</a>.<a href="../../../../ocamlnet.3.7.7/src/netstring/xdr/#/type:xdr_value">xdr_value</a> option <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p><code>ctrl_receive_call ctrl cid procname procarg emit</code>:
This method is called in the controller context <code>ctrl</code> when a procedure
named <code>procname</code> is called. In <code>procarg</code> the argument of the
procedure is passed. <code>cid</code> is the container ID from where the
call originates. To pass the result <code>r</code> of the call back to the caller,
is is required to call <code>emit (Some r)</code> (either immediately, or at
some time in the future). By calling <code>emit None</code>, an error condition
is propagated back to the caller.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:plugin/method:ctrl_container_finished">
  <a href="index.html#/classtype:plugin/method:ctrl_container_finished" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ctrl_container_finished : <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:container_id">container_id</a> <span class="rarr"><span>-&gt;</span></span> bool <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>This method is called when a container finishes
(after <code>post_finish_hook</code>).
The boolean is true if the container is the last of the terminated
socket service.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>Plugins are extensions of the Netplex system that run in the controller
and can be invoked from containers</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:par_thread">
  <a href="index.html#/classtype:par_thread" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> par_thread = 
  <div class="region" id="/classtype:par_thread/method:ptype">
  <a href="index.html#/classtype:par_thread/method:ptype" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ptype : <a href="index.html#/type:parallelization_type">parallelization_type</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:par_thread/method:sys_id">
  <a href="index.html#/classtype:par_thread/method:sys_id" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> sys_id : <a href="index.html#/type:thread_sys_id">thread_sys_id</a>
  
      <div class="doc">
        
      <p>Returns a system-dependent identifier for the thread:</p>
      <ul><li><code>`Thread id</code>: The <code>id</code> as returned by <code>Thread.id</code></li><li><code>`Process id</code>: The <code>id</code> is the process ID</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:par_thread/method:info_string">
  <a href="index.html#/classtype:par_thread/method:info_string" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> info_string : string
  
      <div class="doc">
        
      <p>Outputs the process or thread ID</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:par_thread/method:watch_shutdown">
  <a href="index.html#/classtype:par_thread/method:watch_shutdown" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> watch_shutdown : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/class:unix_event_system">unix_event_system</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Called by the controller if it thinks the container is down.
<b>This method must not be called outside the internal Netplex
implementation!</b></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:par_thread/method:parallelizer">
  <a href="index.html#/classtype:par_thread/method:parallelizer" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> parallelizer : <a href="index.html#/classtype:parallelizer">parallelizer</a>
  
      <div class="doc">
        
      <p>Returns the parallelizer that created this thread. Can be used
to start another thread of the same type.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:parallelizer">
  <a href="index.html#/classtype:parallelizer" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> parallelizer = 
  <div class="region" id="/classtype:parallelizer/method:ptype">
  <a href="index.html#/classtype:parallelizer/method:ptype" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ptype : <a href="index.html#/type:parallelization_type">parallelization_type</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:parallelizer/method:init">
  <a href="index.html#/classtype:parallelizer/method:init" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> init : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Initializes the main process for usage with this parallelizer.
<b>This method must not be called outside the internal Netplex
implementation!</b></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:parallelizer/method:start_thread">
  <a href="index.html#/classtype:parallelizer/method:start_thread" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> start_thread : (<a href="index.html#/classtype:par_thread">par_thread</a> <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> list <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a> list <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:logger">logger</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:par_thread">par_thread</a>
  
      <div class="doc">
        
      <p><code>start_thread f l_close l_share name logger</code>:
Starts a new thread or process and calls
<code>f thread</code> in that context. Before this is done, file descriptors
are closed, controlled by the parameters <code>l_close</code> and <code>l_share</code>.
The descriptors in <code>l_close</code> are always closed. The descriptors
in <code>l_share</code> are not closed. The implementation of the parallelizer
is free to close a reasonable set of descriptors, and <code>l_close</code>
is the minimum, and <code>all - l_share</code> is the maximum.</p>
      
      <p>There is no way to check when the thread terminates.</p>
      
      <p>It is allowed that the <code>par_thread</code> object passed to <code>f</code> is a different
object as the returned <code>par_thread</code> object.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:parallelizer/method:create_mem_mutex">
  <a href="index.html#/classtype:parallelizer/method:create_mem_mutex" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_mem_mutex : unit <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> unit) * (unit <span class="rarr"><span>-&gt;</span></span> unit)
  
      <div class="doc">
        
      <p><code>let lock, unlock = par#create_mem_locker()</code>: Creates a mutex that
is sufficient to protect process memory from uncoordinated access.
The function <code>lock</code> obtains the lock, and <code>unlock</code> releases it.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:parallelizer/method:current_sys_id">
  <a href="index.html#/classtype:parallelizer/method:current_sys_id" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> current_sys_id : [ <div class="cons">| `Thread <span class="keyword">of</span> int</div><div class="cons">| `Process <span class="keyword">of</span> int</div> ]
  
      <div class="doc">
        
      <p>Returns the system-dependent thread identifier of the caller</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/type:config_tree">
  <a href="index.html#/type:config_tree" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> config_tree = [ <div class="cons">| `Section <span class="keyword">of</span> string * <a href="index.html#/type:config_tree">config_tree</a> list</div><div class="cons">| `Parameter <span class="keyword">of</span> string * <a href="index.html#/type:param_value">param_value</a></div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/type:address">
  <a href="index.html#/type:address" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> address = &lt;  &gt;
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file">
  <a href="index.html#/classtype:config_file" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> config_file = 
  <div class="region" id="/classtype:config_file/method:filename">
  <a href="index.html#/classtype:config_file/method:filename" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> filename : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:tree">
  <a href="index.html#/classtype:config_file/method:tree" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> tree : <a href="index.html#/type:config_tree">config_tree</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:root_addr">
  <a href="index.html#/classtype:config_file/method:root_addr" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> root_addr : <a href="index.html#/type:address">address</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:root_name">
  <a href="index.html#/classtype:config_file/method:root_name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> root_name : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:resolve_section">
  <a href="index.html#/classtype:config_file/method:resolve_section" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> resolve_section : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:address">address</a> list
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:resolve_parameter">
  <a href="index.html#/classtype:config_file/method:resolve_parameter" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> resolve_parameter : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:address">address</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:print">
  <a href="index.html#/classtype:config_file/method:print" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> print : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:string_param">
  <a href="index.html#/classtype:config_file/method:string_param" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> string_param : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:int_param">
  <a href="index.html#/classtype:config_file/method:int_param" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> int_param : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> int
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:float_param">
  <a href="index.html#/classtype:config_file/method:float_param" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> float_param : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> float
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:bool_param">
  <a href="index.html#/classtype:config_file/method:bool_param" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> bool_param : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> bool
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:restrict_subsections">
  <a href="index.html#/classtype:config_file/method:restrict_subsections" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> restrict_subsections : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string list <span class="rarr"><span>-&gt;</span></span> unit
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:config_file/method:restrict_parameters">
  <a href="index.html#/classtype:config_file/method:restrict_parameters" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> restrict_parameters : <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> string list <span class="rarr"><span>-&gt;</span></span> unit
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_factory">
  <a href="index.html#/classtype:processor_factory" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> processor_factory = 
  <div class="region" id="/classtype:processor_factory/method:name">
  <a href="index.html#/classtype:processor_factory/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:processor_factory/method:create_processor">
  <a href="index.html#/classtype:processor_factory/method:create_processor" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_processor : <a href="index.html#/classtype:controller_config">controller_config</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:config_file">config_file</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:processor">processor</a>
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager_factory">
  <a href="index.html#/classtype:workload_manager_factory" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> workload_manager_factory = 
  <div class="region" id="/classtype:workload_manager_factory/method:name">
  <a href="index.html#/classtype:workload_manager_factory/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:workload_manager_factory/method:create_workload_manager">
  <a href="index.html#/classtype:workload_manager_factory/method:create_workload_manager" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_workload_manager : <a href="index.html#/classtype:controller_config">controller_config</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:config_file">config_file</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:workload_manager">workload_manager</a>
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:logger_factory">
  <a href="index.html#/classtype:logger_factory" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> logger_factory = 
  <div class="region" id="/classtype:logger_factory/method:name">
  <a href="index.html#/classtype:logger_factory/method:name" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> name : string
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:logger_factory/method:create_logger">
  <a href="index.html#/classtype:logger_factory/method:create_logger" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> create_logger : <a href="index.html#/classtype:config_file">config_file</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:address">address</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:controller">controller</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/classtype:logger">logger</a>
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:netplex_config">
  <a href="index.html#/classtype:netplex_config" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> netplex_config = 
  <div class="region" id="/classtype:netplex_config/method:ptype">
  <a href="index.html#/classtype:netplex_config/method:ptype" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ptype : <a href="index.html#/type:parallelization_type">parallelization_type</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:netplex_config/method:controller_config">
  <a href="index.html#/classtype:netplex_config/method:controller_config" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> controller_config : <a href="index.html#/classtype:controller_config">controller_config</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/classtype:netplex_config/method:services">
  <a href="index.html#/classtype:netplex_config/method:services" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> services : (<a href="index.html#/classtype:socket_service_config">socket_service_config</a> * (<a href="index.html#/type:address">address</a> * <a href="index.html#/classtype:processor_factory">processor_factory</a>) * (<a href="index.html#/type:address">address</a> * <a href="index.html#/classtype:workload_manager_factory">workload_manager_factory</a>)) list
  
  </div>
  
  </div>
  
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>