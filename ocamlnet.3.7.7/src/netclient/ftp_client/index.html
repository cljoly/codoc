<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Ftp_client</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Ftp_client</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>FTP client</p>
      
      <p>Currently implements:</p>
      <ul><li>Core FTP (RFC 959), except compressed transfer modes, and except page
files</li><li>Negotiation of FTP extensions (RFC 2389)</li><li>Common FTP extensions (RFC 3659)</li><li>IPv6 (RFC 2428)</li><li>Internationalization (RFC 2640)</li><li>Directory walking (NVFS) and direct access (TVFS)</li></ul>
      <p>The client is written in asynchronous style (using [root:Uq_engines]).</p>
      
      <p>The interface of this module was changed in Ocamlnet-3.3. Before this
release, the module was marked as &quot;experimental&quot;. This is no longer
the case, as the interface has been updated, and the missing features
have been added (e.g. <code>STOR</code> support).</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/exn:FTP_error">
  <a href="index.html#/exn:FTP_error" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_error <span class="keyword">of</span> exn
    
      <div class="doc">
        
      <p>Something went wrong, often on socket level</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:FTP_protocol_violation">
  <a href="index.html#/exn:FTP_protocol_violation" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_protocol_violation <span class="keyword">of</span> string
    
      <div class="doc">
        
      <p>The server violates the FTP specification</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:FTP_timeout">
  <a href="index.html#/exn:FTP_timeout" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_timeout <span class="keyword">of</span> string
    
      <div class="doc">
        
      <p>A timeout on the control or data connection (this is a fatal error)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:cmd_state">
  <a href="index.html#/type:cmd_state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> cmd_state = [ <div class="cons">| `Not_connected</div><div class="cons">| `Init</div><div class="cons">| `Success</div><div class="cons">| `Proto_error</div><div class="cons">| `Temp_failure</div><div class="cons">| `Perm_failure</div><div class="cons">| `Rename_seq</div><div class="cons">| `Restart_seq</div><div class="cons">| `User_pass_seq</div><div class="cons">| `User_acct_seq</div><div class="cons">| `Pass_acct_seq</div><div class="cons">| `Preliminary</div> ]
    
      <div class="doc">
        
      <p>The command state:</p>
      <ul><li><code>`Not_connected</code>: Not connected.</li><li><code>`Init</code>: Just connected, no greeting message arrived yet</li><li><code>`Success</code>: Got the greeting message/last command was successful</li><li><code>`Proto_error</code>: <b>currently unused</b></li><li><code>`Temp_failure</code>: Last command was not successful, and the code
was between 400 and 499</li><li><code>`Perm_failure</code>: Last command was not successful, and the code
was between 500 and 599</li><li><code>`Rename_seq</code>: Used instead of <code>`Success</code> after the RNFR command</li><li><code>`Restart_seq</code>: Used instead of <code>`Success</code> after the REST command</li><li><code>`User_pass_seq</code>: Used instead of <code>`Success</code> after the USER command
when a password must be typed in</li><li><code>`User_acct_seq</code>: Used instead of <code>`Success</code> after the USER command
when an account ID must be typed in</li><li><code>`Pass_acct_seq</code>: Used instead of <code>`Success</code> after the PASS command
when an account iD must be typed in</li><li><code>`Preliminary</code>: a reply with code 100 to 199. There will be another
final reply for the command</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:port">
  <a href="index.html#/type:port" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> port = [ <div class="cons">| `Active <span class="keyword">of</span> string * int * <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a></div><div class="cons">| `Passive <span class="keyword">of</span> string * int</div><div class="cons">| `Ext_active <span class="keyword">of</span> string * int * <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:file_descr">file_descr</a></div><div class="cons">| `Ext_passive <span class="keyword">of</span> int</div><div class="cons">| `Unspecified</div> ]
    
      <div class="doc">
        
      <p>The port of the data connection: <code>`Active</code> means that the server
initiates the data connection to the listening client, and in the
case of <code>`Passive</code> the client initiates the data connection to the
listening server. The string argument is the IP address as dotted
quad, the int argument is the port number, and the descriptor
is the listening master socket.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:form_code">
  <a href="index.html#/type:form_code" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> form_code = [ <div class="cons">| `Non_print</div><div class="cons">| `Telnet</div><div class="cons">| `ASA</div> ]
    
      <div class="doc">
        
      <p>The <code>form_code</code> has a meaning when FTP is used to print files:</p>
      <ul><li><code>`Non_print</code>: This is not the case.</li><li><code>`Telnet</code>: Telnet control codes are used for vertical movement</li><li><code>`ASA</code>: ASA (Fortran) control codes are used for vertical movement</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:representation">
  <a href="index.html#/type:representation" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> representation = [ <div class="cons">| `ASCII <span class="keyword">of</span> <a href="index.html#/type:form_code">form_code</a> option</div><div class="cons">| `EBCDIC <span class="keyword">of</span> <a href="index.html#/type:form_code">form_code</a> option</div><div class="cons">| `Image</div> ]
    
      <div class="doc">
        
      <p>The representation of the transferred file:</p>
      <ul><li><code>`ASCII</code>: An ASCII variant is used, i.e. the server sends files in
ASCII encoding with CR/LF as end-of-line marker. Supported by all
servers.</li><li><code>`EBCDIC</code>: An EBCDIC variant is used, i.e. the server sends files in
EBCDIC encoding with NEL as end-of-line marker</li><li><code>`Image</code>: The file is transferred in its original binary
representation. Supported by all servers.</li></ul>
      <p>&quot;Local&quot; representations are not supported.</p>
      
      <p>This FTP client does not recode the files such that they match the
selected representation. When files are downloaded, they are stored
as they are received. When files are uploaded, they are sent as they
are. The user of this client must do recodings when necessary
(the class <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/class:data_converter">data_converter</a> may be useful for this).</p>
      
      <p>If no representation is selected, FTP servers assume <code>`ASCII None</code>
as default.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:structure">
  <a href="index.html#/type:structure" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> structure = [ <div class="cons">| `File_structure</div><div class="cons">| `Record_structure</div> ]
    
      <div class="doc">
        
      <p>The client supports two structures:</p>
      <ul><li><code>`File_structure</code>: Files are simply contiguous streams of bytes</li><li><code>`Record_structure</code>: Files are sequences of records. FTP does
not make a difference between variable and fixed length records.
It is not forbidden that the records are themselves structured
into lines, in fact it can happen that end-of-line markers are
contained in binary records. Operating systems that support
record-structured files often store text files in this format, i.e.
every line is stored in its own record, without end-of-line marker.
If record structure is selected by a STRU command, it is recommended
to use the classes <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/classtype:out_record_channel">out_record_channel</a> and
<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/classtype:in_record_channel">in_record_channel</a> for the local representation
of the files, otherwise the records may be incorrectly mapped
to the local conventions.</li></ul>
      <p>Page-structured files (i.e. indexed files) are not supported.</p>
      
      <p>If no structure is selected, FTP servers will assume file structure
as default.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:transmission_mode">
  <a href="index.html#/type:transmission_mode" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> transmission_mode = [ <div class="cons">| `Stream_mode</div><div class="cons">| `Block_mode</div> ]
    
      <div class="doc">
        
      <p>The transmission mode selects how the data are encoded in the data
connection.</p>
      <ul><li><code>`Stream_mode</code>: This is the simple format that is responsible for
all the failed FTP downloads. It is supported by all FTP servers,
actually, you cannot assume a better transmission mode from an
unknown FTP server. It is unreliable because it cannot distinguish
between a transmission failure and the regular end-of-file condition.</li><li><code>`Block_mode</code>: This is an improved format using frames to protect
the transmitted data. Unfortunately, almost no FTP server supports
it.</li></ul>
      <p>Both modes are compatible with both structures, i.e. you can transfer
a record-structured file in stream mode and a flat file in block
mode. However, in practice this is not the case. Servers that only
know flat files are likely to only support stream mode, and servers
implementing record structure imply that block transfers base on
the record format. So the advice is to use stream mode for flat
files, and block mode for record files.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:ftp_state">
  <a href="index.html#/type:ftp_state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ftp_state = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:cmd_state">
  <a href="index.html#/type:ftp_state/field:cmd_state" class="anchor">#</a>
  cmd_state
  </div>
  </td><td>: <a href="index.html#/type:cmd_state">cmd_state</a></td><td>;</td><td>(*</td><td class="doc">the command state</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_connected">
  <a href="index.html#/type:ftp_state/field:ftp_connected" class="anchor">#</a>
  ftp_connected
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">whether connected with the server</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_data_conn">
  <a href="index.html#/type:ftp_state/field:ftp_data_conn" class="anchor">#</a>
  ftp_data_conn
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">whether there is a clean data conn</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_user">
  <a href="index.html#/type:ftp_state/field:ftp_user" class="anchor">#</a>
  ftp_user
  </div>
  </td><td>: string option</td><td>;</td><td>(*</td><td class="doc">successfully sent user identifier</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_password">
  <a href="index.html#/type:ftp_state/field:ftp_password" class="anchor">#</a>
  ftp_password
  </div>
  </td><td>: string option</td><td>;</td><td>(*</td><td class="doc">successfully sent password</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_account">
  <a href="index.html#/type:ftp_state/field:ftp_account" class="anchor">#</a>
  ftp_account
  </div>
  </td><td>: string option</td><td>;</td><td>(*</td><td class="doc">successfully sent account identifier</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_logged_in">
  <a href="index.html#/type:ftp_state/field:ftp_logged_in" class="anchor">#</a>
  ftp_logged_in
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">whether the user is logged in</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_port">
  <a href="index.html#/type:ftp_state/field:ftp_port" class="anchor">#</a>
  ftp_port
  </div>
  </td><td>: <a href="index.html#/type:port">port</a></td><td>;</td><td>(*</td><td class="doc">the selected port</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_repr">
  <a href="index.html#/type:ftp_state/field:ftp_repr" class="anchor">#</a>
  ftp_repr
  </div>
  </td><td>: <a href="index.html#/type:representation">representation</a></td><td>;</td><td>(*</td><td class="doc">the selected representation</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_structure">
  <a href="index.html#/type:ftp_state/field:ftp_structure" class="anchor">#</a>
  ftp_structure
  </div>
  </td><td>: <a href="index.html#/type:structure">structure</a></td><td>;</td><td>(*</td><td class="doc">the selected structure</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_trans">
  <a href="index.html#/type:ftp_state/field:ftp_trans" class="anchor">#</a>
  ftp_trans
  </div>
  </td><td>: <a href="index.html#/type:transmission_mode">transmission_mode</a></td><td>;</td><td>(*</td><td class="doc">the selected trans mode</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_dir">
  <a href="index.html#/type:ftp_state/field:ftp_dir" class="anchor">#</a>
  ftp_dir
  </div>
  </td><td>: string list</td><td>;</td><td>(*</td><td class="doc">The current directory, expressed as list of CWD changes minus
CDUP changes. This is only reasonable if CWD does not include
slashes. The list is in reverse order, i.e. deepest directory
first.</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_features">
  <a href="index.html#/type:ftp_state/field:ftp_features" class="anchor">#</a>
  ftp_features
  </div>
  </td><td>: (string * string option) list option</td><td>;</td><td>(*</td><td class="doc">The list of features returned by the last FEAT command.
<code>None</code> means that no FEAT command was yet tried.
<code>Some []</code> means that there are no features (either FEAT
returned an empty list, or the FEAT command is not implemented
by the server). Otherwise the list enumerates pairs
<code>(label,param)</code> where <code>label</code> is the case-sensitive feature
label and <code>param</code> the optional parameter. There is no
defined order for the list of features.</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:ftp_state/field:ftp_options">
  <a href="index.html#/type:ftp_state/field:ftp_options" class="anchor">#</a>
  ftp_options
  </div>
  </td><td>: (string * string option) list</td><td>;</td><td>(*</td><td class="doc">Remembers the OPTS commands sent to the server. The list
enumerates pairs <code>(command,optionparam)</code>, where <code>command</code>
is the uppercase command name the option refers to. Only
the last negotiated <code>optionparam</code> for the command is remembered.</td><td>*)</td>
  </tr>
    </table>}
    
      <div class="doc">
        
      <p>The ftp_state reflects the knowledge of the client about what has been
agreed upon with the server.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:cmd">
  <a href="index.html#/type:cmd" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> cmd = [ <div class="cons">| `Connect <span class="keyword">of</span> string * int</div><div class="cons">| `Disconnect</div><div class="cons">| `Dummy</div><div class="cons">| `USER <span class="keyword">of</span> string</div><div class="cons">| `PASS <span class="keyword">of</span> string</div><div class="cons">| `ACCT <span class="keyword">of</span> string</div><div class="cons">| `CWD <span class="keyword">of</span> string</div><div class="cons">| `CDUP</div><div class="cons">| `SMNT <span class="keyword">of</span> string</div><div class="cons">| `QUIT</div><div class="cons">| `REIN</div><div class="cons">| `PORT</div><div class="cons">| `PASV</div><div class="cons">| `TYPE <span class="keyword">of</span> <a href="index.html#/type:representation">representation</a></div><div class="cons">| `STRU <span class="keyword">of</span> <a href="index.html#/type:structure">structure</a></div><div class="cons">| `MODE <span class="keyword">of</span> <a href="index.html#/type:transmission_mode">transmission_mode</a></div><div class="cons">| `RETR <span class="keyword">of</span> string * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>)</div><div class="cons">| `STOR <span class="keyword">of</span> string * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_sender">local_sender</a>)</div><div class="cons">| `STOU <span class="keyword">of</span> <a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_sender">local_sender</a></div><div class="cons">| `APPE <span class="keyword">of</span> string * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_sender">local_sender</a>)</div><div class="cons">| `ALLO <span class="keyword">of</span> int * int option</div><div class="cons">| `REST <span class="keyword">of</span> string</div><div class="cons">| `RNFR <span class="keyword">of</span> string</div><div class="cons">| `RNTO <span class="keyword">of</span> string</div><div class="cons">| `DELE <span class="keyword">of</span> string</div><div class="cons">| `RMD <span class="keyword">of</span> string</div><div class="cons">| `MKD <span class="keyword">of</span> string</div><div class="cons">| `PWD</div><div class="cons">| `LIST <span class="keyword">of</span> string option * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>)</div><div class="cons">| `NLST <span class="keyword">of</span> string option * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>)</div><div class="cons">| `SITE <span class="keyword">of</span> string</div><div class="cons">| `SYST</div><div class="cons">| `STAT <span class="keyword">of</span> string option</div><div class="cons">| `HELP <span class="keyword">of</span> string option</div><div class="cons">| `NOOP</div><div class="cons">| `FEAT</div><div class="cons">| `OPTS <span class="keyword">of</span> string * string option</div><div class="cons">| `EPRT</div><div class="cons">| `EPSV <span class="keyword">of</span> [ <div class="cons">| `AF <span class="keyword">of</span> <a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/">Unix</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/unix/unix/#/type:socket_domain">socket_domain</a></div><div class="cons">| `ALL</div> ] option</div><div class="cons">| `LANG <span class="keyword">of</span> string option</div><div class="cons">| `MDTM <span class="keyword">of</span> string</div><div class="cons">| `SIZE <span class="keyword">of</span> string</div><div class="cons">| `MLST <span class="keyword">of</span> string option</div><div class="cons">| `MLSD <span class="keyword">of</span> string option * (<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>)</div> ]
    
      <div class="doc">
        
      <p>An FTP command. Not all commands are implemented by all servers.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:reply">
  <a href="index.html#/type:reply" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> reply = int * string
    
      <div class="doc">
        
      <p>Reply code plus text</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi">
  <a href="index.html#/classtype:ftp_client_pi" class="anchor">#</a>
  
  <div class="classtype">
    <span class="keyword">class type</span> ftp_client_pi = 
  <div class="region" id="/classtype:ftp_client_pi/method:exec_e">
  <a href="index.html#/classtype:ftp_client_pi/method:exec_e" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> exec_e : ?prelim:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:reply">reply</a> <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:cmd">cmd</a> <span class="rarr"><span>-&gt;</span></span> (<a href="index.html#/type:ftp_state">ftp_state</a> * <a href="index.html#/type:reply">reply</a>) <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:engine">engine</a>
  
      <div class="doc">
        
      <p>Run another command as engine. The command is first started when
the previous command has terminated. The protocol interpreter does
not check whether this command is allowed in the current ftp_state
or not.</p>
      
      <p>When the command is done, the engine transitions to
<code>`Done(st,r)</code> where <code>st</code> is the state after the command, and <code>r</code>
is the final reply of the server.</p>
      
      <p>Due to the FTP specification there may be several replies for
a command: First, zero or more replies with <code>cmd_state = `Preliminary</code>,
and then exactly one reply with a final state. The preliminary replies
can be intercepted with the <code>prelim</code> callback.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:send_abort">
  <a href="index.html#/classtype:ftp_client_pi/method:send_abort" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> send_abort : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Sends immediately an <code>ABOR</code> command, even when a data transfer is
in progress.</p>
      
      <p>TODO - not yet implemented</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:run">
  <a href="index.html#/classtype:ftp_client_pi/method:run" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> run : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Starts the event system; same as <code>Unixqueue.run</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:ftp_state">
  <a href="index.html#/classtype:ftp_client_pi/method:ftp_state" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> ftp_state : <a href="index.html#/type:ftp_state">ftp_state</a>
  
      <div class="doc">
        
      <p>Returns the current ftp_state</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:state">
  <a href="index.html#/classtype:ftp_client_pi/method:state" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> state : unit <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/type:engine_state">engine_state</a>
  
      <div class="doc">
        
      <p>The state in the sense of <code>Uq_engines</code>. Possible values are:</p>
      <ul><li><code>`Working _</code>: The control connection is still active. The <code>int</code>
argument is currently meaningless.</li><li><code>`Done()</code>: The control connection has been terminated.</li><li><code>`Error e</code>: A violation of the FTP protocol happened, or another
exception <code>e</code> occurred</li><li><code>`Aborted</code>: The <code>abort</code> method was called</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:abort">
  <a href="index.html#/classtype:ftp_client_pi/method:abort" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> abort : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Shuts any active connection immediately down, and changes the
state of the engine to <code>`Aborted</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:event_system">
  <a href="index.html#/classtype:ftp_client_pi/method:event_system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> event_system : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a>
  
      <div class="doc">
        
      <p>The used event system</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:request_notification">
  <a href="index.html#/classtype:ftp_client_pi/method:request_notification" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> request_notification : (unit <span class="rarr"><span>-&gt;</span></span> bool) <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>as in <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:engine">engine</a></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:is_empty">
  <a href="index.html#/classtype:ftp_client_pi/method:is_empty" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> is_empty : bool
  
      <div class="doc">
        
      <p>Whether the queue is empty</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:need_ip6">
  <a href="index.html#/classtype:ftp_client_pi/method:need_ip6" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> need_ip6 : bool
  
      <div class="doc">
        
      <p>Whether <code>`EPSV</code> or <code>`EPRT</code> are required instead of
<code>`PASV</code> and <code>`PORT</code>, respectively. This is first set after
connecting to a server (i.e. when the IP address family is known).
Before, it is always <code>false</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        
      <p>Feature tests</p>
      
      <p>The following methods are first set when the <code>`FEAT</code> command is run.
Use <code>feat_method</code> to do so. Until then, always <code>false</code> is returned.</p>
      
        
      </div>
    
  <div class="region" id="/classtype:ftp_client_pi/method:supports_tvfs">
  <a href="index.html#/classtype:ftp_client_pi/method:supports_tvfs" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supports_tvfs : bool
  
      <div class="doc">
        
      <p>Whether TVFS filenames are supported</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:supports_mdtm">
  <a href="index.html#/classtype:ftp_client_pi/method:supports_mdtm" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supports_mdtm : bool
  
      <div class="doc">
        
      <p>Whether the <code>`MDTM</code> command is supported. Note that <code>`MDTM</code> is sometimes
even supported even if the server does not provide the <code>`FEAT</code> command
to test for this feature.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:supports_size">
  <a href="index.html#/classtype:ftp_client_pi/method:supports_size" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supports_size : bool
  
      <div class="doc">
        
      <p>Whether the <code>`SIZE</code> command is supported. Note that <code>`SIZE</code> is sometimes
even supported even if the server does not provide the <code>`FEAT</code> command
to test for this feature.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:supports_mlst">
  <a href="index.html#/classtype:ftp_client_pi/method:supports_mlst" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supports_mlst : bool
  
      <div class="doc">
        
      <p>Whether the <code>`MLST</code> and <code>`MLSD</code> commands are supported</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:mlst_facts">
  <a href="index.html#/classtype:ftp_client_pi/method:mlst_facts" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> mlst_facts : string list
  
      <div class="doc">
        
      <p>All available facts for <code>`MLST</code> and <code>`MLSD</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:mlst_enabled_facts">
  <a href="index.html#/classtype:ftp_client_pi/method:mlst_enabled_facts" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> mlst_enabled_facts : string list
  
      <div class="doc">
        
      <p>The enabled facts for <code>`MLST</code> and <code>`MLSD</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/classtype:ftp_client_pi/method:supports_utf8">
  <a href="index.html#/classtype:ftp_client_pi/method:supports_utf8" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> supports_utf8 : bool
  
      <div class="doc">
        
      <p>Whether the UTF-8 extension is understood by the server (RFC 2640)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
      <div class="doc">
        
      <p>The client protocol interpreter...</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:ftp_method">
  <a href="index.html#/type:ftp_method" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ftp_method = <a href="index.html#/classtype:ftp_client_pi">ftp_client_pi</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:engine">engine</a>
    
      <div class="doc">
        
      <p>An <code>ftp_method</code> is a small procedure doing some task</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:FTP_method_temp_failure">
  <a href="index.html#/exn:FTP_method_temp_failure" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_method_temp_failure <span class="keyword">of</span> int * string
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:FTP_method_perm_failure">
  <a href="index.html#/exn:FTP_method_perm_failure" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_method_perm_failure <span class="keyword">of</span> int * string
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:FTP_method_unexpected_reply">
  <a href="index.html#/exn:FTP_method_unexpected_reply" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> FTP_method_unexpected_reply <span class="keyword">of</span> int * string
    
      <div class="doc">
        
      <p>These exceptions may be raised during execution by the FTP method.
The int is the unexpected FTP control code and the string the
corresponding text. A temporary failure has a code between 400 and
499, and a permanent failure has a code between 500 and 599.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:connect_method">
  <a href="index.html#/val:connect_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> connect_method : host:string <span class="rarr"><span>-&gt;</span></span> ?port:int <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This method connects to the <code>host</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:login_method">
  <a href="index.html#/val:login_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> login_method : user:string <span class="rarr"><span>-&gt;</span></span> get_password:(unit <span class="rarr"><span>-&gt;</span></span> string) <span class="rarr"><span>-&gt;</span></span> get_account:(unit <span class="rarr"><span>-&gt;</span></span> string) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This FTP method logs the <code>user</code> in. <code>get_password</code> is called when
the FTP server asks for the password (may be skipped). <code>get_account</code>
is called when the server asks for the account ID (may be skipped).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:quit_method">
  <a href="index.html#/val:quit_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> quit_method : unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Quits and disconnects</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:walk_method">
  <a href="index.html#/val:walk_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> walk_method : [ <div class="cons">| `File <span class="keyword">of</span> string</div><div class="cons">| `Dir <span class="keyword">of</span> string</div><div class="cons">| `Stay</div> ] <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This FTP method walks to the target directory:</p>
      <ul><li><code>`File name</code>: The <code>name</code> is interpreted as slash-separated path.
It is always interpreted relative to the home directory of the
user (i.e. the directory after login), even if it begins with a
slash. The FTP command walks to the directory containing <code>name</code>.</li><li><code>`Dir name</code>: The FTP command walks to the directory <code>name</code> (same
syntax as for <code>`File</code>).</li><li><code>`Stay</code>: The FTP command does nothing (stays in the current directory).</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:filename">
  <a href="index.html#/type:filename" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> filename = [ <div class="cons">| `NVFS <span class="keyword">of</span> string</div><div class="cons">| `TVFS <span class="keyword">of</span> string</div><div class="cons">| `Verbatim <span class="keyword">of</span> string</div> ]
    
      <div class="doc">
        
      <p>There are several methods how to specify filenames:</p>
      <ul><li><code>`NVFS name</code>: The &quot;Network Virtual File System&quot; is the normal way
of accessing FTP files. The client walks into the directory containing
the file using <code>CWD</code> and <code>CDUP</code> commands, and calls the file operation
from this directory. For simplicity, this client interprets slashes
in <code>name</code> as path component separators. The FTP server will never
see these slashes.</li><li><code>`TVFS name</code>: The optional &quot;Trivial Network File System&quot; avoids the
<code>CWD</code> and <code>CDUP</code> commands. The tagged <code>name</code> is normalized (double
slashed removed etc.), and is passed to the server as-is. Before using
the faster TVFS one should check whether it is supported (feature
&quot;TVFS&quot;). Note that even for TVFS there are no special files &quot;.&quot;
and &quot;..&quot;!</li><li><code>`Verbatim name</code>: The string <code>name</code> is passed to the server without
transforming it in any way.</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_method">
  <a href="index.html#/val:get_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_method : file:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> representation:<a href="index.html#/type:representation">representation</a> <span class="rarr"><span>-&gt;</span></span> store:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This FTP method walks to the right directory and gets <code>file</code> from
the server. The file is stored in the <code>local_receiver</code> that can be
obtained by calling the <code>store</code> function. The selected <code>representation</code>
remains unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:put_method">
  <a href="index.html#/val:put_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> put_method : ?meth:[ <div class="cons">| `STOR</div><div class="cons">| `APPE</div> ] <span class="rarr"><span>-&gt;</span></span> file:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> representation:<a href="index.html#/type:representation">representation</a> <span class="rarr"><span>-&gt;</span></span> store:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_sender">local_sender</a>) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This FTP method walks to the right directory and puts <code>file</code> to
the server. The file is taken from the <code>local_sender</code> that can be
obtained by calling the <code>store</code> function. The selected <code>representation</code>
remains unchanged.</p>
      
      <p><code>meth</code> selects the method to use (default <code>`STOR</code>).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:invoke_method">
  <a href="index.html#/val:invoke_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> invoke_method : command:<a href="index.html#/type:cmd">cmd</a> <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>This FTP method simply invokes <code>command</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:set_structure_method">
  <a href="index.html#/val:set_structure_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_structure_method : <a href="index.html#/type:structure">structure</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Requests a certain structure for future file transfers</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:set_mode_method">
  <a href="index.html#/val:set_mode_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_mode_method : <a href="index.html#/type:transmission_mode">transmission_mode</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Requests a certain mode for future file transfers</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:rename_method">
  <a href="index.html#/val:rename_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> rename_method : file_from:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> file_to:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Renames the <code>file_from</code> into <code>file_to</code>.</p>
      
      <p>Both file names must be of the same type, either <code>`NVFS</code> or <code>`Verbatim</code>.
If <code>`NVFS</code>, both names must be in the same directory.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:mkdir_method">
  <a href="index.html#/val:mkdir_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mkdir_method : <a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Creates the named directory</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:rmdir_method">
  <a href="index.html#/val:rmdir_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> rmdir_method : <a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Deletes the named directory</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:delete_method">
  <a href="index.html#/val:delete_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> delete_method : <a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Deletes the named file</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:list_method">
  <a href="index.html#/val:list_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> list_method : dir:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> representation:<a href="index.html#/type:representation">representation</a> <span class="rarr"><span>-&gt;</span></span> store:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Lists the contents of the directory <code>dir</code> using the LIST command.
The <code>representation</code> must not be <code>`Image</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:nlst_method">
  <a href="index.html#/val:nlst_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> nlst_method : dir:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> representation:<a href="index.html#/type:representation">representation</a> <span class="rarr"><span>-&gt;</span></span> store:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Lists the contents of the directory <code>dir</code> using the NLST command
The <code>representation</code> must not be <code>`Image</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:parse_nlst_document">
  <a href="index.html#/val:parse_nlst_document" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> parse_nlst_document : string <span class="rarr"><span>-&gt;</span></span> string list
    
      <div class="doc">
        
      <p>Returns the filenames contained in the output of <code>`NLST</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:mdtm_method">
  <a href="index.html#/val:mdtm_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mdtm_method : file:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> process_result:(float <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Determines the date and time of the last modification of <code>file</code>.
On success, <code>process_result</code> is called.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:size_method">
  <a href="index.html#/val:size_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> size_method : file:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> representation:<a href="index.html#/type:representation">representation</a> <span class="rarr"><span>-&gt;</span></span> process_result:(int64 <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Determines the size of <code>file</code>. On success, <code>process_result</code> is called.
The size depends on <code>representation</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:feat_method">
  <a href="index.html#/val:feat_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> feat_method : ?process_result:((string * string option) list <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Get the list of feature tokens (see also
<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_client/">Ftp_client</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_client/#/type:ftp_state">ftp_state</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_client/#/type:ftp_state/field:ftp_features">ftp_features</a>)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:entry">
  <a href="index.html#/type:entry" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> entry = string * (string * string) list
    
      <div class="doc">
        
      <p>A file entry <code>(name, facts)</code>. The facts are given as pairs
<code>(factname,value)</code> where <code>factname</code> is always lowercase.
For parsers for common facts see below.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:mlst_method">
  <a href="index.html#/val:mlst_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mlst_method : file:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> process_result:(<a href="index.html#/type:entry">entry</a> list <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Get the file entry for <code>file</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:mlsd_method">
  <a href="index.html#/val:mlsd_method" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mlsd_method : dir:<a href="index.html#/type:filename">filename</a> <span class="rarr"><span>-&gt;</span></span> store:(<a href="index.html#/type:ftp_state">ftp_state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/">Ftp_data_endpoint</a>.<a href="../../../../ocamlnet.3.7.7/src/netclient/ftp_data_endpoint/#/type:local_receiver">local_receiver</a>) <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ftp_method">ftp_method</a>
    
      <div class="doc">
        
      <p>Gets the entries for this directory.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:parse_mlsd_document">
  <a href="index.html#/val:parse_mlsd_document" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> parse_mlsd_document : string <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:entry">entry</a> list
    
      <div class="doc">
        
      <p>Returns the entries contained in the output of <code>`MLSD</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:entry_type">
  <a href="index.html#/type:entry_type" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> entry_type = [ <div class="cons">| `File</div><div class="cons">| `Cdir</div><div class="cons">| `Pdir</div><div class="cons">| `Dir</div><div class="cons">| `Other</div> ]
    
      <div class="doc">
        
      <p>Types:</p>
      <ul><li><code>`File</code>: entry refers to file</li><li><code>`Cdir</code>: entry refers to the directory being listed</li><li><code>`Pdir</code>: entry is a parent of the directory being listed</li><li><code>`Dir</code>: entry refers to directory</li><li><code>`Other</code>: entry is neither file nor directory</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:entry_perm">
  <a href="index.html#/type:entry_perm" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> entry_perm = [ <div class="cons">| `Append</div><div class="cons">| `Create</div><div class="cons">| `Delete</div><div class="cons">| `Enter</div><div class="cons">| `Rename</div><div class="cons">| `List</div><div class="cons">| `Mkdir</div><div class="cons">| `Delete_member</div><div class="cons">| `Read</div><div class="cons">| `Write</div> ]
    
      <div class="doc">
        
      <p>Permissions:</p>
      <ul><li><code>`Append</code>: append to file possible</li><li><code>`Create</code>: file can be created in this dir</li><li><code>`Delete</code>: file or dir can be deleted</li><li><code>`Enter</code>: dir can be entered</li><li><code>`Rename</code>: file or dir can be renamed</li><li><code>`List</code>: dir can be listed</li><li><code>`Mkdir</code>: subdir can be created in this dir</li><li><code>`Delete_member</code>: a file or dir can be deleted in this directory</li><li><code>`Read</code>: a file can be retrieved</li><li><code>`Write</code>: a file can be stored</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        
      <p>The following functions extract commonly used facts from entries.
They may raise <code>Not_found</code>.</p>
      
        
      </div>
    
  <div class="region" id="/val:get_name">
  <a href="index.html#/val:get_name" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_name : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_size">
  <a href="index.html#/val:get_size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_size : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> int64
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_modify">
  <a href="index.html#/val:get_modify" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_modify : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> float
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_create">
  <a href="index.html#/val:get_create" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_create : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> float
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_type">
  <a href="index.html#/val:get_type" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_type : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:entry_type">entry_type</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_unique">
  <a href="index.html#/val:get_unique" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_unique : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_perm">
  <a href="index.html#/val:get_perm" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_perm : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:entry_perm">entry_perm</a> list
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_lang">
  <a href="index.html#/val:get_lang" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_lang : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_media_type">
  <a href="index.html#/val:get_media_type" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_media_type : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_charset">
  <a href="index.html#/val:get_charset" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_charset : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_unix_mode">
  <a href="index.html#/val:get_unix_mode" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_unix_mode : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> int
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_unix_uid">
  <a href="index.html#/val:get_unix_uid" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_unix_uid : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get_unix_gid">
  <a href="index.html#/val:get_unix_gid" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_unix_gid : <a href="index.html#/type:entry">entry</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client">
  <a href="index.html#/class:ftp_client" class="anchor">#</a>
  
  <div class="class">
    <span class="keyword">class</span> ftp_client : 
    ?event_system:<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a> option
    <span class="rarr"><span>-&gt;</span></span>
    
    unit
    <span class="rarr"><span>-&gt;</span></span>
    
  <div class="region" id="/class:ftp_client/method:exec_e">
  <a href="index.html#/class:ftp_client/method:exec_e" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> exec_e : <a href="index.html#/type:ftp_method">ftp_method</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/">Uq_engines</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/uq_engines/#/classtype:engine">engine</a>
  
      <div class="doc">
        
      <p>Runs the method asynchronously as engine.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:exec">
  <a href="index.html#/class:ftp_client/method:exec" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> exec : <a href="index.html#/type:ftp_method">ftp_method</a> <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Runs the method synchronously. Note that this implies a call of
<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/val:run">run</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:pi">
  <a href="index.html#/class:ftp_client/method:pi" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> pi : <a href="index.html#/classtype:ftp_client_pi">ftp_client_pi</a>
  
      <div class="doc">
        
      <p>The curerent protocol interpreter. It is allowed that a different <code>pi</code>
is created when a new connection is opened.</p>
      
      <p>The <code>pi</code> is first available after running the first method. The
method fails if <code>pi</code> is unavailable.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:run">
  <a href="index.html#/class:ftp_client/method:run" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> run : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Starts the event system; same as <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/val:run">run</a></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:configure_timeout">
  <a href="index.html#/class:ftp_client/method:configure_timeout" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> configure_timeout : float <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Configures a timeout for both the control and the data connection.
This must be done before connecting to a server.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:set_socks5_proxy">
  <a href="index.html#/class:ftp_client/method:set_socks5_proxy" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> set_socks5_proxy : string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Sets that a SOCKS version 5 proxy is used at this host and port.
There is no support for authentication at the proxy. Only
passive mode is supported.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:event_system">
  <a href="index.html#/class:ftp_client/method:event_system" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> event_system : <a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/">Unixqueue</a>.<a href="../../../../ocamlnet.3.7.7/src/equeue/unixqueue/#/classtype:event_system">event_system</a>
  
  </div>
  
  </div>
  
  <div class="region" id="/class:ftp_client/method:reset">
  <a href="index.html#/class:ftp_client/method:reset" class="anchor">#</a>
  
  <div class="method">
  <span class="keyword">method</span> reset : unit <span class="rarr"><span>-&gt;</span></span> unit
  
      <div class="doc">
        
      <p>Aborts all current activities if any, and re-initializes the client</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    
    
    
      <div class="doc">
        
      <p>The ftp client is a user session that may even span several connections.
However, only one server is connected at once.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Examples and Discussion</h2>
    </div>
      <p>To download a single flat file from a server:</p>
      <pre><code>      let buffer = Buffer.create 1000 in
      let ch = new Netchannels.output_buffer buffer in
      let client = new ftp_client() in
      client # exec (connect_method ~host:&quot;127.0.0.1&quot; ());
      client # exec (login_method ~user:&quot;foo&quot;
                                   ~get_password:(fun () -&gt; &quot;password&quot;)
                                   ~get_account:(fun () -&gt; &quot;foo&quot;) ());
      client # exec (get_method ~file:(`NVFS &quot;path/to/file&quot;)
                                ~representation:`Image
                                ~store:(fun _ -&gt; `File_structure ch) ());</code></pre>
      <p>The file is stored in <code>buffer</code>. By using a different netchannel, it
can be stored whereever wanted.</p>
      
      <p>To download a record-structured text file, use a <code>store</code> like:</p>
      <pre><code>       let ch = (as above) in
       let rec_ch = new Ftp_data_endpoint.write_out_record_channel
                          ~repr:(`ASCII_unix `Enc_iso88591)
                          ch
       ...
       ... ~store:(fun _ -&gt; `Record_structure rec_ch)</code></pre>
      <p>Here, the end-of-record is transcoded to newline. Note that the ASCII
variant (<code>`Enc_iso88591</code>) is ignored by <code>write_out_record_channel</code>.
<b>Open: How to select record structure using an FTP method.</b></p>
      
      <p>Character conversions: To convert an EBCDIC file to ASCII, use
something like</p>
      <pre><code>       let ch = (as above) in
       let converter = new Ftp_data_endpoint.data_converter
                            ~fromrepr:(`EBCDIC `Enc_cp1047)
                            ~torepr:(`ASCII_unix `Enc_iso88591) in
       let ch_ebcdic = new Netchannels.output_filter converter ch in
       ...
       ... ~representation:(`EBCDIC None)
       ... ~store:(fun _ -&gt; `File_structure ch_ebcdic)</code></pre>
      <p>The class <code>data_converter</code> also performs the transformation of the
end-of-line convention, unlike the similar class
<code>Netconversion.conversion_pipe</code>.</p>
      
        
      </div>
    
      <div class="doc">
        <div class="region">
    <h1 class="section level_1">Debugging</h1>
    </div>
        
      </div>
    
  <div class="region" id="/module:Debug">
  <a href="index.html#/module:Debug" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Debug : <span class="keyword">sig</span></div>
      
      
    <div class="sig">
  <div class="region" id="/module:Debug/val:enable">
  <a href="index.html#/module:Debug/val:enable" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> enable : bool <a href="../../../../ocaml.4.02.1+doc/stdlib/pervasives/">Pervasives</a>.<a href="../../../../ocaml.4.02.1+doc/stdlib/pervasives/#/type:ref">ref</a>
    
      <div class="doc">
        
      <p>Enables [root:Netlog]-style debugging of this module</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>