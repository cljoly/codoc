<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Netbuffer</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Netbuffer</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>A Netbuffer.t is a buffer that can grow and shrink dynamically.</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/type:t">
  <a href="index.html#/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t
    
  </div>
  
  </div>
  
  <div class="region" id="/val:create">
  <a href="index.html#/val:create" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> create : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p>Creates a netbuffer which allocates initially this number of bytes.
The logical length is zero.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:contents">
  <a href="index.html#/val:contents" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> contents : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string
    
      <div class="doc">
        
      <p>Returns the contents of the buffer as fresh string.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:length">
  <a href="index.html#/val:length" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> length : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p>Returns the logical length of the buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Extracting strings</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:get">
  <a href="index.html#/val:get" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> char
    
      <div class="doc">
        
      <p><code>get nb pos</code>: Get the character at <code>pos</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:nth">
  <a href="index.html#/val:nth" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> nth : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> char
    
      <div class="doc">
        
      <p>Alias for <code>get</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:sub">
  <a href="index.html#/val:sub" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> sub : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string
    
      <div class="doc">
        
      <p><code>sub nb k n</code>: returns the n characters starting at position <code>n</code> from
netbuffer <code>nb</code> as fresh string</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:blit_to_string">
  <a href="index.html#/val:blit_to_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> blit_to_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>blit_to_string nb srcpos dest destpos len</code>: Copies the <code>len</code> bytes at
position <code>srcpos</code> from <code>nb</code> to the string <code>dest</code> at position <code>destpos</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:blit">
  <a href="index.html#/val:blit" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> blit : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Compatibility name for <code>blit_to_string</code>, now deprecated</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Appending strings</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:add_string">
  <a href="index.html#/val:add_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_string nb s</code>: Adds a copy of the string <code>s</code> to the logical end of
the netbuffer <code>nb</code>. If necessary, <code>nb</code> grows.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_sub_string">
  <a href="index.html#/val:add_sub_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_sub_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_sub_string nb s k n</code>: Adds the substring of <code>s</code> starting at position
<code>k</code> with length <code>n</code> to the logical end of the netbuffer <code>nb</code>. If necessary,
<code>nb</code> grows.</p>
      
      <p>This is semantically the same as
<code>add_string nb (String.sub s k n)</code>, but the extra copy is avoided.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_substring">
  <a href="index.html#/val:add_substring" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_substring : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Alias for add_sub_string</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_char">
  <a href="index.html#/val:add_char" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_char : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_char nb c</code>: Adds a single char at the end of the buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_char_2">
  <a href="index.html#/val:add_char_2" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_char_2 : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_char_2 nb c1 c2</code>: Adds two chars at the end of the buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_char_4">
  <a href="index.html#/val:add_char_4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_char_4 : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_char_4 nb c1 c2 c3 c4</code>: Adds four chars at the end of the buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_inplace">
  <a href="index.html#/val:add_inplace" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_inplace : ?len:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int) <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>add_inplace nb f</code>: Calls the function <code>f</code> to add bytes to the
netbuffer <code>nb</code>. The arguments of <code>f</code> are the buffer, the position
in the buffer, and the maximum length. The function <code>f</code> must return
the actual number of added bytes; this number is also returned by
<code>add_inplace</code>.</p>
      
      <p>Example: let n = add_inplace nb (Pervasives.input ch)</p>
      
      <p>The argument <code>len</code> is the number of bytes to add (second argument of
<code>f</code>). It defaults to the number of free bytes in the buffer after space
for at least one byte has been allocated.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_buffer">
  <a href="index.html#/val:add_buffer" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_buffer : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>add_buffer nb1 nb2</code>: Adds the contents of <code>nb2</code> to the end of <code>nb1</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:area_for_additions">
  <a href="index.html#/val:area_for_additions" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> area_for_additions : ?len:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string * int * int
    
  </div>
  
  </div>
  
  <div class="region" id="/val:advance">
  <a href="index.html#/val:advance" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> advance : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>These two functions work together, so that the effect of <code>add_inplace</code>
can be obtained in two steps. First, the user calls
</p>
      <pre><code>        let (s,pos,len) = area_for_additions nb</code></pre>
      <p>
to get the area where to put new data of length <code>n</code>, with <code>n &lt;= len</code>.
After this the data is made valid by
</p>
      <pre><code>        advance n</code></pre>
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Inserting strings</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:insert_string">
  <a href="index.html#/val:insert_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> insert_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>insert_string nb p s</code>: Inserts the value of string <code>s</code> at position
<code>p</code> into the netbuffer <code>nb</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:insert_sub_string">
  <a href="index.html#/val:insert_sub_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> insert_sub_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>insert_string nb p s k n</code>: Inserts a substring of string <code>s</code> at position
<code>p</code> into the netbuffer <code>nb</code>. The substring is denoted by position <code>k</code>
and has length <code>n</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:insert_char">
  <a href="index.html#/val:insert_char" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> insert_char : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>insert_char nb p c</code>: Inserts character <code>c</code> at position <code>p</code> into
the netbuffer <code>nb</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Overwriting strings</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:set">
  <a href="index.html#/val:set" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>set nb pos c</code>: Sets the character at <code>pos</code> to <code>c</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:put_string">
  <a href="index.html#/val:put_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> put_string : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>put_string nb pos s</code>: Copies the string <code>s</code> to the position <code>pos</code>
of netbuffer <code>nb</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:blit_from_string">
  <a href="index.html#/val:blit_from_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> blit_from_string : string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>blit_from_string src srcpos dest destpos len</code>: Copies the <code>len</code> bytes
at position <code>srcpos</code> from the string <code>src</code> to the netbuffer <code>dest</code> at
position <code>destpos</code>.</p>
      
      <p>It is possible to copy the string beyond the end of the buffer. The
buffer is automatically enlarged in this case.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Deleting</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:delete">
  <a href="index.html#/val:delete" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> delete : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>delete nb k n</code>: Deletes the <code>n</code> bytes at position <code>k</code> of netbuffer
<code>nb</code> in-place.</p>
      
      <p>The netbuffer does not shrink, however, i.e. the free space is not
given back to the memory manager.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:clear">
  <a href="index.html#/val:clear" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> clear : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Deletes all contents from the buffer. As <code>delete</code>, the netbuffer does
not shrink.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:reset">
  <a href="index.html#/val:reset" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> reset : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Empty the buffer, deallocate the internal string, and replace it
with a new string of length <code>n</code> that was allocated by
<a href="../../../../ocamlnet.3.7.7/src/netstring/netbuffer/">Netbuffer</a>.<a href="../../../../ocamlnet.3.7.7/src/netstring/netbuffer/#/val:create">create</a> <code>n</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:try_shrinking">
  <a href="index.html#/val:try_shrinking" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> try_shrinking : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>try_shrinking nb</code>: If the length of the buffer is less than half of
the allocated space, the netbuffer is reallocated in order to save
memory.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Searching</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:index_from">
  <a href="index.html#/val:index_from" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> index_from : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>index_from nb k c</code>: Searches the character <code>c</code> in the netbuffer beginning
at position <code>k</code>. If found, the position of the left-most occurence is
returned. Otherwise, <code>Not_found</code> is raised.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Memory</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:blit_to_memory">
  <a href="index.html#/val:blit_to_memory" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> blit_to_memory : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netsys/netsys_mem/">Netsys_mem</a>.<a href="../../../../ocamlnet.3.7.7/src/netsys/netsys_mem/#/type:memory">memory</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>blit_to_memory nb srcpos dest destpos len</code>: Copies the <code>len</code> bytes at
position <code>srcpos</code> from <code>nb</code> to the membuffer <code>dest</code> at position
<code>destpos</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_sub_memory">
  <a href="index.html#/val:add_sub_memory" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_sub_memory : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../ocamlnet.3.7.7/src/netsys/netsys_mem/">Netsys_mem</a>.<a href="../../../../ocamlnet.3.7.7/src/netsys/netsys_mem/#/type:memory">memory</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Same as <code>add_sub_string</code>, but gets data from a memory buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Miscelleneous</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:unsafe_buffer">
  <a href="index.html#/val:unsafe_buffer" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> unsafe_buffer : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string
    
      <div class="doc">
        
      <p><b>Warning! This is a low-level function!</b>
Returns the current string that internally holds the buffer.
The byte positions 0 to length - 1 actually store the contents of
the buffer. You can directly read and modify the buffer. Note that
there is no protection if you read or write positions beyond the
length of the buffer.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:print_buffer">
  <a href="index.html#/val:print_buffer" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> print_buffer : <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>For the toploop</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>