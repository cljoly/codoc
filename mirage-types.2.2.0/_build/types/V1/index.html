<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>V1</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">V1</a></h1> : <span class="keyword">sig</span></div>
      
      
    <div class="sig">
  <div class="region" id="/modtype:DEVICE">
  <a href="index.html#/modtype:DEVICE" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> DEVICE = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Device operations.
Defines the functions to connect and disconnect any device</p>
      
        
      </div>
    
  <div class="region" id="/modtype:DEVICE/type:io">
  <a href="index.html#/modtype:DEVICE/type:io" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a io
    
      <div class="doc">
        
      <p>A potentially blocking I/O operation</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/type:t">
  <a href="index.html#/modtype:DEVICE/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t
    
      <div class="doc">
        
      <p>The type representing the internal state of the device</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/type:error">
  <a href="index.html#/modtype:DEVICE/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error
    
      <div class="doc">
        
      <p>An error signalled by the device, normally returned after a
connection attempt</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/type:id">
  <a href="index.html#/modtype:DEVICE/type:id" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> id
    
      <div class="doc">
        
      <p>Type defining an identifier for this device that uniquely
identifies it among a device tree.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/val:id">
  <a href="index.html#/modtype:DEVICE/val:id" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> id : <a href="index.html#/modtype:DEVICE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:DEVICE/type:id">id</a>
    
      <div class="doc">
        
      <p>Return the identifier that was used to construct this device</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/val:connect">
  <a href="index.html#/modtype:DEVICE/val:connect" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> connect : <a href="index.html#/modtype:DEVICE/type:id">id</a> <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:DEVICE/type:error">error</a></div><div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:DEVICE/type:t">t</a></div> ] <a href="index.html#/modtype:DEVICE/type:io">io</a>
    
      <div class="doc">
        
      <p>Connect to the device identified by <code>id</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:DEVICE/val:disconnect">
  <a href="index.html#/modtype:DEVICE/val:disconnect" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> disconnect : <a href="index.html#/modtype:DEVICE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:DEVICE/type:io">io</a>
    
      <div class="doc">
        
      <p>Disconnect from the device. While this might take some
time to complete, it can never result in an error.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TIME">
  <a href="index.html#/modtype:TIME" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> TIME = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Time operations for cooperative threads.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:TIME/type:io">
  <a href="index.html#/modtype:TIME/type:io" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a io
    
      <div class="doc">
        
      <p>A potentially blocking I/O operation</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TIME/val:sleep">
  <a href="index.html#/modtype:TIME/val:sleep" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> sleep : float <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:TIME/type:io">io</a>
    
      <div class="doc">
        
      <p><code>sleep nsec</code> Block the current thread for <code>TODO remove float</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:RANDOM">
  <a href="index.html#/modtype:RANDOM" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> RANDOM = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Operations to generate entropy. This is currently a passthrough to
the OCaml Random generator, and will be deprecated in V2 and turned
into a proper DEVICE with blocking modes.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:RANDOM/val:self_init">
  <a href="index.html#/modtype:RANDOM/val:self_init" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> self_init : unit <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Initialize the generator with a random seed chosen in a system-dependent way.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:RANDOM/val:int">
  <a href="index.html#/modtype:RANDOM/val:int" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> int : int <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>int bound</code> returns a random integer between 0 (inclusive) and <code>bound</code> (exclusive).
<code>bound</code> must be greater than 0 and less than 2<sup>30</sup>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:RANDOM/val:int32">
  <a href="index.html#/modtype:RANDOM/val:int32" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> int32 : int32 <span class="rarr"><span>-&gt;</span></span> int32
    
      <div class="doc">
        
      <p><code>int32 bound</code> returns a random integer between 0 (inclusive) and <code>bound</code> (exclusive).
<code>bound</code> must be greater than 0.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ENTROPY">
  <a href="index.html#/modtype:ENTROPY" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> ENTROPY = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A native entropy provider. *</p>
      
        
      </div>
    
  <div class="region" id="/modtype:ENTROPY/type:error">
  <a href="index.html#/modtype:ENTROPY/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `No_entropy_device <span class="keyword">of</span> string</div> ]
    
      <div class="doc">
        
      <p>Represents errors when attaching the entropy provider.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:ENTROPY/type:error">error</a> 
    </div>
  
  <div class="region" id="/modtype:ENTROPY/type:buffer">
  <a href="index.html#/modtype:ENTROPY/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>usually a cstruct</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ENTROPY/type:handler">
  <a href="index.html#/modtype:ENTROPY/type:handler" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> handler = source:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ENTROPY/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>A <code>handler</code> is called whenever the system has extra entropy to announce.
No guarantees are made about the entropy itself, other than it being
environmentally derived. In particular, the amount of entropy in the buffer
can be far lower than the size of the <code>buffer</code>.</p>
      
      <p><code>source</code> is a small integer, describing the provider but with no other
meaning.</p>
      
      <p><code>handler</code> is expected to return quickly.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ENTROPY/val:handler">
  <a href="index.html#/modtype:ENTROPY/val:handler" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> handler : <a href="index.html#/modtype:ENTROPY/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ENTROPY/type:handler">handler</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ENTROPY/type:io">io</a>
    
      <div class="doc">
        
      <p><code>handler h</code> registers the single global <code>handler</code> that will receive
entropy. There might be additional, provider-specific blocking semantics.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CLOCK">
  <a href="index.html#/modtype:CLOCK" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> CLOCK = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Clock operations.
Currently read-only to retrieve the time in various formats.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:CLOCK/type:tm">
  <a href="index.html#/modtype:CLOCK/type:tm" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> tm = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_sec">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_sec" class="anchor">#</a>
  tm_sec
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Seconds 0..60</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_min">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_min" class="anchor">#</a>
  tm_min
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Minutes 0..59</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_hour">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_hour" class="anchor">#</a>
  tm_hour
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Hours 0..23</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_mday">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_mday" class="anchor">#</a>
  tm_mday
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Day of month 1..31</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_mon">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_mon" class="anchor">#</a>
  tm_mon
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Month of year 0..11</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_year">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_year" class="anchor">#</a>
  tm_year
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Year - 1900</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_wday">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_wday" class="anchor">#</a>
  tm_wday
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Day of week (Sunday is 0)</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_yday">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_yday" class="anchor">#</a>
  tm_yday
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Day of year 0..365</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:CLOCK/type:tm/field:tm_isdst">
  <a href="index.html#/modtype:CLOCK/type:tm/field:tm_isdst" class="anchor">#</a>
  tm_isdst
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">Daylight time savings in effect</td><td>*)</td>
  </tr>
    </table>}
    
      <div class="doc">
        
      <p>The type representing wallclock time and calendar date.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CLOCK/val:time">
  <a href="index.html#/modtype:CLOCK/val:time" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> time : unit <span class="rarr"><span>-&gt;</span></span> float
    
      <div class="doc">
        
      <p>Return the current time since 00:00:00 GMT, Jan. 1, 1970, in
seconds.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CLOCK/val:gmtime">
  <a href="index.html#/modtype:CLOCK/val:gmtime" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> gmtime : float <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CLOCK/type:tm">tm</a>
    
      <div class="doc">
        
      <p>Convert a time in seconds, as returned by <a href="index.html#/modtype:CLOCK/val:time">time</a>, into a
date and a time. Assumes UTC (Coordinated Universal Time), also
known as GMT.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW">
  <a href="index.html#/modtype:FLOW" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> FLOW = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A connection between endpoints.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:FLOW/type:io">
  <a href="index.html#/modtype:FLOW/type:io" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a io
    
      <div class="doc">
        
      <p>A potentially blocking I/O operation</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/type:buffer">
  <a href="index.html#/modtype:FLOW/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/type:flow">
  <a href="index.html#/modtype:FLOW/type:flow" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> flow
    
      <div class="doc">
        
      <p>A flow represents the state of a single stream that is connected
to an endpoint.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/type:error">
  <a href="index.html#/modtype:FLOW/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/val:read">
  <a href="index.html#/modtype:FLOW/val:read" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read : <a href="index.html#/modtype:FLOW/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:FLOW/type:buffer">buffer</a></div><div class="cons">| `Eof</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FLOW/type:error">error</a></div> ] <a href="index.html#/modtype:FLOW/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read flow</code> will block until it either successfully reads a segment
of data from the current flow, receives an <code>Eof</code> signifying that
the connection is now closed, or an <code>Error</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/val:write">
  <a href="index.html#/modtype:FLOW/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:FLOW/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:FLOW/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Eof</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FLOW/type:error">error</a></div> ] <a href="index.html#/modtype:FLOW/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write flow buffer</code> will block until <code>buffer</code> has been added to the
send queue. There is no indication when the buffer has actually been
read and, therefore, it must not be reused.
The contents may be transmitted in separate packets, depending on the
underlying transport. The result <code>`Ok ()</code> indicates success, <code>`Eof</code>
indicates that the connection is now closed and <code>`Error</code> indicates some
other error.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/val:writev">
  <a href="index.html#/modtype:FLOW/val:writev" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> writev : <a href="index.html#/modtype:FLOW/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:FLOW/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Eof</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FLOW/type:error">error</a></div> ] <a href="index.html#/modtype:FLOW/type:io">io</a>
    
      <div class="doc">
        
      <p><code>writev flow buffers</code> will block until the buffers have all been added
to the send queue. There is no indication when the buffers have actually
been read and, therefore, they must not be reused.
The result <code>`Ok ()</code> indicates success, <code>`Eof</code> indicates that the
connection is now closed and <code>`Error</code> indicates some other error.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FLOW/val:close">
  <a href="index.html#/modtype:FLOW/val:close" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> close : <a href="index.html#/modtype:FLOW/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:FLOW/type:io">io</a>
    
      <div class="doc">
        
      <p><code>close flow</code> will flush all pending writes and signal the end of the
flow to the remote endpoint. When the result <code>unit io</code> becomes
determined, all further calls to <code>read flow</code> will result in a <code>`Eof</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CONSOLE">
  <a href="index.html#/modtype:CONSOLE" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> CONSOLE = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Text console input/output operations.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:CONSOLE/type:error">
  <a href="index.html#/modtype:CONSOLE/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Invalid_console <span class="keyword">of</span> string</div> ]
    
      <div class="doc">
        
      <p>The type representing possible errors when attaching a console.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:CONSOLE/type:error">error</a> 
    </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:FLOW">FLOW</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:FLOW/type:error">error</a> := <a href="index.html#/modtype:CONSOLE/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> 'a <a href="index.html#/modtype:FLOW/type:io">io</a> := 'a <a href="index.html#/modtype:CONSOLE/type:io">io</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:FLOW/type:flow">flow</a> := <a href="index.html#/modtype:CONSOLE/type:t">t</a> 
    </div>
  
  <div class="region" id="/modtype:CONSOLE/val:log">
  <a href="index.html#/modtype:CONSOLE/val:log" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> log : <a href="index.html#/modtype:CONSOLE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>log str</code> writes as much characters of <code>str</code> that can be written
in one write operation to the console <code>t</code>, then writes
&quot;\r\n&quot; to it.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CONSOLE/val:log_s">
  <a href="index.html#/modtype:CONSOLE/val:log_s" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> log_s : <a href="index.html#/modtype:CONSOLE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:CONSOLE/type:io">io</a>
    
      <div class="doc">
        
      <p><code>log_s str</code> is a thread that writes <code>str ^ &quot;\r\n&quot;</code> in the
console <code>t</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:BLOCK">
  <a href="index.html#/modtype:BLOCK" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> BLOCK = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Operations on sector-addressible block devices, usually used
for persistent storage</p>
      
        
      </div>
    
  <div class="region" id="/modtype:BLOCK/type:page_aligned_buffer">
  <a href="index.html#/modtype:BLOCK/type:page_aligned_buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> page_aligned_buffer
    
      <div class="doc">
        
      <p>Abstract type for a page-aligned memory buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:BLOCK/type:error">
  <a href="index.html#/modtype:BLOCK/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div><div class="cons">| `Unimplemented</div><div class="cons">| `Is_read_only</div><div class="cons">| `Disconnected</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:BLOCK/type:error">error</a> 
    </div>
  
  <div class="region" id="/modtype:BLOCK/type:info">
  <a href="index.html#/modtype:BLOCK/type:info" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> info = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/modtype:BLOCK/type:info/field:read_write">
  <a href="index.html#/modtype:BLOCK/type:info/field:read_write" class="anchor">#</a>
  read_write
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">True if we can write, false if read/only</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:BLOCK/type:info/field:sector_size">
  <a href="index.html#/modtype:BLOCK/type:info/field:sector_size" class="anchor">#</a>
  sector_size
  </div>
  </td><td>: int</td><td>;</td><td>(*</td><td class="doc">Octets per sector</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:BLOCK/type:info/field:size_sectors">
  <a href="index.html#/modtype:BLOCK/type:info/field:size_sectors" class="anchor">#</a>
  size_sectors
  </div>
  </td><td>: int64</td><td>;</td><td>(*</td><td class="doc">Total sectors per device</td><td>*)</td>
  </tr>
    </table>}
    
      <div class="doc">
        
      <p>Characteristics of the block device. Note some devices may be able
to make themselves bigger over time.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:BLOCK/val:get_info">
  <a href="index.html#/modtype:BLOCK/val:get_info" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_info : <a href="index.html#/modtype:BLOCK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:BLOCK/type:info">info</a> <a href="index.html#/modtype:BLOCK/type:io">io</a>
    
      <div class="doc">
        
      <p>Query the characteristics of a specific block device</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:BLOCK/val:read">
  <a href="index.html#/modtype:BLOCK/val:read" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read : <a href="index.html#/modtype:BLOCK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int64 <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:BLOCK/type:page_aligned_buffer">page_aligned_buffer</a> list <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:BLOCK/type:error">error</a></div><div class="cons">| `Ok <span class="keyword">of</span> unit</div> ] <a href="index.html#/modtype:BLOCK/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read device sector_start buffers</code> returns a blocking IO operation which
attempts to fill <code>buffers</code> with data starting at <code>sector_start</code>.
Each of <code>buffers</code> must be a whole number of sectors in length. The list
of buffers can be of any length.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:BLOCK/val:write">
  <a href="index.html#/modtype:BLOCK/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:BLOCK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int64 <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:BLOCK/type:page_aligned_buffer">page_aligned_buffer</a> list <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:BLOCK/type:error">error</a></div><div class="cons">| `Ok <span class="keyword">of</span> unit</div> ] <a href="index.html#/modtype:BLOCK/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write device sector_start buffers</code> returns a blocking IO operation which
attempts to write the data contained within <code>buffers</code> to <code>t</code> starting
at <code>sector_start</code>. When the IO operation completes then all writes have been
persisted.</p>
      
      <p>Once submitted, it is not possible to cancel a request and there is no timeout.</p>
      
      <p>The operation may fail with
<code>`Unimplemented</code>: the operation has not been implemented, no data has been written
<code>`Is_read_only</code>: the device is read-only, no data has been written
<code>`Disconnected</code>: the device has been disconnected at application request,
an unknown amount of data has been written
<code>`Unknown</code>: some other permanent, fatal error (e.g. disk is on fire), where
an unknown amount of data has been written</p>
      
      <p>Each of <code>buffers</code> must be a whole number of sectors in length. The list
of buffers can be of any length.</p>
      
      <p>The data will not be copied, so the supplied buffers must not be re-used
until the IO operation completes.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK">
  <a href="index.html#/modtype:NETWORK" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> NETWORK = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A network interface that serves Ethernet frames.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:NETWORK/type:page_aligned_buffer">
  <a href="index.html#/modtype:NETWORK/type:page_aligned_buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> page_aligned_buffer
    
      <div class="doc">
        
      <p>Abstract type for a page-aligned memory buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/type:buffer">
  <a href="index.html#/modtype:NETWORK/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/type:error">
  <a href="index.html#/modtype:NETWORK/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div><div class="cons">| `Unimplemented</div><div class="cons">| `Disconnected</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/type:macaddr">
  <a href="index.html#/modtype:NETWORK/type:macaddr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> macaddr
    
      <div class="doc">
        
      <p>Unique MAC identifier for the device</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:NETWORK/type:error">error</a> 
    </div>
  
  <div class="region" id="/modtype:NETWORK/val:write">
  <a href="index.html#/modtype:NETWORK/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:NETWORK/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:NETWORK/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write nf buf</code> outputs <code>buf</code> to netfront <code>nf</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/val:writev">
  <a href="index.html#/modtype:NETWORK/val:writev" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> writev : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:NETWORK/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:NETWORK/type:io">io</a>
    
      <div class="doc">
        
      <p><code>writev nf bufs</code> output a list of buffers to netfront <code>nf</code> as a
single packet.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/val:listen">
  <a href="index.html#/modtype:NETWORK/val:listen" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> listen : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (<a href="index.html#/modtype:NETWORK/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:NETWORK/type:io">io</a>) <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:NETWORK/type:io">io</a>
    
      <div class="doc">
        
      <p><code>listen nf fn</code> is a blocking operation that calls <code>fn buf</code> with
every packet that is read from the interface. It returns as soon
as it has initialised, and the function can be stopped by calling
<code>disconnect</code> in the device layer.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/val:mac">
  <a href="index.html#/modtype:NETWORK/val:mac" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mac : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:NETWORK/type:macaddr">macaddr</a>
    
      <div class="doc">
        
      <p><code>mac nf</code> is the MAC address of <code>nf</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/type:stats">
  <a href="index.html#/modtype:NETWORK/type:stats" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> stats = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/modtype:NETWORK/type:stats/field:rx_bytes">
  <a href="index.html#/modtype:NETWORK/type:stats/field:rx_bytes" class="anchor">#</a>
  <span class="keyword">mutable</span> rx_bytes
  </div>
  </td><td>: int64</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:NETWORK/type:stats/field:rx_pkts">
  <a href="index.html#/modtype:NETWORK/type:stats/field:rx_pkts" class="anchor">#</a>
  <span class="keyword">mutable</span> rx_pkts
  </div>
  </td><td>: int32</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:NETWORK/type:stats/field:tx_bytes">
  <a href="index.html#/modtype:NETWORK/type:stats/field:tx_bytes" class="anchor">#</a>
  <span class="keyword">mutable</span> tx_bytes
  </div>
  </td><td>: int64</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:NETWORK/type:stats/field:tx_pkts">
  <a href="index.html#/modtype:NETWORK/type:stats/field:tx_pkts" class="anchor">#</a>
  <span class="keyword">mutable</span> tx_pkts
  </div>
  </td><td>: int32</td><td>;</td><td></td><td></td><td></td>
  </tr>
    </table>}
    
      <div class="doc">
        
      <p>Frame statistics to track the usage of the device.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/val:get_stats_counters">
  <a href="index.html#/modtype:NETWORK/val:get_stats_counters" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_stats_counters : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:NETWORK/type:stats">stats</a>
    
      <div class="doc">
        
      <p>Obtain the most recent snapshot of the device statistics.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:NETWORK/val:reset_stats_counters">
  <a href="index.html#/modtype:NETWORK/val:reset_stats_counters" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> reset_stats_counters : <a href="index.html#/modtype:NETWORK/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Reset the statistics associated with this device to their defaults.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF">
  <a href="index.html#/modtype:ETHIF" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> ETHIF = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>An Ethernet stack that parses frames from a network device and
can associate them with IP address via ARP.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:ETHIF/type:buffer">
  <a href="index.html#/modtype:ETHIF/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/type:netif">
  <a href="index.html#/modtype:ETHIF/type:netif" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> netif
    
      <div class="doc">
        
      <p>Abstract type for an Ethernet network interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/type:error">
  <a href="index.html#/modtype:ETHIF/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div><div class="cons">| `Unimplemented</div><div class="cons">| `Disconnected</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/type:macaddr">
  <a href="index.html#/modtype:ETHIF/type:macaddr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> macaddr
    
      <div class="doc">
        
      <p>Unique MAC identifier for the device</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:ETHIF/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:id">id</a> := <a href="index.html#/modtype:ETHIF/type:netif">netif</a> 
    </div>
  
  <div class="region" id="/modtype:ETHIF/val:write">
  <a href="index.html#/modtype:ETHIF/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:ETHIF/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write nf buf</code> outputs <code>buf</code> to netfront <code>nf</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/val:writev">
  <a href="index.html#/modtype:ETHIF/val:writev" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> writev : <a href="index.html#/modtype:ETHIF/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>
    
      <div class="doc">
        
      <p><code>writev nf bufs</code> output a list of buffers to netfront <code>nf</code> as a
single packet.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/val:mac">
  <a href="index.html#/modtype:ETHIF/val:mac" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mac : <a href="index.html#/modtype:ETHIF/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ETHIF/type:macaddr">macaddr</a>
    
      <div class="doc">
        
      <p><code>mac nf</code> is the MAC address of <code>nf</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:ETHIF/val:input">
  <a href="index.html#/modtype:ETHIF/val:input" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> input : arpv4:(<a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>) <span class="rarr"><span>-&gt;</span></span> ipv4:(<a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>) <span class="rarr"><span>-&gt;</span></span> ipv6:(<a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ETHIF/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:ETHIF/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:ETHIF/type:io">io</a>
    
      <div class="doc">
        
      <p>FIXME <code>listen nf fn</code> is a blocking operation that calls <code>fn buf</code> with
every packet that is read from the interface. It returns as soon
as it has initialised, and the function can be stopped by calling
<code>disconnect</code> in the device layer.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP">
  <a href="index.html#/modtype:IP" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> IP = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>An IP stack that parses Ethernet frames into IP packets</p>
      
        
      </div>
    
  <div class="region" id="/modtype:IP/type:buffer">
  <a href="index.html#/modtype:IP/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/type:ethif">
  <a href="index.html#/modtype:IP/type:ethif" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ethif
    
      <div class="doc">
        
      <p>Abstract type for an Ethernet device.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/type:ipaddr">
  <a href="index.html#/modtype:IP/type:ipaddr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipaddr
    
      <div class="doc">
        
      <p>Abstract type for an IP address.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/type:prefix">
  <a href="index.html#/modtype:IP/type:prefix" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> prefix
    
      <div class="doc">
        
      <p>Abstract type for an IP prefix.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/type:error">
  <a href="index.html#/modtype:IP/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div><div class="cons">| `Unimplemented</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:IP/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:id">id</a> := <a href="index.html#/modtype:IP/type:ethif">ethif</a> 
    </div>
  
  <div class="region" id="/modtype:IP/type:callback">
  <a href="index.html#/modtype:IP/type:callback" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> callback = src:<a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> dst:<a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p>An input continuation used by the parsing functions to pass on
an input packet down the stack.
<code>callback ~src ~dst buf</code> will be called with <code>src</code> and <code>dst</code>
containing the source and destination IP address respectively,
and <code>buf</code> will be a buffer pointing at the start of the IP
payload.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:input">
  <a href="index.html#/modtype:IP/val:input" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> input : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> tcp:<a href="index.html#/modtype:IP/type:callback">callback</a> <span class="rarr"><span>-&gt;</span></span> udp:<a href="index.html#/modtype:IP/type:callback">callback</a> <span class="rarr"><span>-&gt;</span></span> default:(proto:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:callback">callback</a>) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>input ~tcp ~udp ~default ip buf</code> demultiplexes an incoming <code>buffer</code> that
contains an IP frame. It examines the protocol header and passes the result
onto either the <code>tcp</code> or <code>udp</code> function, or the <code>default</code> function for
unknown IP protocols.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:allocate_frame">
  <a href="index.html#/modtype:IP/val:allocate_frame" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> allocate_frame : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> dst:<a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> proto:[ <div class="cons">| `ICMP</div><div class="cons">| `TCP</div><div class="cons">| `UDP</div> ] <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> * int
    
      <div class="doc">
        
      <p><code>allocate_frame t ~dst ~proto</code> retrurns a pair <code>(pkt, len)</code> such that
<code>Cstruct.sub pkt 0 len</code> is the IP header (including the link layer part) of a
packet going to <code>dst</code> for protocol <code>proto</code>. The space in <code>pkt</code> after the
first <code>len</code> bytes can be used by the client.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:write">
  <a href="index.html#/modtype:IP/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write t frame buf</code> writes the packet <code>frame :: buf :: []</code> to the
address <code>dst</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:writev">
  <a href="index.html#/modtype:IP/val:writev" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> writev : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>writev t frame bufs</code> writes the packet <code>frame :: bufs</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:checksum">
  <a href="index.html#/modtype:IP/val:checksum" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> checksum : <a href="index.html#/modtype:IP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>checksum frame bufs</code> computes the IP checksum of <code>bufs</code> computing the
pseudo-header from the actual header <code>frame</code>. It assumes that frame is of
the form returned by <code>allocate_frame</code>, i.e., that it contains the link-layer
part.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:get_source">
  <a href="index.html#/modtype:IP/val:get_source" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_source : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> dst:<a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a>
    
      <div class="doc">
        
      <p><code>get_source ip ~dst</code> is the source address to be used to send a packet to
<code>dst</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:set_ip">
  <a href="index.html#/modtype:IP/val:set_ip" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_ip : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p>Set the IP address associated with this interface. For IPv4, currently
only supports a single IPv4 address, and aliases will be added in a future
revision.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:get_ip">
  <a href="index.html#/modtype:IP/val:get_ip" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_ip : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> list
    
      <div class="doc">
        
      <p>Get the IP addresses associated with this interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:set_ip_netmask">
  <a href="index.html#/modtype:IP/val:set_ip_netmask" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_ip_netmask : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:prefix">prefix</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p>Set an IP netmask associated with this interface. For IPv4, currently
only supports a single IPv4 netmask, and aliases will be added in a future
revision.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:get_ip_netmasks">
  <a href="index.html#/modtype:IP/val:get_ip_netmasks" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_ip_netmasks : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:prefix">prefix</a> list
    
      <div class="doc">
        
      <p>Get the IP netmasks associated with this interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:set_ip_gateways">
  <a href="index.html#/modtype:IP/val:set_ip_gateways" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> set_ip_gateways : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IP/type:io">io</a>
    
      <div class="doc">
        
      <p>Set an IP gateways associated with this interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IP/val:get_ip_gateways">
  <a href="index.html#/modtype:IP/val:get_ip_gateways" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_ip_gateways : <a href="index.html#/modtype:IP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IP/type:ipaddr">ipaddr</a> list
    
      <div class="doc">
        
      <p>Get the IP gateways associated with this interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IPV4">
  <a href="index.html#/modtype:IPV4" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> IPV4 = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:IP">IP</a> 
    </div>
  
  <div class="region" id="/modtype:IPV4/val:input_arpv4">
  <a href="index.html#/modtype:IPV4/val:input_arpv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> input_arpv4 : <a href="index.html#/modtype:IPV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IPV4/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:IPV4/type:io">io</a>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IPV6">
  <a href="index.html#/modtype:IPV6" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> IPV6 = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:IP">IP</a> 
    </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP">
  <a href="index.html#/modtype:UDP" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> UDP = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A UDP stack that can send and receive datagrams.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:UDP/type:buffer">
  <a href="index.html#/modtype:UDP/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/type:ip">
  <a href="index.html#/modtype:UDP/type:ip" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ip
    
      <div class="doc">
        
      <p>Abstract type for an IPv4/6 stack for this stack to connect to.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/type:ipaddr">
  <a href="index.html#/modtype:UDP/type:ipaddr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipaddr
    
      <div class="doc">
        
      <p>Abstract type for an IP address representation.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/type:ipinput">
  <a href="index.html#/modtype:UDP/type:ipinput" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipinput
    
      <div class="doc">
        
      <p>An input function continuation to pass onto the underlying [root:ipv4]
stack. This will normally be a NOOP for a conventional kernel, but
a direct implementation will parse the buffer.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/type:error">
  <a href="index.html#/modtype:UDP/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:UDP/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:id">id</a> := <a href="index.html#/modtype:UDP/type:ip">ip</a> 
    </div>
  
  <div class="region" id="/modtype:UDP/type:callback">
  <a href="index.html#/modtype:UDP/type:callback" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> callback = src:<a href="index.html#/modtype:UDP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> dst:<a href="index.html#/modtype:UDP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> src_port:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:UDP/type:io">io</a>
    
      <div class="doc">
        
      <p>Callback function that adds the UDP metadata for <code>src</code> and <code>dst</code> IP
addresses, the <code>src_port</code> of the connection and the <code>buffer</code> payload
of the datagram.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/val:input">
  <a href="index.html#/modtype:UDP/val:input" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> input : listeners:(dst_port:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:callback">callback</a> option) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:ipinput">ipinput</a>
    
      <div class="doc">
        
      <p><code>input listeners t</code> demultiplexes incoming datagrams based on their destination
port. The <code>listeners</code> callback is will either return a concrete handler or
a <code>None</code>, which results in the datagram being dropped.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:UDP/val:write">
  <a href="index.html#/modtype:UDP/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : ?source_port:int <span class="rarr"><span>-&gt;</span></span> dest_ip:<a href="index.html#/modtype:UDP/type:ipaddr">ipaddr</a> <span class="rarr"><span>-&gt;</span></span> dest_port:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:UDP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:UDP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write ~source_port ~dest_ip ~dest_port udp data</code> is a thread that
writes <code>data</code> from an optional <code>source_port</code> to a <code>dest_ip</code> and <code>dest_port</code>
IPv4 address pair.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP">
  <a href="index.html#/modtype:TCP" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> TCP = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A TCP stack that can send and receive reliable streams using the TCP protocol.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:TCP/type:buffer">
  <a href="index.html#/modtype:TCP/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/type:ip">
  <a href="index.html#/modtype:TCP/type:ip" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ip
    
      <div class="doc">
        
      <p>Abstract type for an IPv4 stack for this stack to connect to.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/type:ipaddr">
  <a href="index.html#/modtype:TCP/type:ipaddr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipaddr
    
      <div class="doc">
        
      <p>Abstract type for an IPv4 address representation.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/type:ipinput">
  <a href="index.html#/modtype:TCP/type:ipinput" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipinput
    
      <div class="doc">
        
      <p>An input function continuation to pass onto the underlying [root:ipv4]
stack. This will normally be a NOOP for a conventional kernel, but
a direct implementation will parse the buffer.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/type:flow">
  <a href="index.html#/modtype:TCP/type:flow" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> flow
    
      <div class="doc">
        
      <p>A flow represents the state of a single TCPv4 stream that is connected
to an endpoint.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/type:error">
  <a href="index.html#/modtype:TCP/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div><div class="cons">| `Timeout</div><div class="cons">| `Refused</div> ]
    
      <div class="doc">
        
      <p>IO operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:TCP/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:id">id</a> := <a href="index.html#/modtype:TCP/type:ip">ip</a> 
    </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:FLOW">FLOW</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:FLOW/type:error">error</a> := <a href="index.html#/modtype:TCP/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> 'a <a href="index.html#/modtype:FLOW/type:io">io</a> := 'a <a href="index.html#/modtype:TCP/type:io">io</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:FLOW/type:buffer">buffer</a> := <a href="index.html#/modtype:TCP/type:buffer">buffer</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:FLOW/type:flow">flow</a> := <a href="index.html#/modtype:TCP/type:flow">flow</a> 
    </div>
  
  <div class="region" id="/modtype:TCP/type:callback">
  <a href="index.html#/modtype:TCP/type:callback" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> callback = <a href="index.html#/modtype:TCP/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:TCP/type:io">io</a>
    
      <div class="doc">
        
      <p>Application callback that receives a <code>flow</code> that it can read/write to.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/val:get_dest">
  <a href="index.html#/modtype:TCP/val:get_dest" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_dest : <a href="index.html#/modtype:TCP/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:ipaddr">ipaddr</a> * int
    
      <div class="doc">
        
      <p>Get the destination IPv4 address and destination port that a flow is
currently connected to.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/val:write_nodelay">
  <a href="index.html#/modtype:TCP/val:write_nodelay" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write_nodelay : <a href="index.html#/modtype:TCP/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:TCP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write_nodelay flow</code> will block until the contents of <code>buffer list</code>
are all successfully transmitted to the remote endpoint. Buffering
within the stack is minimized in this mode. Note that this API will
change in a future revision to be a per-flow attribute instead of a
separately exposed function.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/val:writev_nodelay">
  <a href="index.html#/modtype:TCP/val:writev_nodelay" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> writev_nodelay : <a href="index.html#/modtype:TCP/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:buffer">buffer</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:TCP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>writev_nodelay flow</code> will block until the contents of <code>buffer list</code>
are all successfully transmitted to the remote endpoint. Buffering
within the stack is minimized in this mode. Note that this API will
change in a future revision to be a per-flow attribute instead of a
separately exposed function.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/val:create_connection">
  <a href="index.html#/modtype:TCP/val:create_connection" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> create_connection : <a href="index.html#/modtype:TCP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:ipaddr">ipaddr</a> * int <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:TCP/type:flow">flow</a></div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:TCP/type:error">error</a></div> ] <a href="index.html#/modtype:TCP/type:io">io</a>
    
      <div class="doc">
        
      <p><code>create_connection t (addr,port)</code> will open a TCPv4 connection to the
specified endpoint.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:TCP/val:input">
  <a href="index.html#/modtype:TCP/val:input" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> input : <a href="index.html#/modtype:TCP/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> listeners:(int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:callback">callback</a> option) <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:TCP/type:ipinput">ipinput</a>
    
      <div class="doc">
        
      <p><code>input t listeners</code> defines a mapping of threads that are willing to
accept new flows on a given port. If the <code>callback</code> returns <code>None</code>,
the input function will return an RST to refuse connections on a port.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4">
  <a href="index.html#/modtype:STACKV4" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> STACKV4 = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A complete TCP/IPv4 stack that can be used by applications to receive
and transmit network traffic.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:STACKV4/type:console">
  <a href="index.html#/modtype:STACKV4/type:console" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> console
    
      <div class="doc">
        
      <p>Abstract type of a console logger.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:netif">
  <a href="index.html#/modtype:STACKV4/type:netif" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> netif
    
      <div class="doc">
        
      <p>Abstract type of a network interface that is used to transmit and receive
traffic associated with this stack.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:mode">
  <a href="index.html#/modtype:STACKV4/type:mode" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> mode
    
      <div class="doc">
        
      <p>Abstract type of the configuration modes associated with this interface.
These can consist of the IPv4 address binding, or a DHCP interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:config">
  <a href="index.html#/modtype:STACKV4/type:config" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ('console, 'netif, 'mode) config
    
      <div class="doc">
        
      <p>Abstract type for the collection of user configuration specified to
construct a stack.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:ipv4addr">
  <a href="index.html#/modtype:STACKV4/type:ipv4addr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipv4addr
    
      <div class="doc">
        
      <p>Abstract type of an IPv4 address</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:buffer">
  <a href="index.html#/modtype:STACKV4/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:udpv4">
  <a href="index.html#/modtype:STACKV4/type:udpv4" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> udpv4
    
      <div class="doc">
        
      <p>Abstract type for a UDPv4 stack.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:tcpv4">
  <a href="index.html#/modtype:STACKV4/type:tcpv4" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> tcpv4
    
      <div class="doc">
        
      <p>Abstract type for a TCPv4 stack.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:ipv4">
  <a href="index.html#/modtype:STACKV4/type:ipv4" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ipv4
    
      <div class="doc">
        
      <p>Abstract type for a IPv4 stack</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/type:error">
  <a href="index.html#/modtype:STACKV4/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Unknown <span class="keyword">of</span> string</div> ]
    
      <div class="doc">
        
      <p>I/O operation errors</p>
      
        
      </div>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:STACKV4/type:error">error</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:id">id</a> = (<a href="index.html#/modtype:STACKV4/type:console">console</a>, <a href="index.html#/modtype:STACKV4/type:netif">netif</a>, <a href="index.html#/modtype:STACKV4/type:mode">mode</a>) <a href="index.html#/modtype:STACKV4/type:config">config</a> 
    </div>
  
  <div class="region" id="/modtype:STACKV4/module:UDPV4">
  <a href="index.html#/modtype:STACKV4/module:UDPV4" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> UDPV4 : <a href="index.html#/modtype:UDP">UDP</a> <span class="keyword">with</span> <span class="keyword">type</span> +'a <a href="index.html#/modtype:UDP/type:io">io</a> = 'a <a href="index.html#/modtype:STACKV4/type:io">io</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:UDP/type:ipaddr">ipaddr</a> = <a href="index.html#/modtype:STACKV4/type:ipv4addr">ipv4addr</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:UDP/type:buffer">buffer</a> = <a href="index.html#/modtype:STACKV4/type:buffer">buffer</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:UDP/type:t">t</a> = <a href="index.html#/modtype:STACKV4/type:udpv4">udpv4</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:UDP/type:ip">ip</a> = <a href="index.html#/modtype:STACKV4/type:ipv4">ipv4</a></div>
      
      
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/module:TCPV4">
  <a href="index.html#/modtype:STACKV4/module:TCPV4" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> TCPV4 : <a href="index.html#/modtype:TCP">TCP</a> <span class="keyword">with</span> <span class="keyword">type</span> +'a <a href="index.html#/modtype:TCP/type:io">io</a> = 'a <a href="index.html#/modtype:STACKV4/type:io">io</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:TCP/type:ipaddr">ipaddr</a> = <a href="index.html#/modtype:STACKV4/type:ipv4addr">ipv4addr</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:TCP/type:buffer">buffer</a> = <a href="index.html#/modtype:STACKV4/type:buffer">buffer</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:TCP/type:t">t</a> = <a href="index.html#/modtype:STACKV4/type:tcpv4">tcpv4</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:TCP/type:ip">ip</a> = <a href="index.html#/modtype:STACKV4/type:ipv4">ipv4</a></div>
      
      
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/module:IPV4">
  <a href="index.html#/modtype:STACKV4/module:IPV4" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> IPV4 : <a href="index.html#/modtype:IPV4">IPV4</a> <span class="keyword">with</span> <span class="keyword">type</span> +'a <a href="index.html#/modtype:IPV4/type:io">io</a> = 'a <a href="index.html#/modtype:STACKV4/type:io">io</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:IPV4/type:ipaddr">ipaddr</a> = <a href="index.html#/modtype:STACKV4/type:ipv4addr">ipv4addr</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:IPV4/type:buffer">buffer</a> = <a href="index.html#/modtype:STACKV4/type:buffer">buffer</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="index.html#/modtype:IPV4/type:t">t</a> = <a href="index.html#/modtype:STACKV4/type:ipv4">ipv4</a></div>
      
      
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:udpv4">
  <a href="index.html#/modtype:STACKV4/val:udpv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> udpv4 : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:STACKV4/type:udpv4">udpv4</a>
    
      <div class="doc">
        
      <p><code>udpv4 t</code> obtains a descriptor for use with the <code>UDPV4</code> module,
usually to transmit traffic.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:tcpv4">
  <a href="index.html#/modtype:STACKV4/val:tcpv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> tcpv4 : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:STACKV4/type:tcpv4">tcpv4</a>
    
      <div class="doc">
        
      <p><code>tcpv4 t</code> obtains a descriptor for use with the <code>TCPV4</code> module,
usually to initiate outgoing connections.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:ipv4">
  <a href="index.html#/modtype:STACKV4/val:ipv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> ipv4 : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:STACKV4/type:ipv4">ipv4</a>
    
      <div class="doc">
        
      <p><code>ipv4 t</code> obtains a descriptor for use with the <code>IPV4</code> module,
which can handle raw IPv4 frames, or manipulate IP address
configuration on the stack interface.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:listen_udpv4">
  <a href="index.html#/modtype:STACKV4/val:listen_udpv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> listen_udpv4 : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> port:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:STACKV4/module:UDPV4">UDPV4</a>.<a href="index.html#/modtype:STACKV4/module:UDPV4/type:callback">callback</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>listen_udpv4 t ~port cb</code> will register the <code>cb</code> callback on
the UDPv4 <code>port</code> and immediately return. Multiple bindings
to the same port will overwrite previous bindings, so callbacks
will not chain if ports clash.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:listen_tcpv4">
  <a href="index.html#/modtype:STACKV4/val:listen_tcpv4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> listen_tcpv4 : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> port:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:STACKV4/module:TCPV4">TCPV4</a>.<a href="index.html#/modtype:STACKV4/module:TCPV4/type:callback">callback</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>listen_tcpv4 t ~port cb</code> will register the <code>cb</code> callback on
the TCPv4 <code>port</code> and immediately return. Multiple bindings
to the same port will overwrite previous bindings, so callbacks
will not chain if ports clash.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:STACKV4/val:listen">
  <a href="index.html#/modtype:STACKV4/val:listen" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> listen : <a href="index.html#/modtype:STACKV4/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:STACKV4/type:io">io</a>
    
      <div class="doc">
        
      <p><code>listen t</code> will cause the stack to listen for traffic on the
network interface associated with the stack, and demultiplex
traffic to the appropriate callbacks.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL">
  <a href="index.html#/modtype:CHANNEL" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> CHANNEL = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Type of a buffered byte-stream that is attached to an unbuffered
flow (e.g. a TCPv4 connection).</p>
      
        
      </div>
    
  <div class="region" id="/modtype:CHANNEL/type:buffer">
  <a href="index.html#/modtype:CHANNEL/type:buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buffer
    
      <div class="doc">
        
      <p>Abstract type for a memory buffer that may not be page aligned.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/type:flow">
  <a href="index.html#/modtype:CHANNEL/type:flow" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> flow
    
      <div class="doc">
        
      <p>Abstract type for an unbuffered network flow.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/type:t">
  <a href="index.html#/modtype:CHANNEL/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t
    
      <div class="doc">
        
      <p>State associated with this channel, such as the inflight buffers.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/type:io">
  <a href="index.html#/modtype:CHANNEL/type:io" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a io
    
      <div class="doc">
        
      <p>Abstract type of a blocking IO monad.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/type:io_stream">
  <a href="index.html#/modtype:CHANNEL/type:io_stream" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> 'a io_stream
    
      <div class="doc">
        
      <p>Abstract type of a blocking stream of IO requests.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:create">
  <a href="index.html#/modtype:CHANNEL/val:create" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> create : <a href="index.html#/modtype:CHANNEL/type:flow">flow</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:t">t</a>
    
      <div class="doc">
        
      <p><code>create flow</code> will allocate send and receive buffers and associated them
with the given unbuffered <code>flow</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:to_flow">
  <a href="index.html#/modtype:CHANNEL/val:to_flow" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> to_flow : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:flow">flow</a>
    
      <div class="doc">
        
      <p><code>to_flow t</code> will return the flow that backs this channel.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:read_char">
  <a href="index.html#/modtype:CHANNEL/val:read_char" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read_char : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
      <div class="doc">
        
      <p>Read a single character from the channel, blocking if there is no immediately
available input data.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:read_until">
  <a href="index.html#/modtype:CHANNEL/val:read_until" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read_until : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> (bool * <a href="index.html#/modtype:CHANNEL/type:buffer">buffer</a>) <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read_until t ch</code> will read from the channel until the given <code>ch</code> character
is found. It returns a tuple indicating whether the character was found at
all (<code>false</code> indicates that an EOF condition occurred before the character
was encountered), and the <code>buffer</code> pointing to the position immediately
after the character (or the complete scanned buffer if the character was
never encountered).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:read_some">
  <a href="index.html#/modtype:CHANNEL/val:read_some" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read_some : ?len:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:buffer">buffer</a> <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:read_stream">
  <a href="index.html#/modtype:CHANNEL/val:read_stream" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read_stream : ?len:int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:buffer">buffer</a> <a href="index.html#/modtype:CHANNEL/type:io_stream">io_stream</a>
    
      <div class="doc">
        
      <p><code>read_stream ?len t</code> will return up to <code>len</code> characters as a stream of
buffers. This call will probably be removed in a future revision of the API
in favour of <a href="index.html#/modtype:CHANNEL/val:read_some">read_some</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:read_line">
  <a href="index.html#/modtype:CHANNEL/val:read_line" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read_line : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:buffer">buffer</a> list <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read_line t</code> will read a line of input, which is terminated either by
a CRLF sequence, or the end of the channel (which counts as a line).</p>
      
        
  <div class="tag return">
    <span class="label">Returns</span> Returns a list of views that terminates at EOF.
  </div>
  
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:write_char">
  <a href="index.html#/modtype:CHANNEL/val:write_char" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write_char : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> char <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>write_char t ch</code> writes a single character to the output channel.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:write_string">
  <a href="index.html#/modtype:CHANNEL/val:write_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write_string : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>write_string t buf off len</code> writes <code>len</code> bytes from a string <code>buf</code>,
starting from from offset <code>off</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:write_buffer">
  <a href="index.html#/modtype:CHANNEL/val:write_buffer" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write_buffer : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:CHANNEL/type:buffer">buffer</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>write_buffer t buf</code> will copy the buffer to the channel's output buffer.
The buffer should not be modified after being written, and it will be
recycled into the buffer allocation pool at some future point.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:write_line">
  <a href="index.html#/modtype:CHANNEL/val:write_line" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write_line : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>write_line t buf</code> will write the string <code>buf</code> to the output channel
and append a newline character afterwards.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:flush">
  <a href="index.html#/modtype:CHANNEL/val:flush" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> flush : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
      <div class="doc">
        
      <p><code>flush t</code> will flush the output buffer and block if necessary until it
is all written out to the flow.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:CHANNEL/val:close">
  <a href="index.html#/modtype:CHANNEL/val:close" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> close : <a href="index.html#/modtype:CHANNEL/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/modtype:CHANNEL/type:io">io</a>
    
      <div class="doc">
        
      <p><code>close t</code> will call <a href="index.html#/modtype:CHANNEL/val:flush">flush</a> and then close the underlying flow.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS">
  <a href="index.html#/modtype:FS" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> FS = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>A filesystem module.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:FS/type:block_device_error">
  <a href="index.html#/modtype:FS/type:block_device_error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> block_device_error
    
      <div class="doc">
        
      <p>Abstract type representing an error from the block layer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/type:error">
  <a href="index.html#/modtype:FS/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = [ <div class="cons">| `Not_a_directory <span class="keyword">of</span> string</div><div class="cons">| `Is_a_directory <span class="keyword">of</span> string</div><div class="cons">| `Directory_not_empty <span class="keyword">of</span> string</div><div class="cons">| `No_directory_entry <span class="keyword">of</span> string * string</div><div class="cons">| `File_already_exists <span class="keyword">of</span> string</div><div class="cons">| `No_space</div><div class="cons">| `Format_not_recognised <span class="keyword">of</span> string</div><div class="cons">| `Unknown_error <span class="keyword">of</span> string</div><div class="cons">| `Block_device <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:block_device_error">block_device_error</a></div> ]
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:FS/type:error">error</a> 
    </div>
  
  <div class="region" id="/modtype:FS/type:page_aligned_buffer">
  <a href="index.html#/modtype:FS/type:page_aligned_buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> page_aligned_buffer
    
      <div class="doc">
        
      <p>Abstract type for a page-aligned memory buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:read">
  <a href="index.html#/modtype:FS/val:read" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:page_aligned_buffer">page_aligned_buffer</a> list</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read t key offset length</code> reads up to <code>length</code> bytes from the value
associated with <code>key</code>. If less data is returned than requested, this
indicates the end of the value.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:size">
  <a href="index.html#/modtype:FS/val:size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> size : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div><div class="cons">| `Ok <span class="keyword">of</span> int64</div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p>Get the value size.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/type:stat">
  <a href="index.html#/modtype:FS/type:stat" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> stat = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/modtype:FS/type:stat/field:filename">
  <a href="index.html#/modtype:FS/type:stat/field:filename" class="anchor">#</a>
  filename
  </div>
  </td><td>: string</td><td>;</td><td>(*</td><td class="doc">Filename within the enclosing directory</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:FS/type:stat/field:read_only">
  <a href="index.html#/modtype:FS/type:stat/field:read_only" class="anchor">#</a>
  read_only
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">True means the contents are read-only</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:FS/type:stat/field:directory">
  <a href="index.html#/modtype:FS/type:stat/field:directory" class="anchor">#</a>
  directory
  </div>
  </td><td>: bool</td><td>;</td><td>(*</td><td class="doc">True means the entity is a directory; false means a file</td><td>*)</td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/modtype:FS/type:stat/field:size">
  <a href="index.html#/modtype:FS/type:stat/field:size" class="anchor">#</a>
  size
  </div>
  </td><td>: int64</td><td>;</td><td>(*</td><td class="doc">Size of the entity in bytes</td><td>*)</td>
  </tr>
    </table>}
    
      <div class="doc">
        
      <p>Per-file/directory statistics</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:format">
  <a href="index.html#/modtype:FS/val:format" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> format : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int64 <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>format t size</code> erases the contents of <code>t</code> and creates an empty filesystem
of size <code>size</code> bytes</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:create">
  <a href="index.html#/modtype:FS/val:create" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> create : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>create t path</code> creates an empty file at <code>path</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:mkdir">
  <a href="index.html#/modtype:FS/val:mkdir" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> mkdir : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>mkdir t path</code> creates an empty directory at <code>path</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:destroy">
  <a href="index.html#/modtype:FS/val:destroy" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> destroy : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>destroy t path</code> removes a <code>path</code> (which may be a file or an empty
directory) on filesystem <code>t</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:stat">
  <a href="index.html#/modtype:FS/val:stat" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> stat : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:stat">stat</a></div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>stat t path</code> returns information about file or directory at <code>path</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:listdir">
  <a href="index.html#/modtype:FS/val:listdir" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> listdir : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> string list</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>listdir t path</code> returns the names of files and subdirectories
within the directory <code>path</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:FS/val:write">
  <a href="index.html#/modtype:FS/val:write" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> write : <a href="index.html#/modtype:FS/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:FS/type:page_aligned_buffer">page_aligned_buffer</a> <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> unit</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:FS/type:error">error</a></div> ] <a href="index.html#/modtype:FS/type:io">io</a>
    
      <div class="doc">
        
      <p><code>write t path offset data</code> writes <code>data</code> at <code>offset</code> in file <code>path</code> on
filesystem <code>t</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE">
  <a href="index.html#/modtype:IO_PAGE" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> IO_PAGE = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Memory allocation interface.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:IO_PAGE/type:buf">
  <a href="index.html#/modtype:IO_PAGE/type:buf" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> buf
    
      <div class="doc">
        
      <p>Type of a C buffer (usually Cstruct)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/type:t">
  <a href="index.html#/modtype:IO_PAGE/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t = (char, <a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/">Bigarray</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/type:int8_unsigned_elt">int8_unsigned_elt</a>, <a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/">Bigarray</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/type:c_layout">c_layout</a>) <a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/">Bigarray</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/module:Array1">Array1</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/module:Array1/type:t">t</a>
    
      <div class="doc">
        
      <p>Type of memory blocks.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:get">
  <a href="index.html#/modtype:IO_PAGE/val:get" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a>
    
      <div class="doc">
        
      <p><code>get n</code> allocates and returns a memory block of <code>n</code> pages. If
there is not enough memory, the unikernel will terminate.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:get_order">
  <a href="index.html#/modtype:IO_PAGE/val:get_order" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get_order : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a>
    
      <div class="doc">
        
      <p><code>get_order i</code> is <code>get (1 lsl i)</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:pages">
  <a href="index.html#/modtype:IO_PAGE/val:pages" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> pages : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a> list
    
      <div class="doc">
        
      <p><code>pages n</code> allocates a memory block of <code>n</code> pages and return the the
list of pages allocated.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:pages_order">
  <a href="index.html#/modtype:IO_PAGE/val:pages_order" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> pages_order : int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a> list
    
      <div class="doc">
        
      <p><code>pages_order i</code> is <code>pages (1 lsl i)</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:length">
  <a href="index.html#/modtype:IO_PAGE/val:length" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> length : <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>length t</code> is the size of <code>t</code>, in bytes.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:to_cstruct">
  <a href="index.html#/modtype:IO_PAGE/val:to_cstruct" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> to_cstruct : <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:buf">buf</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:to_string">
  <a href="index.html#/modtype:IO_PAGE/val:to_string" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> to_string : <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:to_pages">
  <a href="index.html#/modtype:IO_PAGE/val:to_pages" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> to_pages : <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a> list
    
      <div class="doc">
        
      <p><code>to_pages t</code> is a list of <code>size</code> memory blocks of one page each,
where <code>size</code> is the size of <code>t</code> in pages.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:string_blit">
  <a href="index.html#/modtype:IO_PAGE/val:string_blit" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> string_blit : string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>string_blit src srcoff dst dstoff len</code> copies <code>len</code> bytes from
string <code>src</code>, starting at byte number <code>srcoff</code>, to memory block
<code>dst</code>, starting at byte number dstoff.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:blit">
  <a href="index.html#/modtype:IO_PAGE/val:blit" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> blit : <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/modtype:IO_PAGE/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>blit t1 t2</code> is the same as <a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/">Bigarray</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/module:Array1">Array1</a>.<a href="../../../../ocaml.4.02.1+doc/otherlibs/bigarray/bigarray/#/module:Array1/val:blit">blit</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:IO_PAGE/val:round_to_page_size">
  <a href="index.html#/modtype:IO_PAGE/val:round_to_page_size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> round_to_page_size : int <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>round_to_page_size n</code> returns the number of bytes that will be
allocated for storing <code>n</code> bytes in memory</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:KV_RO">
  <a href="index.html#/modtype:KV_RO" class="anchor">#</a>
  
  <div class="modtype">
    <div class="intro">
      <span class="keyword">module type</span> KV_RO = <span class="keyword">sig</span>
    </div>
    
    
    <div class="sig">
      <div class="doc">
        
      <p>Static Key/value store.</p>
      
        
      </div>
    
  <div class="region" id="/modtype:KV_RO/type:error">
  <a href="index.html#/modtype:KV_RO/type:error" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> error = <table>
    <tr class="cons"><td>
  <div class="region" id="/modtype:KV_RO/type:error/cons:Unknown_key">
  <a href="index.html#/modtype:KV_RO/type:error/cons:Unknown_key" class="anchor">#</a>
  | Unknown_key <span class="keyword">of</span> string
  </div>
  </td><td></td><td></td><td></td></tr>
    </table>
    
  </div>
  
  </div>
  
    <div class="include">
    <span class="keyword">include</span> <a href="index.html#/modtype:DEVICE">DEVICE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#/modtype:DEVICE/type:error">error</a> := <a href="index.html#/modtype:KV_RO/type:error">error</a> 
    </div>
  
  <div class="region" id="/modtype:KV_RO/type:page_aligned_buffer">
  <a href="index.html#/modtype:KV_RO/type:page_aligned_buffer" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> page_aligned_buffer
    
      <div class="doc">
        
      <p>Abstract type for a page-aligned memory buffer</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:KV_RO/val:read">
  <a href="index.html#/modtype:KV_RO/val:read" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> read : <a href="index.html#/modtype:KV_RO/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> int <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/modtype:KV_RO/type:page_aligned_buffer">page_aligned_buffer</a> list</div><div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:KV_RO/type:error">error</a></div> ] <a href="index.html#/modtype:KV_RO/type:io">io</a>
    
      <div class="doc">
        
      <p><code>read t key offset length</code> reads up to <code>length</code> bytes from the value
associated with <code>key</code>. If less data is returned than requested, this
indicates the end of the value.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/modtype:KV_RO/val:size">
  <a href="index.html#/modtype:KV_RO/val:size" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> size : <a href="index.html#/modtype:KV_RO/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> string <span class="rarr"><span>-&gt;</span></span> [ <div class="cons">| `Error <span class="keyword">of</span> <a href="index.html#/modtype:KV_RO/type:error">error</a></div><div class="cons">| `Ok <span class="keyword">of</span> int64</div> ] <a href="index.html#/modtype:KV_RO/type:io">io</a>
    
      <div class="doc">
        
      <p>Get the value size.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>