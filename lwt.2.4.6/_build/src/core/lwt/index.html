<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../../codoc.css"/>
    <title>Lwt</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Lwt</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>Module <code>Lwt</code>: cooperative light-weight threads.</p>
      
        
      </div>
    
      
    <div class="sig">
      <div class="doc">
        
      <p>This module defines <em>cooperative light-weight threads</em> with
their primitives. A <em>light-weight thread</em> represent a
computation that may be not terminated, for example because it is
waiting for some event to happen.</p>
      
      <p>Lwt threads are cooperative in the sense that switching to another
thread is awlays explicit (with <a href="index.html#/val:wakeup">wakeup</a> or <a href="index.html#/val:wakeup_exn">wakeup_exn</a>). When a
thread is running, it executes as much as possible, and then
returns (a value or an error) or sleeps.</p>
      
      <p>Note that inside a Lwt thread, exceptions must be raised with
<a href="index.html#/val:fail">fail</a> instead of <code>raise</code>. Also the <code>try ... with ...</code>
construction will not catch Lwt errors. You must use <a href="index.html#/val:catch">catch</a>
instead. You can also use <a href="index.html#/val:wrap">wrap</a> for functions that may raise
normal exception.</p>
      
      <p>Lwt also provides the syntax extension [root:Pa_lwt] to make code
using Lwt more readable.</p>
      
        
      </div>
    
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Definitions and basics</h2>
    </div>
        
      </div>
    
  <div class="region" id="/type:t">
  <a href="index.html#/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a t
    
      <div class="doc">
        
      <p>The type of threads returning a result of type <code>'a</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:return">
  <a href="index.html#/val:return" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return : 'a <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return e</code> is a thread whose return value is the value of the
expression <code>e</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:fail">
  <a href="index.html#/val:fail" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> fail : exn <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>fail e</code> is a thread that fails with the exception <code>e</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:bind">
  <a href="index.html#/val:bind" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> bind : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>bind t f</code> is a thread which first waits for the thread <code>t</code> to
terminate and then, if the thread succeeds, behaves as the
application of function <code>f</code> to the return value of <code>t</code>. If the
thread <code>t</code> fails, <code>bind t f</code> also fails, with the same
exception.</p>
      
      <p>The expression <code>bind t (fun x -&gt; t')</code> can intuitively be read as
<code>let x = t in t'</code>, and if you use the <em>lwt.syntax</em> syntax
extension, you can write a bind operation like that: <code>lwt x = t in t'</code>.</p>
      
      <p>Note that <code>bind</code> is also often used just for synchronization
purpose: <code>t'</code> will not execute before <code>t</code> is terminated.</p>
      
      <p>The result of a thread can be bound several times.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(&gt;&gt;=)">
  <a href="index.html#/val:(%3E%3E=)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (&gt;&gt;=) : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>t &gt;&gt;= f</code> is an alternative notation for <code>bind t f</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(=&lt;&lt;)">
  <a href="index.html#/val:(=%3C%3C)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (=&lt;&lt;) : ('a <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>f =&lt;&lt; t</code> is <code>t &gt;&gt;= f</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:map">
  <a href="index.html#/val:map" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> map : ('a <span class="rarr"><span>-&gt;</span></span> 'b) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>map f m</code> maps the result of a thread. This is the same as <code>bind
      m (fun x -&gt; return (f x))</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(&gt;|=)">
  <a href="index.html#/val:(%3E%7C=)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (&gt;|=) : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> 'b) <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>m &gt;|= f</code> is <code>map f m</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(=|&lt;)">
  <a href="index.html#/val:(=%7C%3C)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (=|&lt;) : ('a <span class="rarr"><span>-&gt;</span></span> 'b) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>f =|&lt; m</code> is <code>map f m</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h3 class="section level_3">Pre-allocated threads</h3>
    </div>
        
      </div>
    
  <div class="region" id="/val:return_unit">
  <a href="index.html#/val:return_unit" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return_unit : unit <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return_unit = return ()</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:return_none">
  <a href="index.html#/val:return_none" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return_none : 'a option <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return_none = return None</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:return_nil">
  <a href="index.html#/val:return_nil" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return_nil : 'a list <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return_nil = return []</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:return_true">
  <a href="index.html#/val:return_true" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return_true : bool <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return_true = return true</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:return_false">
  <a href="index.html#/val:return_false" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> return_false : bool <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>return_false = return false</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Thread storage</h2>
    </div>
        
      </div>
    
  <div class="region" id="/type:key">
  <a href="index.html#/type:key" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> 'a key
    
      <div class="doc">
        
      <p>Type of a key. Keys are used to store local values into
threads.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:new_key">
  <a href="index.html#/val:new_key" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> new_key : unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:key">key</a>
    
      <div class="doc">
        
      <p><code>new_key ()</code> creates a new key.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:get">
  <a href="index.html#/val:get" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> get : 'a <a href="index.html#/type:key">key</a> <span class="rarr"><span>-&gt;</span></span> 'a option
    
      <div class="doc">
        
      <p><code>get key</code> returns the value associated with <code>key</code> in the current
thread.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:with_value">
  <a href="index.html#/val:with_value" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> with_value : 'a <a href="index.html#/type:key">key</a> <span class="rarr"><span>-&gt;</span></span> 'a option <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> 'b) <span class="rarr"><span>-&gt;</span></span> 'b
    
      <div class="doc">
        
      <p><code>with_value key value f</code> executes <code>f</code> with <code>value</code> associated to
<code>key</code>. <code>key</code> is restored to its previous value after <code>f</code> terminates.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Exceptions handling</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:catch">
  <a href="index.html#/val:catch" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> catch : (unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> (exn <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>catch t f</code> is a thread that behaves as the thread <code>t ()</code> if
this thread succeeds. If the thread <code>t ()</code> fails with some
exception, <code>catch t f</code> behaves as the application of <code>f</code> to this
exception.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:try_bind">
  <a href="index.html#/val:try_bind" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> try_bind : (unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> (exn <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>try_bind t f g</code> behaves as <code>bind (t ()) f</code> if <code>t</code> does not
fail. Otherwise, it behaves as the application of <code>g</code> to the
exception associated to <code>t ()</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:finalize">
  <a href="index.html#/val:finalize" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> finalize : (unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>finalize f g</code> returns the same result as <code>f ()</code> whether it
fails or not. In both cases, <code>g ()</code> is executed after <code>f</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap">
  <a href="index.html#/val:wrap" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap : (unit <span class="rarr"><span>-&gt;</span></span> 'a) <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>wrap f</code> calls <code>f</code> and transforms the result into an Lwt thread.
If <code>f</code> raises an exception, it is caught and converted to an Lwt
exception.</p>
      
      <p>This is actually the same as:</p>
      <pre><code>        try
          return (f ())
        with exn -&gt;
          fail exn</code></pre>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap1">
  <a href="index.html#/val:wrap1" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap1 : ('a <span class="rarr"><span>-&gt;</span></span> 'b) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>wrap1 f x</code> applies <code>f</code> on <code>x</code> and returns the result as a
thread. If the application of <code>f</code> to <code>x</code> raise an exception it
is catched and a thread is returned.</p>
      
      <p>Note that you must use <a href="index.html#/val:wrap">wrap</a> instead of <a href="index.html#/val:wrap1">wrap1</a> if the
evaluation of <code>x</code> may raise an exception.</p>
      
      <p>For example, the following code is incorrect:</p>
      <pre><code>        wrap1 f (Hashtbl.find table key)</code></pre>
      <p>and should be written as:</p>
      <pre><code>        wrap (fun () -&gt; f (Hashtbl.find table key))</code></pre>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap2">
  <a href="index.html#/val:wrap2" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap2 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap3">
  <a href="index.html#/val:wrap3" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap3 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap4">
  <a href="index.html#/val:wrap4" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap4 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap5">
  <a href="index.html#/val:wrap5" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap5 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap6">
  <a href="index.html#/val:wrap6" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap6 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f <span class="rarr"><span>-&gt;</span></span> 'g) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f <span class="rarr"><span>-&gt;</span></span> 'g <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wrap7">
  <a href="index.html#/val:wrap7" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wrap7 : ('a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f <span class="rarr"><span>-&gt;</span></span> 'g <span class="rarr"><span>-&gt;</span></span> 'h) <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> 'b <span class="rarr"><span>-&gt;</span></span> 'c <span class="rarr"><span>-&gt;</span></span> 'd <span class="rarr"><span>-&gt;</span></span> 'e <span class="rarr"><span>-&gt;</span></span> 'f <span class="rarr"><span>-&gt;</span></span> 'g <span class="rarr"><span>-&gt;</span></span> 'h <a href="index.html#/type:t">t</a>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Multi-threads composition</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:choose">
  <a href="index.html#/val:choose" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> choose : 'a <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>choose l</code> behaves as the first thread in <code>l</code> to terminate. If
several threads are already terminated, one is chosen at
random.</p>
      
      <p>Note: <a href="index.html#/val:choose">choose</a> leaves the local values of the current thread
unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:nchoose">
  <a href="index.html#/val:nchoose" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> nchoose : 'a <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> 'a list <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>nchoose l</code> returns the value of all that have succcessfully
terminated. If all threads are sleeping, it waits for at least
one to terminates. If one the threads of <code>l</code> fails, <code>nchoose</code>
fails with the same exception.</p>
      
      <p>Note: <a href="index.html#/val:nchoose">nchoose</a> leaves the local values of the current thread
unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:nchoose_split">
  <a href="index.html#/val:nchoose_split" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> nchoose_split : 'a <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> ('a list * 'a <a href="index.html#/type:t">t</a> list) <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>nchoose_split l</code> does the same as <a href="index.html#/val:nchoose">nchoose</a> but also retrurns
the list of threads that have not yet terminated.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:join">
  <a href="index.html#/val:join" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> join : unit <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>join l</code> waits for all threads in <code>l</code> to terminate. If one of
the threads fails, then <code>join l</code> will fails with the same
exception as the first one to terminate.</p>
      
      <p>Note: <a href="index.html#/val:join">join</a> leaves the local values of the current thread
unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(&lt;?&gt;)">
  <a href="index.html#/val:(%3C?%3E)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (&lt;?&gt;) : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>t &lt;?&gt; t'</code> is the same as <code>choose [t; t']</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:(&lt;&amp;&gt;)">
  <a href="index.html#/val:(%3C%26%3E)" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> (&lt;&amp;&gt;) : unit <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>t &lt;&amp;&gt; t'</code> is the same as <code>join [t; t']</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:async">
  <a href="index.html#/val:async" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> async : (unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>async f</code> starts a thread without waiting for the result. If it
fails (now or later), the exception is given to
<a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
      <p>You should use this function if you want to start a thread that
might fail and don't care what its return value is, nor when it
terminates (for instance, because it is looping).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:ignore_result">
  <a href="index.html#/val:ignore_result" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> ignore_result : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>ignore_result t</code> is like <code>Pervasives.ignore t</code> except that:</p>
      <ul><li>if <code>t</code> already failed, it raises the exception now,</li><li>if <code>t</code> is sleeping and fails later, the exception will be
given to <a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:async_exception_hook">
  <a href="index.html#/val:async_exception_hook" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> async_exception_hook : (exn <span class="rarr"><span>-&gt;</span></span> unit) <a href="../../../../../ocaml.4.02.1+doc/stdlib/pervasives/">Pervasives</a>.<a href="../../../../../ocaml.4.02.1+doc/stdlib/pervasives/#/type:ref">ref</a>
    
      <div class="doc">
        
      <p>Function called when a asynchronous exception is thrown.</p>
      
      <p>The default behavior is to print an error message with a
backtrace if available and to exit the program.</p>
      
      <p>The behavior is undefined if this function raise an
exception.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Sleeping and resuming</h2>
    </div>
        
      </div>
    
  <div class="region" id="/type:u">
  <a href="index.html#/type:u" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> 'a u
    
      <div class="doc">
        
      <p>The type of thread wakeners.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wait">
  <a href="index.html#/val:wait" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wait : unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> * 'a <a href="index.html#/type:u">u</a>
    
      <div class="doc">
        
      <p><code>wait ()</code> is a pair of a thread which sleeps forever (unless it
is resumed by one of the functions <code>wakeup</code>, <code>wakeup_exn</code> below)
and the corresponding wakener. This thread does not block the
execution of the remainder of the program (except of course, if
another thread tries to wait for its termination).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup">
  <a href="index.html#/val:wakeup" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>wakeup t e</code> makes the sleeping thread <code>t</code> terminate and return
the value of the expression <code>e</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_exn">
  <a href="index.html#/val:wakeup_exn" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_exn : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> exn <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>wakeup_exn t e</code> makes the sleeping thread <code>t</code> fail with the
exception <code>e</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_later">
  <a href="index.html#/val:wakeup_later" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_later : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> 'a <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Same as <a href="index.html#/val:wakeup">wakeup</a> but it is not guaranteed that the thread will
be woken up immediately.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_later_exn">
  <a href="index.html#/val:wakeup_later_exn" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_later_exn : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> exn <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Same as <a href="index.html#/val:wakeup_exn">wakeup_exn</a> but it is not guaranteed that the thread
will be woken up immediately.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:waiter_of_wakener">
  <a href="index.html#/val:waiter_of_wakener" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> waiter_of_wakener : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p>Returns the thread associated to a wakener.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:result">
  <a href="index.html#/type:result" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> +'a result
    
      <div class="doc">
        
      <p>Either a value of type <code>'a</code>, either an exception.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:make_value">
  <a href="index.html#/val:make_value" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> make_value : 'a <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:result">result</a>
    
      <div class="doc">
        
      <p><code>value x</code> creates a result containing the value <code>x</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:make_error">
  <a href="index.html#/val:make_error" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> make_error : exn <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:result">result</a>
    
      <div class="doc">
        
      <p><code>error e</code> creates a result containing the exception <code>e</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:of_result">
  <a href="index.html#/val:of_result" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> of_result : 'a <a href="index.html#/type:result">result</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p>Returns a thread from a result.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_result">
  <a href="index.html#/val:wakeup_result" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_result : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:result">result</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>wakeup_result t r</code> makes the sleeping thread <code>t</code> terminate with
the result <code>r</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_later_result">
  <a href="index.html#/val:wakeup_later_result" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_later_result : 'a <a href="index.html#/type:u">u</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:result">result</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p>Same as <a href="index.html#/val:wakeup_result">wakeup_result</a> but it is not guaranteed that the
thread will be woken up immediately.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Threads state</h2>
    </div>
        
      </div>
    
  <div class="region" id="/type:state">
  <a href="index.html#/type:state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> 'a state = <table>
    <tr class="cons"><td>
  <div class="region" id="/type:state/cons:Return">
  <a href="index.html#/type:state/cons:Return" class="anchor">#</a>
  | Return <span class="keyword">of</span> 'a
  </div>
  </td><td>(*</td><td class="doc">The thread which has successfully terminated</td><td>*)</td></tr><tr class="cons"><td>
  <div class="region" id="/type:state/cons:Fail">
  <a href="index.html#/type:state/cons:Fail" class="anchor">#</a>
  | Fail <span class="keyword">of</span> exn
  </div>
  </td><td>(*</td><td class="doc">The thread raised an exception</td><td>*)</td></tr><tr class="cons"><td>
  <div class="region" id="/type:state/cons:Sleep">
  <a href="index.html#/type:state/cons:Sleep" class="anchor">#</a>
  | Sleep
  </div>
  </td><td>(*</td><td class="doc">The thread is sleeping</td><td>*)</td></tr>
    </table>
    
      <div class="doc">
        
      <p>State of a thread</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:state">
  <a href="index.html#/val:state" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> state : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:state">state</a>
    
      <div class="doc">
        
      <p><code>state t</code> returns the state of a thread</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:is_sleeping">
  <a href="index.html#/val:is_sleeping" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> is_sleeping : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> bool
    
      <div class="doc">
        
      <p><code>is_sleeping t</code> returns <code>true</code> iff <code>t</code> is sleeping.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Cancelable threads</h2>
    </div>
        
      </div>
    
      <div class="doc">
        
      <p>Cancelable threads are the same as regular threads except that
they can be canceled.</p>
      
        
      </div>
    
  <div class="region" id="/exn:Canceled">
  <a href="index.html#/exn:Canceled" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> Canceled
    
      <div class="doc">
        
      <p>Canceled threads fails with this exception</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:task">
  <a href="index.html#/val:task" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> task : unit <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a> * 'a <a href="index.html#/type:u">u</a>
    
      <div class="doc">
        
      <p><code>task ()</code> is the same as <code>wait ()</code> except that threads created
with <code>task</code> can be canceled.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:on_cancel">
  <a href="index.html#/val:on_cancel" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> on_cancel : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>on_cancel t f</code> executes <code>f</code> when <code>t</code> is canceled. <code>f</code> will be
executed before all other threads waiting on <code>t</code>.</p>
      
      <p>If <code>f</code> raises an exception it is given to
<a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_task_r">
  <a href="index.html#/val:add_task_r" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_task_r : 'a <a href="index.html#/type:u">u</a> <a href="../../../../../lwt.2.4.6/_build/src/core/lwt_sequence/">Lwt_sequence</a>.<a href="../../../../../lwt.2.4.6/_build/src/core/lwt_sequence/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>add_task_r seq</code> creates a sleeping thread, adds its wakener to
the right of <code>seq</code> and returns its waiter. When the thread is
canceled, it is removed from <code>seq</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:add_task_l">
  <a href="index.html#/val:add_task_l" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> add_task_l : 'a <a href="index.html#/type:u">u</a> <a href="../../../../../lwt.2.4.6/_build/src/core/lwt_sequence/">Lwt_sequence</a>.<a href="../../../../../lwt.2.4.6/_build/src/core/lwt_sequence/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>add_task_l seq</code> creates a sleeping thread, adds its wakener to
the left of <code>seq</code> and returns its waiter. When the thread is
canceled, it is removed from <code>seq</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:cancel">
  <a href="index.html#/val:cancel" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> cancel : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>cancel t</code> cancels the threads <code>t</code>. This means that the deepest
sleeping thread created with <code>task</code> and connected to <code>t</code> is
woken up with the exception <a href="index.html#/exn:Canceled">Canceled</a>.</p>
      
      <p>For example, in the following code:</p>
      <pre><code>        let waiter, wakener = task () in
        cancel (waiter &gt;&gt; printl &quot;plop&quot;)</code></pre>
      <p><code>waiter</code> will be woken up with <a href="index.html#/exn:Canceled">Canceled</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:pick">
  <a href="index.html#/val:pick" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> pick : 'a <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>pick l</code> is the same as <a href="index.html#/val:choose">choose</a>, except that it cancels all
sleeping threads when one terminates.</p>
      
      <p>Note: <a href="index.html#/val:pick">pick</a> leaves the local values of the current thread
unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:npick">
  <a href="index.html#/val:npick" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> npick : 'a <a href="index.html#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> 'a list <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>npick l</code> is the same as <a href="index.html#/val:nchoose">nchoose</a>, except that it cancels all
sleeping threads when one terminates.</p>
      
      <p>Note: <a href="index.html#/val:npick">npick</a> leaves the local values of the current thread
unchanged.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:protected">
  <a href="index.html#/val:protected" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> protected : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>protected thread</code> creates a new cancelable thread which behave
as <code>thread</code> except that cancelling it does not cancel
<code>thread</code>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:no_cancel">
  <a href="index.html#/val:no_cancel" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> no_cancel : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> 'a <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>no_cancel thread</code> creates a thread which behave as <code>thread</code>
except that it cannot be canceled.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Pause</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:pause">
  <a href="index.html#/val:pause" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> pause : unit <span class="rarr"><span>-&gt;</span></span> unit <a href="index.html#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>pause ()</code> is a sleeping thread which is wake up on the next
call to <a href="index.html#/val:wakeup_paused">wakeup_paused</a>. A thread created with <code>pause</code> can be
canceled.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:wakeup_paused">
  <a href="index.html#/val:wakeup_paused" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> wakeup_paused : unit <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>wakeup_paused ()</code> wakes up all threads which suspended
themselves with <a href="index.html#/val:pause">pause</a>.</p>
      
      <p>This function is called by the scheduler, before entering the
main loop. You usually do not have to call it directly, except
if you are writing a custom scheduler.</p>
      
      <p>Note that if a paused thread resumes and pauses again, it will not
be woken up at this point.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:paused_count">
  <a href="index.html#/val:paused_count" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> paused_count : unit <span class="rarr"><span>-&gt;</span></span> int
    
      <div class="doc">
        
      <p><code>paused_count ()</code> returns the number of currently paused
threads.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:register_pause_notifier">
  <a href="index.html#/val:register_pause_notifier" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> register_pause_notifier : (int <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>register_pause_notifier f</code> register a function <code>f</code> that will be
called each time pause is called. The parameter passed to <code>f</code> is
the new number of threads paused. It is usefull to be able to
call <a href="index.html#/val:wakeup_paused">wakeup_paused</a> when there is no scheduler</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h2 class="section level_2">Misc</h2>
    </div>
        
      </div>
    
  <div class="region" id="/val:on_success">
  <a href="index.html#/val:on_success" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> on_success : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>on_success t f</code> executes <code>f</code> when <code>t</code> terminates without
failing. If <code>f</code> raises an exception it is given to
<a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:on_failure">
  <a href="index.html#/val:on_failure" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> on_failure : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (exn <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>on_failure t f</code> executes <code>f</code> when <code>t</code> terminates and fails. If
<code>f</code> raises an exception it is given to
<a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:on_termination">
  <a href="index.html#/val:on_termination" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> on_termination : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>on_termination t f</code> executes <code>f</code> when <code>t</code> terminates. If <code>f</code>
raises an exception it is given to <a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:on_any">
  <a href="index.html#/val:on_any" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> on_any : 'a <a href="index.html#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ('a <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> (exn <span class="rarr"><span>-&gt;</span></span> unit) <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>on_any t f g</code> executes <code>f</code> or <code>g</code> when <code>t</code> terminates. If <code>f</code>
or <code>g</code> raises an exception it is given to
<a href="index.html#/val:async_exception_hook">async_exception_hook</a>.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>