<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>X509</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">X509</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>Modules for X509 (RFC5280) handling</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:Cs">
  <a href="index.html#/module:Cs" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Cs : <span class="keyword">sig</span></div>
      
      
    <div class="sig">
  <div class="region" id="/module:Cs/val:hex_to_cs">
  <a href="index.html#/module:Cs/val:hex_to_cs" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> hex_to_cs : string <span class="rarr"><span>-&gt;</span></span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Cs/val:dotted_hex_to_cs">
  <a href="index.html#/module:Cs/val:dotted_hex_to_cs" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> dotted_hex_to_cs : string <span class="rarr"><span>-&gt;</span></span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Pem">
  <a href="index.html#/module:Pem" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Pem : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>A parser for PEM files</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:Pem/val:parse">
  <a href="index.html#/module:Pem/val:parse" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> parse : <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> (string * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>) list
    
      <div class="doc">
        
      <p><code>parse pem</code> is <code>(name * data) list</code>, in which the <code>pem</code> is parsed into its components, each surrounded by <code>BEGIN name</code> and <code>END name</code>. The actual <code>data</code> is base64 decoded.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Cert">
  <a href="index.html#/module:Cert" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Cert : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>A parser for X509 certificates in PEM format</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:Cert/type:t">
  <a href="index.html#/module:Cert/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t = <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate">certificate</a>
    
      <div class="doc">
        
      <p>The type of a certificate</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Cert/val:of_pem_cstruct">
  <a href="index.html#/module:Cert/val:of_pem_cstruct" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> of_pem_cstruct : <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Cert/type:t">t</a> list
    
      <div class="doc">
        
      <p><code>of_pem_cstruct pem</code> is <code>t list</code>, where all certificates of the <code>pem</code> are extracted</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Cert/val:of_pem_cstruct1">
  <a href="index.html#/module:Cert/val:of_pem_cstruct1" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> of_pem_cstruct1 : <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Cert/type:t">t</a>
    
      <div class="doc">
        
      <p><code>of_pem_cstruct1 pem</code> is <code>t</code>, where the single certificate of the <code>pem</code> is extracted</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:PK">
  <a href="index.html#/module:PK" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> PK : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>A parser for unencrypted private RSA keys certificates in PEM format</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:PK/type:t">
  <a href="index.html#/module:PK/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t = <a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/">Nocrypto</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Rsa">Rsa</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Rsa/type:priv">priv</a>
    
      <div class="doc">
        
      <p>The private RSA key type</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:PK/val:of_pem_cstruct">
  <a href="index.html#/module:PK/val:of_pem_cstruct" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> of_pem_cstruct : <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:PK/type:t">t</a> list
    
      <div class="doc">
        
      <p><code>of_pem_cstruct pem</code> is <code>t list</code>, where all private keys of <code>pem</code> are extracted</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:PK/val:of_pem_cstruct1">
  <a href="index.html#/module:PK/val:of_pem_cstruct1" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> of_pem_cstruct1 : <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:PK/type:t">t</a>
    
      <div class="doc">
        
      <p><code>of_pem_cstruct1 pem</code> is <code>t</code>, where the private key of <code>pem</code> is extracted</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator">
  <a href="index.html#/module:Authenticator" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Authenticator : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>The authenticator for a certificate chain</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:Authenticator/type:t">
  <a href="index.html#/module:Authenticator/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t
    
      <div class="doc">
        
      <p>abstract authenticator type</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator/type:res">
  <a href="index.html#/module:Authenticator/type:res" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> res = [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate">certificate</a></div><div class="cons">| `Fail <span class="keyword">of</span> <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate_failure">certificate_failure</a></div> ]
    
      <div class="doc">
        
      <p>result of an authentication, either <code>`Ok</code> or <code>`Fail</code> with a reason</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator/val:authenticate">
  <a href="index.html#/module:Authenticator/val:authenticate" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> authenticate : <a href="index.html#/module:Authenticator/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?host:<a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:host">host</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:stack">stack</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Authenticator/type:res">res</a>
    
      <div class="doc">
        
      <p><code>authenticate authenticator ?host stack</code> is <code>result</code>, where the given <code>authenticator</code> verifies the certificate <code>stack</code>, given an optional <code>host</code> name.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator/val:chain_of_trust">
  <a href="index.html#/module:Authenticator/val:chain_of_trust" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> chain_of_trust : ?time:float <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Cert">Cert</a>.<a href="index.html#/module:Cert/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Authenticator/type:t">t</a>
    
      <div class="doc">
        
      <p><code>chain_of_trust ?time trust_anchors</code> is <code>authenticator</code>, which uses the given <code>time</code> and set of <code>trust_anchors</code> to verify the certificate chain. This is an implementation of the algorithm in RFC5280.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator/val:server_fingerprint">
  <a href="index.html#/module:Authenticator/val:server_fingerprint" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> server_fingerprint : ?time:float <span class="rarr"><span>-&gt;</span></span> hash:<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/">Nocrypto</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Hash">Hash</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Hash/type:hash">hash</a> <span class="rarr"><span>-&gt;</span></span> fingerprints:(string * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>) list <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/module:Authenticator/type:t">t</a>
    
      <div class="doc">
        
      <p><code>server_fingerprint ?time hash fingerprints</code> is an <code>authenticator</code> which uses the given <code>time</code> to verify the certificate chain - if successful the <code>hash</code> of the server certificate is checked against the entry in the fingerprint list.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/module:Authenticator/val:null">
  <a href="index.html#/module:Authenticator/val:null" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> null : <a href="index.html#/module:Authenticator/type:t">t</a>
    
      <div class="doc">
        
      <p><code>null</code> is <code>authenticator</code>, which always returns <code>`Ok</code>. For testing purposes only.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>