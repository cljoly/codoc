<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Daemon</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Daemon</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>This module provides support for daemonizing a process. It provides flexibility as to
where the standard file descriptors (stdin, stdout and stderr) are connected after
daemonization has occurred.</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/module:Fd_redirection">
  <a href="index.html#/module:Fd_redirection" class="anchor">#</a>
  
  <div class="module">
      
      <div class="intro"><span class="keyword">module</span> Fd_redirection : <span class="keyword">sig</span></div>
      
      
    <div class="sig">
  <div class="region" id="/module:Fd_redirection/type:t">
  <a href="index.html#/module:Fd_redirection/type:t" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> t = [ <div class="cons">| `Dev_null</div><div class="cons">| `Do_not_redirect</div><div class="cons">| `File_append <span class="keyword">of</span> string</div><div class="cons">| `File_truncate <span class="keyword">of</span> string</div> ]
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:daemonize">
  <a href="index.html#/val:daemonize" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> daemonize : ?redirect_stdout:<a href="index.html#/module:Fd_redirection">Fd_redirection</a>.<a href="index.html#/module:Fd_redirection/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?redirect_stderr:<a href="index.html#/module:Fd_redirection">Fd_redirection</a>.<a href="index.html#/module:Fd_redirection/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?cd:string <span class="rarr"><span>-&gt;</span></span> ?umask:int <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> unit
    
      <div class="doc">
        
      <p><code>daemonize</code> makes the executing process a daemon.</p>
      
      <p>See Chapter 13 of Advanced Programming in the UNIX Environment Second Edition by
Stephens and Rago for more details.</p>
      
      <p>The optional arguments have defaults as per <code>daemonize_wait</code>, below.</p>
      
      <p>By default, output sent to stdout and stderr after daemonization will be silently
eaten. This behaviour may be adjusted by using <code>redirect_stdout</code> and
<code>redirect_stderr</code>. See the documentation for <code>daemonize_wait</code> below.</p>
      
        
  <div class="tag raises">
    <span class="label">Raises</span> <code>Failure</code> if fork was unsuccessful.
  </div>
  
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:daemonize_wait">
  <a href="index.html#/val:daemonize_wait" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> daemonize_wait : ?redirect_stdout:<a href="index.html#/module:Fd_redirection">Fd_redirection</a>.<a href="index.html#/module:Fd_redirection/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?redirect_stderr:<a href="index.html#/module:Fd_redirection">Fd_redirection</a>.<a href="index.html#/module:Fd_redirection/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> ?cd:string <span class="rarr"><span>-&gt;</span></span> ?umask:int <span class="rarr"><span>-&gt;</span></span> unit <span class="rarr"><span>-&gt;</span></span> (unit <span class="rarr"><span>-&gt;</span></span> unit) <a href="../../../../core_kernel.112.06.02/_build/lib/staged/">Staged</a>.<a href="../../../../core_kernel.112.06.02/_build/lib/staged/#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>daemonize_wait</code> makes the executing process a daemon, but delays full detachment
from the calling shell/process until the returned &quot;release&quot; closure is called.</p>
      
      <p>Any output to stdout/stderr before the &quot;release&quot; closure is called will get
sent out normally. After &quot;release&quot; is called, stdin is connected to /dev/null,
and stdout and stderr are connected as specified by <code>redirect_stdout</code> and
<code>redirect_stderr</code>. The default is the usual behaviour whereby both of these
descriptors are connected to /dev/null.</p>
      
      <p>Note that calling <code>release</code> will adjust SIGPIPE handling, so you should not rely on
the delivery of this signal during this time.</p>
      
      <p><code>daemonize_wait</code> allows you to daemonize and then start async, but still have
stdout/stderr go to the controlling terminal during startup. By default, when you
<code>daemonize</code>, toplevel exceptions during startup would get sent to /dev/null. With
<code>daemonize_wait</code>, toplevel exceptions can go to the terminal until you call <code>release</code>.</p>
      
        
  <div class="tag raises">
    <span class="label">Raises</span> <code>Failure</code> if fork was unsuccessful.
  </div>
  
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>