<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../codoc.css"/>
    <title>Cudf_types</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Cudf_types</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>CUDF type library</p>
      
      <p>Implement core CUDF types (see CUDF spec. ยง2.2.2).</p>
      
      <p>For parsing and pretty printing of CUDF types see [root:Cudf_types_pp].</p>
      
        
      </div>
    
      
    <div class="sig">
      <div class="doc">
        <div class="region">
    <h5 class="section level_5">CUDF types</h5>
    </div>
        
      </div>
    
  <div class="region" id="/type:version">
  <a href="index.html#/type:version" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> version = int
    
  </div>
  
  </div>
  
  <div class="region" id="/type:relop">
  <a href="index.html#/type:relop" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> relop = [ <div class="cons">| `Eq</div><div class="cons">| `Neq</div><div class="cons">| `Geq</div><div class="cons">| `Gt</div><div class="cons">| `Leq</div><div class="cons">| `Lt</div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/type:constr">
  <a href="index.html#/type:constr" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> constr = (<a href="index.html#/type:relop">relop</a> * <a href="index.html#/type:version">version</a>) option
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h6 class="section level_6">CUDF spec. types</h6>
    </div>
        
      </div>
    
  <div class="region" id="/type:pkgname">
  <a href="index.html#/type:pkgname" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> pkgname = string
    
  </div>
  
  </div>
  
  <div class="region" id="/type:vpkg">
  <a href="index.html#/type:vpkg" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> vpkg = <a href="index.html#/type:pkgname">pkgname</a> * <a href="index.html#/type:constr">constr</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:vpkglist">
  <a href="index.html#/type:vpkglist" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> vpkglist = <a href="index.html#/type:vpkg">vpkg</a> list
    
  </div>
  
  </div>
  
  <div class="region" id="/type:enum_keep">
  <a href="index.html#/type:enum_keep" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> enum_keep = [ <div class="cons">| `Keep_version</div><div class="cons">| `Keep_package</div><div class="cons">| `Keep_feature</div><div class="cons">| `Keep_none</div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/type:vpkgformula">
  <a href="index.html#/type:vpkgformula" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> vpkgformula = <a href="index.html#/type:vpkg">vpkg</a> list list
    
      <div class="doc">
        
      <p>CNF formula. Inner lists are OR-ed, outer AND-ed.
E.g.:</p>
      <ul><li>&quot;Depends: foo, baz | baz&quot; --&gt; <code>[ foo ] ; [ bar ; baz ]</code></li><li>&quot;Depends: true!&quot; --&gt; </li><li>&quot;Depends: false!&quot; --&gt; <code>[]</code></li></ul>
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:veqpkg">
  <a href="index.html#/type:veqpkg" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> veqpkg = <a href="index.html#/type:pkgname">pkgname</a> * ([ <div class="cons">| `Eq</div> ] * <a href="index.html#/type:version">version</a>) option
    
  </div>
  
  </div>
  
  <div class="region" id="/type:veqpkglist">
  <a href="index.html#/type:veqpkglist" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> veqpkglist = <a href="index.html#/type:veqpkg">veqpkg</a> list
    
  </div>
  
  </div>
  
  <div class="region" id="/type:typ">
  <a href="index.html#/type:typ" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> typ = [ <div class="cons">| `Int</div><div class="cons">| `Posint</div><div class="cons">| `Nat</div><div class="cons">| `Bool</div><div class="cons">| `String</div><div class="cons">| `Enum <span class="keyword">of</span> string list</div><div class="cons">| `Pkgname</div><div class="cons">| `Ident</div><div class="cons">| `Vpkg</div><div class="cons">| `Vpkgformula</div><div class="cons">| `Vpkglist</div><div class="cons">| `Veqpkg</div><div class="cons">| `Veqpkglist</div><div class="cons">| `Typedecl</div> ]
    
      <div class="doc">
        
      <p>CUDF types</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:keep_type">
  <a href="index.html#/val:keep_type" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> keep_type : <a href="index.html#/type:typ">typ</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:keep_enums">
  <a href="index.html#/val:keep_enums" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> keep_enums : string list
    
  </div>
  
  </div>
  
  <div class="region" id="/type:typedecl1">
  <a href="index.html#/type:typedecl1" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> typedecl1 = [ <div class="cons">| `Int <span class="keyword">of</span> int option</div><div class="cons">| `Posint <span class="keyword">of</span> int option</div><div class="cons">| `Nat <span class="keyword">of</span> int option</div><div class="cons">| `Bool <span class="keyword">of</span> bool option</div><div class="cons">| `String <span class="keyword">of</span> string option</div><div class="cons">| `Pkgname <span class="keyword">of</span> string option</div><div class="cons">| `Ident <span class="keyword">of</span> string option</div><div class="cons">| `Enum <span class="keyword">of</span> string list * string option</div><div class="cons">| `Vpkg <span class="keyword">of</span> <a href="index.html#/type:vpkg">vpkg</a> option</div><div class="cons">| `Vpkgformula <span class="keyword">of</span> <a href="index.html#/type:vpkgformula">vpkgformula</a> option</div><div class="cons">| `Vpkglist <span class="keyword">of</span> <a href="index.html#/type:vpkglist">vpkglist</a> option</div><div class="cons">| `Veqpkg <span class="keyword">of</span> <a href="index.html#/type:veqpkg">veqpkg</a> option</div><div class="cons">| `Veqpkglist <span class="keyword">of</span> <a href="index.html#/type:veqpkglist">veqpkglist</a> option</div><div class="cons">| `Typedecl <span class="keyword">of</span> <a href="index.html#/type:typedecl">typedecl</a> option</div> ]
    
      <div class="doc">
        
      <p>(Single) type declaration: each variant denotes a type, its argument the
default value, None if missing</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:typedecl">
  <a href="index.html#/type:typedecl" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> typedecl = (string * <a href="index.html#/type:typedecl1">typedecl1</a>) list
    
  </div>
  
  </div>
  
  <div class="region" id="/type:typed_value">
  <a href="index.html#/type:typed_value" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> typed_value = [ <div class="cons">| `Int <span class="keyword">of</span> int</div><div class="cons">| `Posint <span class="keyword">of</span> int</div><div class="cons">| `Nat <span class="keyword">of</span> int</div><div class="cons">| `Bool <span class="keyword">of</span> bool</div><div class="cons">| `String <span class="keyword">of</span> string</div><div class="cons">| `Pkgname <span class="keyword">of</span> string</div><div class="cons">| `Ident <span class="keyword">of</span> string</div><div class="cons">| `Enum <span class="keyword">of</span> string list * string</div><div class="cons">| `Vpkg <span class="keyword">of</span> <a href="index.html#/type:vpkg">vpkg</a></div><div class="cons">| `Vpkgformula <span class="keyword">of</span> <a href="index.html#/type:vpkgformula">vpkgformula</a></div><div class="cons">| `Vpkglist <span class="keyword">of</span> <a href="index.html#/type:vpkglist">vpkglist</a></div><div class="cons">| `Veqpkg <span class="keyword">of</span> <a href="index.html#/type:veqpkg">veqpkg</a></div><div class="cons">| `Veqpkglist <span class="keyword">of</span> <a href="index.html#/type:veqpkglist">veqpkglist</a></div><div class="cons">| `Typedecl <span class="keyword">of</span> <a href="index.html#/type:typedecl">typedecl</a></div> ]
    
      <div class="doc">
        
      <p>Typed value in the value space of all CUDF types</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h5 class="section level_5">Manipulation of typed values</h5>
    </div>
        
      </div>
    
  <div class="region" id="/val:type_of_typedecl">
  <a href="index.html#/val:type_of_typedecl" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> type_of_typedecl : <a href="index.html#/type:typedecl1">typedecl1</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typ">typ</a>
    
      <div class="doc">
        
      <p>extract the type of a (single) type declaration</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:typedecl_of_value">
  <a href="index.html#/val:typedecl_of_value" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> typedecl_of_value : <a href="index.html#/type:typed_value">typed_value</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typedecl1">typedecl1</a>
    
      <div class="doc">
        
      <p>Create a (single) type declaration having as default value the given typed
value (i.e. apply the &quot;Some&quot; monad to typed values)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:value_of_typedecl">
  <a href="index.html#/val:value_of_typedecl" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> value_of_typedecl : <a href="index.html#/type:typedecl1">typedecl1</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typed_value">typed_value</a> option
    
      <div class="doc">
        
      <p>Extract the default value from a type declaration (or return <code>None</code>)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:typedecl_of_type">
  <a href="index.html#/val:typedecl_of_type" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> typedecl_of_type : <a href="index.html#/type:typ">typ</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typedecl1">typedecl1</a>
    
      <div class="doc">
        
      <p>Create a (single) type declaration with no default value</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:type_of_value">
  <a href="index.html#/val:type_of_value" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> type_of_value : <a href="index.html#/type:typed_value">typed_value</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typ">typ</a>
    
      <div class="doc">
        
      <p></p>
      
        
  <div class="tag return">
    <span class="label">Returns</span> the type of a given value
  </div>
  
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:cast">
  <a href="index.html#/val:cast" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> cast : <a href="index.html#/type:typ">typ</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typed_value">typed_value</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:typed_value">typed_value</a>
    
      <div class="doc">
        
      <p><code>cast ty v</code> attempt a runtime cast of a given (typed) value to a different
type.</p>
      
        
  <div class="tag raises">
    <span class="label">Raises</span> <code>Type_error</code> if casting is not possible
  </div>
  
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h6 class="section level_6">CUDF syntactic types</h6>
    </div>
      <p>Types used in parsing, before values are injected into the CUDF type
system.</p>
      
        
      </div>
    
  <div class="region" id="/type:stanza">
  <a href="index.html#/type:stanza" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> 'ty stanza = (string * 'ty) list
    
      <div class="doc">
        
      <p>RFC-822-like stanza, i.e. an associative list mapping property names to
property values.</p>
      
      <p>Values are typed according to the type variable <code>'ty</code>. Usually, libCUDF
uses either <code>string stanza</code> (for untyped stanzas) or
<code>Cudf_types.typed_value stanza</code> (for typed stanzas).</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h5 class="section level_5">Various errors</h5>
    </div>
        
      </div>
    
  <div class="region" id="/exn:Parse_error_822">
  <a href="index.html#/exn:Parse_error_822" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> Parse_error_822 <span class="keyword">of</span> string * <a href="index.html#/type:loc">loc</a>
    
      <div class="doc">
        
      <p>Error while parsing RFC822-like syntax of CUDF documents.</p>
      
      <p>arguments: error message and file range, respectively.</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:Syntax_error">
  <a href="index.html#/exn:Syntax_error" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> Syntax_error <span class="keyword">of</span> string * <a href="index.html#/type:loc">loc</a>
    
      <div class="doc">
        
      <p>Syntax error while parsing some literal value</p>
      
      <p>arguments: error message and file range, respectively</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/exn:Type_error">
  <a href="index.html#/exn:Type_error" class="anchor">#</a>
  
  <div class="exn">
    <span class="keyword">exception</span> Type_error <span class="keyword">of</span> <a href="index.html#/type:typ">typ</a> * <a href="index.html#/type:typed_value">typed_value</a> * <a href="index.html#/type:loc">loc</a>
    
      <div class="doc">
        
      <p>Type error: mismatch between typed value and expected type</p>
      
      <p>arguments: expected type, found value</p>
      
        
      </div>
    
  </div>
  
  </div>
  
      <div class="doc">
        <div class="region">
    <h5 class="section level_5">Accessors, predicates, etc.</h5>
    </div>
        
      </div>
    
  <div class="region" id="/val:is_eq_formula">
  <a href="index.html#/val:is_eq_formula" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> is_eq_formula : <a href="index.html#/type:vpkgformula">vpkgformula</a> <span class="rarr"><span>-&gt;</span></span> bool
    
      <div class="doc">
        
      <p>Check whether a formula uses only equality tests over package versions.</p>
      
        
      </div>
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>