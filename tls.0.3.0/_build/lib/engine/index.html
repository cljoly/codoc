<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="../../../../codoc.css"/>
    <title>Engine</title>
  </head>
  <body>

  <div class="module codoc-doc">
      <a href="../../../">Up</a>
      <div class="intro"><h1 class="title"><span class="keyword">module</span> <a href="">Engine</a></h1> : <span class="keyword">sig</span></div>
      
      <div class="doc">
        
      <p>Core of pure library. This is the interface to effectful front-ends.</p>
      
        
      </div>
    
      
    <div class="sig">
  <div class="region" id="/type:alert">
  <a href="index.html#/type:alert" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> alert = <a href="../../../../dns.0.13.0/_build/lib/packet/">Packet</a>.alert_type
    
      <div class="doc">
        
      <p>type of alerts</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:state">
  <a href="index.html#/type:state" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> state
    
      <div class="doc">
        
      <p>some abstract type a client gets</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:ret">
  <a href="index.html#/type:ret" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> ret = [ <div class="cons">| `Ok <span class="keyword">of</span> [ <div class="cons">| `Ok <span class="keyword">of</span> <a href="index.html#/type:state">state</a></div><div class="cons">| `Eof</div><div class="cons">| `Alert <span class="keyword">of</span> <a href="index.html#/type:alert">alert</a></div> ] * [ <div class="cons">| `Response <span class="keyword">of</span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> option</div> ] * [ <div class="cons">| `Data <span class="keyword">of</span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> option</div> ]</div><div class="cons">| `Fail <span class="keyword">of</span> <a href="index.html#/type:alert">alert</a> * [ <div class="cons">| `Response <span class="keyword">of</span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a></div> ]</div> ]
    
      <div class="doc">
        
      <p>return type of handle_tls</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:handle_tls">
  <a href="index.html#/val:handle_tls" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> handle_tls : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:ret">ret</a>
    
      <div class="doc">
        
      <p><code>handle_tls tls in</code> is <code>ret</code>, depending on incoming <code>tls</code> state and cstruct, return appropriate <code>ret</code></p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:can_handle_appdata">
  <a href="index.html#/val:can_handle_appdata" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> can_handle_appdata : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> bool
    
      <div class="doc">
        
      <p><code>can_handle_appdata tls</code> is a predicate which indicates when the connection has already completed a handshake</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:handshake_in_progress">
  <a href="index.html#/val:handshake_in_progress" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> handshake_in_progress : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> bool
    
      <div class="doc">
        
      <p><code>handshake_in_progress tls</code> is a predicate which indicates whether a handshake is in progress</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:send_application_data">
  <a href="index.html#/val:send_application_data" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> send_application_data : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a> list <span class="rarr"><span>-&gt;</span></span> (<a href="index.html#/type:state">state</a> * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>) option
    
      <div class="doc">
        
      <p><code>send_application_data tls outs</code> is <code>(tls' * out) option</code> where <code>tls'</code> is the new tls state, and <code>out</code> the cstruct to send over the wire (encrypted and wrapped <code>outs</code>)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:send_close_notify">
  <a href="index.html#/val:send_close_notify" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> send_close_notify : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:state">state</a> * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>send_close_notify tls</code> is <code>tls' * out</code> where <code>tls'</code> is the new tls state, and out the (possible encrypted) close notify alert</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:reneg">
  <a href="index.html#/val:reneg" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> reneg : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> (<a href="index.html#/type:state">state</a> * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>) option
    
      <div class="doc">
        
      <p><code>reneg tls</code> is <code>(tls' * out) option</code> where <code>tls'</code> is the new tls state, and out either a client hello or hello request (depending on the communication endpoint we are)</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:client">
  <a href="index.html#/val:client" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> client : <a href="../../../../tls.0.3.0/_build/lib/config/">Config</a>.<a href="../../../../tls.0.3.0/_build/lib/config/#/type:client">client</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:state">state</a> * <a href="../../../../cstruct.1.5.0/_build/lib/cstruct/">Cstruct</a>.<a href="../../../../cstruct.1.5.0/_build/lib/cstruct/#/type:t">t</a>
    
      <div class="doc">
        
      <p><code>client client</code> is <code>tls * out</code> where <code>tls</code> is the initial state, and <code>out</code> the initial client hello</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:server">
  <a href="index.html#/val:server" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> server : <a href="../../../../tls.0.3.0/_build/lib/config/">Config</a>.<a href="../../../../tls.0.3.0/_build/lib/config/#/type:server">server</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:state">state</a>
    
      <div class="doc">
        
      <p><code>server server</code> is <code>tls</code> where <code>tls</code> is the initial server state</p>
      
        
      </div>
    
  </div>
  
  </div>
  
  <div class="region" id="/type:epoch_data">
  <a href="index.html#/type:epoch_data" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> epoch_data = {<table>
    <tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:protocol_version">
  <a href="index.html#/type:epoch_data/field:protocol_version" class="anchor">#</a>
  protocol_version
  </div>
  </td><td>: Core.tls_version</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:ciphersuite">
  <a href="index.html#/type:epoch_data/field:ciphersuite" class="anchor">#</a>
  ciphersuite
  </div>
  </td><td>: Ciphersuite.ciphersuite</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:peer_certificate">
  <a href="index.html#/type:epoch_data/field:peer_certificate" class="anchor">#</a>
  peer_certificate
  </div>
  </td><td>: <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate">certificate</a> list</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:peer_name">
  <a href="index.html#/type:epoch_data/field:peer_name" class="anchor">#</a>
  peer_name
  </div>
  </td><td>: string option</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:trust_anchor">
  <a href="index.html#/type:epoch_data/field:trust_anchor" class="anchor">#</a>
  trust_anchor
  </div>
  </td><td>: <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate">certificate</a> option</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:own_certificate">
  <a href="index.html#/type:epoch_data/field:own_certificate" class="anchor">#</a>
  own_certificate
  </div>
  </td><td>: <a href="../../../../x509.0.2.1/_build/lib/certificate/">Certificate</a>.<a href="../../../../x509.0.2.1/_build/lib/certificate/#/type:certificate">certificate</a> list</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:own_private_key">
  <a href="index.html#/type:epoch_data/field:own_private_key" class="anchor">#</a>
  own_private_key
  </div>
  </td><td>: <a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/">Nocrypto</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Rsa">Rsa</a>.<a href="../../../../nocrypto.0.3.0/_build/src/nocrypto/#/module:Rsa/type:priv">priv</a> option</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:own_name">
  <a href="index.html#/type:epoch_data/field:own_name" class="anchor">#</a>
  own_name
  </div>
  </td><td>: string option</td><td>;</td><td></td><td></td><td></td>
  </tr><tr class="field">
  <td>
  <div class="region" id="/type:epoch_data/field:master_secret">
  <a href="index.html#/type:epoch_data/field:master_secret" class="anchor">#</a>
  master_secret
  </div>
  </td><td>: State.master_secret</td><td>;</td><td></td><td></td><td></td>
  </tr>
    </table>}
    
  </div>
  
  </div>
  
  <div class="region" id="/type:epoch">
  <a href="index.html#/type:epoch" class="anchor">#</a>
  
  <div class="type">
    <span class="keyword">type</span> epoch = [ <div class="cons">| `InitialEpoch</div><div class="cons">| `Epoch <span class="keyword">of</span> <a href="index.html#/type:epoch_data">epoch_data</a></div> ]
    
  </div>
  
  </div>
  
  <div class="region" id="/val:epoch">
  <a href="index.html#/val:epoch" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> epoch : <a href="index.html#/type:state">state</a> <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:epoch">epoch</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:epoch_data_of_sexp">
  <a href="index.html#/val:epoch_data_of_sexp" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> epoch_data_of_sexp : Sexplib.Sexp.t <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:epoch_data">epoch_data</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:sexp_of_epoch_data">
  <a href="index.html#/val:sexp_of_epoch_data" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> sexp_of_epoch_data : <a href="index.html#/type:epoch_data">epoch_data</a> <span class="rarr"><span>-&gt;</span></span> Sexplib.Sexp.t
    
  </div>
  
  </div>
  
  <div class="region" id="/val:epoch_of_sexp">
  <a href="index.html#/val:epoch_of_sexp" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> epoch_of_sexp : Sexplib.Sexp.t <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:epoch">epoch</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:__epoch_of_sexp__">
  <a href="index.html#/val:__epoch_of_sexp__" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> __epoch_of_sexp__ : Sexplib.Sexp.t <span class="rarr"><span>-&gt;</span></span> <a href="index.html#/type:epoch">epoch</a>
    
  </div>
  
  </div>
  
  <div class="region" id="/val:sexp_of_epoch">
  <a href="index.html#/val:sexp_of_epoch" class="anchor">#</a>
  
  <div class="val">
    <span class="keyword">val</span> sexp_of_epoch : <a href="index.html#/type:epoch">epoch</a> <span class="rarr"><span>-&gt;</span></span> Sexplib.Sexp.t
    
  </div>
  
  </div>
  </div>
    <div class="outro"><span class="keyword">end</span></div>
    
  </div>
  
  </body>
</html>